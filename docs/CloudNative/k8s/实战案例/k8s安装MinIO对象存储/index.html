<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-CloudNative/k8s/实战案例/k8s安装MinIO对象存储">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">单节点部署 | AGou&#x27;s Docsv4</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.agou-ops.cn/docs/CloudNative/k8s/实战案例/k8s安装MinIO对象存储"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="单节点部署 | AGou&#x27;s Docsv4"><meta data-rh="true" name="description" content="参考文档"><meta data-rh="true" property="og:description" content="参考文档"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.agou-ops.cn/docs/CloudNative/k8s/实战案例/k8s安装MinIO对象存储"><link data-rh="true" rel="alternate" href="https://docs.agou-ops.cn/docs/CloudNative/k8s/实战案例/k8s安装MinIO对象存储" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.agou-ops.cn/docs/CloudNative/k8s/实战案例/k8s安装MinIO对象存储" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-KQED41RW95","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>




<script src="http://23.94.25.11:38080/script.js" async data-website-id="dc1ebecd-127f-4df7-bd12-bc3d0cc31998"></script><link rel="stylesheet" href="/assets/css/styles.6908ad1e.css">
<link rel="preload" href="/assets/js/runtime~main.769d471d.js" as="script">
<link rel="preload" href="/assets/js/main.cfb3537f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">AGou&#x27;s Docsv4</b></a><a href="https://agou-ops.cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">✨ 我的博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"> 📖 目录</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs">🌲 目录树</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/category/云原生相关">☁️ 云原生相关</a></li><li><a class="dropdown__link" href="/docs/category/linux基础">😊 Linux基础</a></li><li><a class="dropdown__link" href="/docs/category/编程语言">♨️ 编程语言</a></li><li><a class="dropdown__link" href="/docs/category/脚本相关">🕹️ 脚本相关</a></li><li><a class="dropdown__link" href="/docs/category/面试相关">👨‍⚖️ 面试相关</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">版本</a><ul class="dropdown__menu"><li><a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver1.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver2.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://agou-ops.cn/myDocsv3" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver3.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/AGou-ops" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub 仓库"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--dark_i4oU"><b>AGou&#x27;s Docsv4</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/云原生相关">云原生相关</a><button aria-label="Toggle the collapsible sidebar category &#x27;云原生相关&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cicd">CICD</a><button aria-label="Toggle the collapsible sidebar category &#x27;CICD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cloudcomptering">CloudComptering</a><button aria-label="Toggle the collapsible sidebar category &#x27;CloudComptering&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/docker">Docker</a><button aria-label="Toggle the collapsible sidebar category &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/elfk">ELFK</a><button aria-label="Toggle the collapsible sidebar category &#x27;ELFK&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/prometheus">Prometheus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prometheus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/k8s">k8s</a><button aria-label="Toggle the collapsible sidebar category &#x27;k8s&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/helm">Helm</a><button aria-label="Toggle the collapsible sidebar category &#x27;Helm&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/installation">Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/quicklystart">Quicklystart</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quicklystart&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/实战案例">实战案例</a><button aria-label="Toggle the collapsible sidebar category &#x27;实战案例&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/RBAC 实战案例">（一）通过用户账号的方式分配单独Namespace的权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/SpringCloud微服务电商系统在Kubernetes集群中上线详细教程">SpringCloud微服务电商系统在Kubernetes集群中上线详细教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/cert-manager自动颁发证书">cert-manager自动颁发证书</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/helm安装zookeeper集群">helm安装zookeeper集群</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/jenkins结合">jenkins结合</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/k8s中使用traefik（基础）">k8s中使用traefik（基础）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/k8s安装Apollo配置中心">k8s安装Apollo配置中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/CloudNative/k8s/实战案例/k8s安装MinIO对象存储">单节点部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/使用CSR API创建用户">使用CSR API创建用户</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/实战案例/其他实战案例">其他实战案例</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Kubeadm 快速部署k8s集群">Kubeadm 快速部署k8s集群</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Kubernetes REST API">Kubernetes REST API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Kubernetes Yaml quicklystart">Kubernetes YAML file quicklystart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Kubernetes with Jenkins CICD">基于kubernetes平台的CICD持续集成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Minikube Basic">Minikube Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Prometheus-Grafana全方位监控Kubernetes集群">Prometheus+Grafana全方位监控Kubernetes集群</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/Remote access k8s">kubectl远程连接k8s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/k3d">k3d</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/k8s command">Kubernetes CLI command -- kubectl</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/k8s 图解大全">k8s图解大全</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/k8s 网络相关">k8s 网络相关</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/k8s概念及原理相关">k8s 概念及原理相关</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/kompose Basic">Kompose Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/k8s/kubenetes远程调试工具">kubenetes远程调试工具</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/CloudNative/k8s/小技巧/使用curl访问k8s的REST API">小技巧</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Consul 入门">Consul 入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Dubbo Basic">Dubbo Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Grafana Loki Basic">Grafana Loki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Istio Basic">Istio Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/">CloudNative.</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/云原生相关"><span itemprop="name">云原生相关</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/k8s"><span itemprop="name">k8s</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/实战案例"><span itemprop="name">实战案例</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">单节点部署</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>单节点部署</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="参考文档">参考文档<a href="#参考文档" class="hash-link" aria-label="Direct link to 参考文档" title="Direct link to 参考文档">​</a></h2><p><a href="http://www.minio.org.cn/docs/minio/kubernetes/upstream/#quickstart-minio-for-kubernetes" target="_blank" rel="noopener noreferrer">http://www.minio.org.cn/docs/minio/kubernetes/upstream/#quickstart-minio-for-kubernetes</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="部署minio">部署minIO<a href="#部署minio" class="hash-link" aria-label="Direct link to 部署minIO" title="Direct link to 部署minIO">​</a></h2><p>创建资源</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# cat &gt; minio.yaml &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      app: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: quay.io/minio/minio:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - -c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        args: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - minio server /data --console-address :9090</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumeMounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - mountPath: /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: localvolume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - containerPort: 9090</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - containerPort: 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nodeSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        kubernetes.io/hostname: k8s-master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: localvolume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hostPath:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          path: /data/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          type: DirectoryOrCreate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: NodePort </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    selector:     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      app: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      port: 9090</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      targetPort: 9090</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nodePort: 30300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      port: 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      targetPort: 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nodePort: 30200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl apply -f minio.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/minio created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/minio-service created</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用NodePort方式访问web页面</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get pod -n minio </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-86577f8755-l65mf   1/1     Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get svc -n minio </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)                         AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-service   NodePort   10.102.223.132   &lt;none&gt;        9090:30300/TCP,9000:30200/TCP   10m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>访问k8s节点ip:30300，默认用户名密码都是<strong>minioadmin</strong>
<img loading="lazy" src="https://cdn.agou-ops.cn/others/1681288151994-3eb8a828-d5d8-430b-a505-4beee56f8c3b.png" alt="image.png" class="img_ev3q">
使用ingress方式访问</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# cat minio-ingress.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: traefik.containo.us/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: IngressRoute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  entryPoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  routes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - match: Host(`minio.test.com`) # 域名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: Rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: minio-service  # 与svc的name一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 9090           # 与svc的port一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: traefik.containo.us/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: IngressRoute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  entryPoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  routes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - match: Host(`minio-api.test.com`) # 域名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: Rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: minio-service  # 与svc的name一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 9000           # 与svc的port一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl apply -f minio-ingress.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingressroute.traefik.containo.us/minio-console created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingressroute.traefik.containo.us/minio-api created</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加hosts记录<code>192.168.10.10 minio.test.com</code>访问域名即可</p><h1>部署minIO集群</h1><p>minIO集群方式部署使用operator或者helm均可。helm部署minIO参考文档：<a href="https://artifacthub.io/packages/helm/bitnami/minio%E3%80%82operator%E9%83%A8%E7%BD%B2minIO%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%9Ahttps://operator.min.io/%EF%BC%8C%E6%AD%A4%E5%A4%84%E4%BD%BF%E7%94%A8helm%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2" target="_blank" rel="noopener noreferrer">https://artifacthub.io/packages/helm/bitnami/minio。operator部署minIO参考文档：https://operator.min.io/，此处使用helm方式部署</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="集群角色规划">集群角色规划<a href="#集群角色规划" class="hash-link" aria-label="Direct link to 集群角色规划" title="Direct link to 集群角色规划">​</a></h2><p>使用分布式方式部署高可用的minIO集群时，驱动器总数至少是4 个，以保证纠删码。我们可以在k8s-work1和k8s-work2上的data1和data2路径存放minIO数据，使用local pv方式持久化数据。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 创建数据存放路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-work1 ~]# mkdir -p /data1/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-work1 ~]# mkdir -p /data2/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-work2 ~]# mkdir -p /data1/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-work2 ~]# mkdir -p /data2/minio</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="下载helm包">下载helm包<a href="#下载helm包" class="hash-link" aria-label="Direct link to 下载helm包" title="Direct link to 下载helm包">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# helm repo add bitnami https://charts.bitnami.com/bitnami</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# helm pull bitnami/minio --untar </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# cd minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chart.lock  charts  Chart.yaml  README.md  templates  values.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="修改配置">修改配置<a href="#修改配置" class="hash-link" aria-label="Direct link to 修改配置" title="Direct link to 修改配置">​</a></h2><p>添加storage-class模板配置：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# cat &gt; templates/storage-class.yaml &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: StorageClass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: storage.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-local-storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">provisioner: kubernetes.io/no-provisioner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumeBindingMode: WaitForFirstConsumer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>添加 pv模板配置</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# cat templates/pv.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{- $size := .Values.persistence.size -}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{- $accessModes := .Values.persistence.accessModes -}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{- $storageClass := .Values.persistence.storageClass -}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{- range .Values.persistence.local }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: PersistentVolume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: {{ .name }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  capacity:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    storage: {{ $size }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  volumeMode: Filesystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  accessModes: {{ $accessModes }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  persistentVolumeReclaimPolicy: Delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  storageClassName: {{ $storageClass }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  local:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path: {{ .path }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nodeAffinity:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    required:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nodeSelectorTerms:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - matchExpressions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - key: kubernetes.io/hostname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          operator: In</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          values:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - {{ .host }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{{- end }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改配置values.yaml</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">91  mode: distributed # 集群模式，单节点为standalone，分布式集群为distributed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">185 statefulset:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">203   replicaCount: 2 # 节点数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">206   zones: 1 # 区域数，1个即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">209   drivesPerNode: 2 # 每个节点数据目录数.2节点×2目录组成4节点的mimio集群</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">594 service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">597   type: NodePort # 修改server类型为NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">608   nodePorts: # 指定NodePort端口号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">609     api: &quot;30900&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">610     console: &quot;30901&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">886 persistence:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">889   enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">897   storageClass: &quot;minio-local-storage&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">900   mountPath: /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">903   accessModes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">904     - ReadWriteOnce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">907   size: 10Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">910   annotations: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">913   existingClaim: &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">914   local:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">915     - name: minio-pv-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">916       path: /data1/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">917       host: k8s-work1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">918     - name: minio-pv-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">919       path: /data2/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">920       host: k8s-work1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">921     - name: minio-pv-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">922       path: /data1/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">923       host: k8s-work2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">924     - name: minio-pv-3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">925       path: /data2/minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">926       host: k8s-work2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="部署minio-1">部署minIO<a href="#部署minio-1" class="hash-link" aria-label="Direct link to 部署minIO" title="Direct link to 部署minIO">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl create ns minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# helm install minio . -f values.yaml -n minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAST DEPLOYED: Thu Apr 13 13:52:22 2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STATUS: deployed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REVISION: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEST SUITE: None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTES:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CHART NAME: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CHART VERSION: 12.2.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">APP VERSION: 2023.3.24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">** Please be patient while the chart is being deployed **</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MinIO&amp;reg; can be accessed via port  on the following DNS name from within your cluster:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   minio.minio.svc.cluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To get your credentials run:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   export ROOT_USER=$(kubectl get secret --namespace minio minio -o jsonpath=&quot;{.data.root-user}&quot; | base64 -d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   export ROOT_PASSWORD=$(kubectl get secret --namespace minio minio -o jsonpath=&quot;{.data.root-password}&quot; | base64 -d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To connect to your MinIO&amp;reg; server using a client:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Run a MinIO&amp;reg; Client pod and append the desired command (e.g. &#x27;admin info&#x27;):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   kubectl run --namespace minio minio-client \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --rm --tty -i --restart=&#x27;Never&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --env MINIO_SERVER_ROOT_USER=$ROOT_USER \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --env MINIO_SERVER_ROOT_PASSWORD=$ROOT_PASSWORD \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --env MINIO_SERVER_HOST=minio \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --image docker.io/bitnami/minio-client:2023.3.23-debian-11-r0 -- admin info minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To access the MinIO&amp;reg; web UI:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Get the MinIO&amp;reg; URL:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   export NODE_PORT=$(kubectl get --namespace minio -o jsonpath=&quot;{.spec.ports[0].nodePort}&quot; services minio)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   export NODE_IP=$(kubectl get nodes --namespace minio -o jsonpath=&quot;{.items[0].status.addresses[0].address}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   echo &quot;MinIO&amp;reg; web URL: http://$NODE_IP:$NODE_PORT/minio&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查看资源信息">查看资源信息<a href="#查看资源信息" class="hash-link" aria-label="Direct link to 查看资源信息" title="Direct link to 查看资源信息">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get pod -n minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME      READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-0   1/1     Running   0          24m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-1   1/1     Running   0          24m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get all -n minio </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME          READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/minio-0   1/1     Running   0          25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/minio-1   1/1     Running   0          25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                         AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/minio            NodePort    10.100.230.196   &lt;none&gt;        9000:30900/TCP,9001:30901/TCP   25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/minio-headless   ClusterIP   None             &lt;none&gt;        9000/TCP,9001/TCP               25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     READY   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">statefulset.apps/minio   2/2     25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get pvc -n minio </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME             STATUS   VOLUME       CAPACITY   ACCESS MODES   STORAGECLASS          AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data-0-minio-0   Bound    minio-pv-3   10Gi       RWO            minio-local-storage   25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data-0-minio-1   Bound    minio-pv-0   10Gi       RWO            minio-local-storage   25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data-1-minio-0   Bound    minio-pv-2   10Gi       RWO            minio-local-storage   25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data-1-minio-1   Bound    minio-pv-1   10Gi       RWO            minio-local-storage   25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get pv -n minio </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                               STORAGECLASS          REASON   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-pv-0                                 10Gi       RWO            Delete           Bound    minio/data-0-minio-1                minio-local-storage            25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-pv-1                                 10Gi       RWO            Delete           Bound    minio/data-1-minio-1                minio-local-storage            25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-pv-2                                 10Gi       RWO            Delete           Bound    minio/data-1-minio-0                minio-local-storage            25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minio-pv-3                                 10Gi       RWO            Delete           Bound    minio/data-0-minio-0                minio-local-storage            25m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建ingress资源">创建ingress资源<a href="#创建ingress资源" class="hash-link" aria-label="Direct link to 创建ingress资源" title="Direct link to 创建ingress资源">​</a></h2><p>以ingrss-nginx为例：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cat &gt; ingress.yaml &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: networking.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-ingreess</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nginx.ingress.kubernetes.io/rewrite-target: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingressClassName: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - host: minio.local.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - path: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pathType: Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            name: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            port:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              number: 9001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以traefik为例：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# cat ingress.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: traefik.containo.us/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: IngressRoute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  entryPoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  routes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - match: Host(`minio.local.com`) # 域名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: Rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: minio  # 与svc的name一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 9001      # 与svc的port一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: traefik.containo.us/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: IngressRoute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: minio-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  entryPoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  routes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - match: Host(`minio-api.local.com`) # 域名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: Rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: minio  # 与svc的name一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 9000      # 与svc的port一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl apply -f ingress.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingressroute.traefik.containo.us/minio-console created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingressroute.traefik.containo.us/minio-api created</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="访问测试">访问测试<a href="#访问测试" class="hash-link" aria-label="Direct link to 访问测试" title="Direct link to 访问测试">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 获取用户名和密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get secret --namespace minio minio -o jsonpath=&quot;{.data.root-user}&quot; | base64 -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">admin[root@k8s-master minio]# </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# kubectl get secret --namespace minio minio -o jsonpath=&quot;{.data.root-password}&quot; | base64 -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WtAbQDQITX[root@k8s-master minio]# </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="访问web管理页">访问web管理页<a href="#访问web管理页" class="hash-link" aria-label="Direct link to 访问web管理页" title="Direct link to 访问web管理页">​</a></h2><p><img loading="lazy" src="https://cdn.agou-ops.cn/others/1692006006827-dc9b1c7c-7eb9-48eb-824a-3f2037923024.png" alt="image.png" class="img_ev3q"></p><h1>minIO使用</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建bucket">创建bucket<a href="#创建bucket" class="hash-link" aria-label="Direct link to 创建bucket" title="Direct link to 创建bucket">​</a></h2><p><img loading="lazy" src="https://cdn.agou-ops.cn/others/1681288250619-9e71b807-95a6-428d-84bd-c2ee3ba7e451.png" alt="image.png" class="img_ev3q">
<img loading="lazy" src="https://cdn.agou-ops.cn/others/1681288331888-6b91729a-67c0-4675-a628-5bcd6260f7ad.png" alt="image.png" class="img_ev3q">
<img loading="lazy" src="https://cdn.agou-ops.cn/others/1681288347417-c7c79085-cd11-48f4-97f1-34ba97cb8e78.png" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建access-keys">创建Access Keys<a href="#创建access-keys" class="hash-link" aria-label="Direct link to 创建Access Keys" title="Direct link to 创建Access Keys">​</a></h2><p><img loading="lazy" src="https://cdn.agou-ops.cn/others/1681288392924-8647ad8a-64c2-4e23-b609-dfdb6333f403.png" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建访问控制权限">创建访问控制权限<a href="#创建访问控制权限" class="hash-link" aria-label="Direct link to 创建访问控制权限" title="Direct link to 创建访问控制权限">​</a></h2><p>Minio 的存储桶默认是不跟任何 Acess Key 关联的，不过由于 Minio 支持标准的 S3 协议，我们可以给 Access Key 授予某个 Bucket 存储桶的访问权限，实现 Key 和 Bucket 的绑定。
创建policy
<img loading="lazy" src="https://cdn.agou-ops.cn/others/1689994620680-5022ac1d-e950-40f5-98ba-0512c9e40f9a.png" alt="image.png" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;s3:ListAllMyBuckets&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;s3:ListBucket&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;s3:GetBucketLocation&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;s3:GetObject&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;s3:PutObject&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;s3:DeleteObject&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Resource&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;arn:aws:s3:::es-backup/*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>创建user
这里 Access Key 是用户名，Access Secret 是对应的口令。设置时关联上刚才创建的 Policy 即可。
<img loading="lazy" src="https://cdn.agou-ops.cn/others/1689994774057-67d85be0-91d3-4e67-a42c-e0f12d09c89c.png" alt="image.png" class="img_ev3q">
我们就创建了一个新的存储桶，并且给这个存储桶设置了一个用户，同时授权了用户对存储桶的访问，包括列表、上传、下载这几个基本权限。</p><h1>mc客户端使用</h1><p>MinIO Client (mc)为ls，cat，cp，mirror，diff，find等UNIX命令提供了一种替代方案。它支持文件系统和兼容Amazon S3的云存储服务（AWS Signature v2和v4）。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装mc客户端linux二进制文件">安装mc客户端（Linux二进制文件）<a href="#安装mc客户端linux二进制文件" class="hash-link" aria-label="Direct link to 安装mc客户端（Linux二进制文件）" title="Direct link to 安装mc客户端（Linux二进制文件）">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio]# curl https://dl.min.io/client/mc/release/linux-amd64/mc --create-dirs -o /usr/local/minio-binaries/mc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master local]# cd /usr/local/minio-binaries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# chmod +x mc </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# ./mc --help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── (q)uit/esc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME:                                                                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mc - MinIO Client for object storage and filesystems.                            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USAGE:                                                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mc [FLAGS] COMMAND [COMMAND FLAGS | -h] [ARGUMENTS...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 添加环境变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# cat /etc/profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=&quot;$PATH:/usr/local/minio-binaries&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# source /etc/profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# mc --help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── (q)uit/esc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mc [FLAGS] COMMAND [COMMAND FLAGS | -h] [ARGUMENTS...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装mc客户端docker">安装mc客户端（docker）<a href="#安装mc客户端docker" class="hash-link" aria-label="Direct link to 安装mc客户端（docker）" title="Direct link to 安装mc客户端（docker）">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@tiaoban ~]# docker run -it --rm minio/mc ls play</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mc: Configuration written to `/root/.mc/config.json`. Please update your access credentials.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mc: Successfully created `/root/.mc/share`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mc: Initialized share uploads `/root/.mc/share/uploads.json` file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mc: Initialized share downloads `/root/.mc/share/downloads.json` file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 01:39:27 UTC]     0B 64375d4bed2b146c15d5383f-files/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-03-15 11:55:17 UTC]     0B abc/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-03-31 18:46:54 UTC]     0B awdkenny/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mc客户端常用命令">mc客户端常用命令<a href="#mc客户端常用命令" class="hash-link" aria-label="Direct link to mc客户端常用命令" title="Direct link to mc客户端常用命令">​</a></h2><table><thead><tr><th>命令</th><th>功能</th></tr></thead><tbody><tr><td>ls</td><td>列出文件和文件夹。</td></tr><tr><td>mb</td><td>创建一个存储桶或一个文件夹。</td></tr><tr><td>cat</td><td>显示文件和对象内容。</td></tr><tr><td>pipe</td><td>将一个STDIN重定向到一个对象或者文件或者STDOUT。</td></tr><tr><td>share</td><td>生成用于共享的URL。</td></tr><tr><td>cp</td><td>拷贝文件和对象。</td></tr><tr><td>mirror</td><td>给存储桶和文件夹做镜像。</td></tr><tr><td>find</td><td>基于参数查找文件。</td></tr><tr><td>diff</td><td>对两个文件夹或者存储桶比较差异。</td></tr><tr><td>rm</td><td>删除文件和对象。</td></tr><tr><td>events</td><td>管理对象通知。</td></tr><tr><td>watch</td><td>监视文件和对象的事件。</td></tr><tr><td>policy</td><td>管理访问策略。</td></tr><tr><td>config</td><td>管理mc配置文件。</td></tr><tr><td>update</td><td>检查软件更新。</td></tr><tr><td>version</td><td>输出版本信息。</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mc连接minio服务">mc连接minIO服务<a href="#mc连接minio服务" class="hash-link" aria-label="Direct link to mc连接minIO服务" title="Direct link to mc连接minIO服务">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 添加对象存储服务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# mc alias set k8s-minio http://10.102.223.132:9000 minioadmin minioadmin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added `k8s-minio` successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master minio-binaries]# mc admin info k8s-minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">●  10.102.223.132:9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Uptime: 41 minutes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Version: 2023-04-07T05:28:58Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Network: 1/1 OK </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Drives: 1/1 OK </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Pool: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pools:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1st, Erasure sets: 1, Drives per erasure set: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">12 MiB Used, 1 Bucket, 2 Objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 drive online, 0 drives offline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bucket操作">bucket操作<a href="#bucket操作" class="hash-link" aria-label="Direct link to bucket操作" title="Direct link to bucket操作">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 创建bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc mb k8s-minio/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bucket created successfully `k8s-minio/test`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc ls k8s-minio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:02:02 CST]     0B test/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 删除没有文件的bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc rb k8s-minio/demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 删除有文件的bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc rb k8s-minio/test --force</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="上传下载操作">上传下载操作<a href="#上传下载操作" class="hash-link" aria-label="Direct link to 上传下载操作" title="Direct link to 上传下载操作">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 上传文件到bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc cp /etc/hosts k8s-minio/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/hosts:                   2.09 KiB / 2.09 KiB ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.07 KiB/s 0s[root@k8s-master ~]# mc cp /etc/yum.repos.d k8s-minio/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 上传目录到bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc cp /etc/yum.repos.d k8s-minio/test --recursive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...m.repos.d/kubernetes.repo: 19.46 KiB / 19.46 KiB ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.99 KiB/s 0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 下载bucket文件到本地</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mkdir /tmp/download</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc cp k8s-minio/test/hosts /tmp/download/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...2.223.132:9000/test/hosts: 2.09 KiB / 2.09 KiB ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.18 KiB/s 0s[root@k8s-master ~]# ls /tmp/download/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# cat /tmp/download/hosts </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 下载bucket目录到本地</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc cp k8s-minio/test/yum.repos.d /tmp/download/ --recursive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...m.repos.d/kubernetes.repo: 19.46 KiB / 19.46 KiB ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 87.10 KiB/s 0s[root@k8s-master ~]# ls /tmp/download/yum.repos.d/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-ce.repo     epel-testing-modular.repo  Rocky-AppStream.repo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="文件操作">文件操作<a href="#文件操作" class="hash-link" aria-label="Direct link to 文件操作" title="Direct link to 文件操作">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查看bucket文件列表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc ls k8s-minio/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:04:59 CST] 2.1KiB STANDARD hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:10:42 CST]     0B yum.repos.d/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看bucket目录内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc ls k8s-minio/test/yum.repos.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:05:34 CST]   710B STANDARD Rocky-AppStream.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:05:34 CST]   695B STANDARD Rocky-BaseOS.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:05:34 CST] 1.7KiB STANDARD Rocky-Debuginfo.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-04-13 10:05:34 CST]   360B STANDARD Rocky-Devel.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看bucket文件内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc cat k8s-minio/test/hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 删除文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc rm k8s-minio/test/hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removed `k8s-minio/test/hosts`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 删除目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@k8s-master ~]# mc rm k8s-minio/test/yum.repos.d --recursive --force</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removed `k8s-minio/test/yum.repos.d/Rocky-AppStream.repo`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removed `k8s-minio/test/yum.repos.d/Rocky-BaseOS.repo`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removed `k8s-minio/test/yum.repos.d/Rocky-Debuginfo.repo`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removed `k8s-minio/test/yum.repos.d/Rocky-Devel.repo`.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>curl客户端使用</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="上传文件">上传文件<a href="#上传文件" class="hash-link" aria-label="Direct link to 上传文件" title="Direct link to 上传文件">​</a></h2><p>上传文件脚本，按实际情况修改host、s3_key、s3_secret和-x</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@tiaoban ~]# cat push.sh </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=$PATH:/bin:/usr/bin:/usr/local/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ $# != 2 ] ; then </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Usage: `basename $0` my-bucket my-file.zip&quot; &gt;&amp;2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bucket=$1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file=$2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host=minio-api.test.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3_key=GfuHooI5byVpGf2RGwl3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3_secret=YpYqXKKhI4bNUmWWULa3qf5n5WPq3TDedb1uzREc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resource=&quot;/${bucket}/${file}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">content_type=&quot;application/zstd&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date=`date -R`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_signature=&quot;PUT\n\n${content_type}\n${date}\n${resource}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signature=`echo -en ${_signature} | openssl sha1 -hmac ${s3_secret} -binary | base64`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -v -X PUT -T &quot;${file}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          -H &quot;Host: ${host}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          -x &quot;192.168.10.10:80&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          -H &quot;Date: ${date}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          -H &quot;Content-Type: ${content_type}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          -H &quot;Authorization: AWS ${s3_key}:${signature}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          http://${host}${resource}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上传文件</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@tiaoban ~]# ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">anaconda-ks.cfg  cfssl  defaults.ini  es  go  push.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@tiaoban ~]# ./push.sh test defaults.ini </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*   Trying 192.168.10.10...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* TCP_NODELAY set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Connected to 192.168.10.10 (192.168.10.10) port 80 (#0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; PUT http://minio-api.test.com/test/defaults.ini HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Host: minio-api.test.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; User-Agent: curl/7.61.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Accept: */*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Proxy-Connection: Keep-Alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Date: Sat, 06 May 2023 10:10:07 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Content-Type: application/zstd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Authorization: AWS bhUsp7nwc6XNPzoI:w2ddmcsQWOijC2BZJSGE4u7DgFc=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Content-Length: 55875</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Expect: 100-continue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; HTTP/1.1 100 Continue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* We are completely uploaded and fine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Accept-Ranges: bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Content-Length: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Content-Security-Policy: block-all-mixed-content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Date: Sat, 06 May 2023 02:10:07 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Etag: &quot;1b0bdd8f4c5f31ef5661380efcaefce5&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Server: MinIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Strict-Transport-Security: max-age=31536000; includeSubDomains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Vary: Origin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Vary: Accept-Encoding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Amz-Id-2: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Amz-Request-Id: 175C6BE8ACF79B53</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Content-Type-Options: nosniff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Xss-Protection: 1; mode=block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Connection #0 to host 192.168.10.10 left intact</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>查看bucket文件
<img loading="lazy" src="https://cdn.agou-ops.cn/others/1683339253090-6b00229f-cf94-4f0f-a62f-9d52bf38cc6d.png" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="下载文件">下载文件<a href="#下载文件" class="hash-link" aria-label="Direct link to 下载文件" title="Direct link to 下载文件">​</a></h2><p>下载文件脚本</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ $# != 3 ] ; then </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Usage: `basename $0` my-bucket minio-filename localfile&quot; &gt;&amp;2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Usage: `basename $0` test-bucket 1.log /tmp/1.log&quot; &gt;&amp;2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># User Minio Vars</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host=minio-api.test.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3_key=bhUsp7nwc6XNPzoI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3_secret=w3KBPxMZ5Nw4apRGZY3uAHON7bkkKprP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUCKET=$1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MINIO_PATH=&quot;/${BUCKET}/$2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OUT_FILE=$3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Static Vars</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATE=$(date -R)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTENT_TYPE=&#x27;application/zstd&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SIG_STRING=&quot;GET\n\n${CONTENT_TYPE}\n${DATE}\n${MINIO_PATH}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SIGNATURE=`echo -en ${SIG_STRING} | openssl sha1 -hmac ${s3_secret} -binary | base64`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -v -o &quot;${OUT_FILE}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -x &quot;192.168.10.10:80&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -H &quot;Host: $host&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -H &quot;Date: ${DATE}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -H &quot;Content-Type: ${CONTENT_TYPE}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -H &quot;Authorization: AWS ${s3_key}:${SIGNATURE}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http://$URL${MINIO_PATH}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>下载文件</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@tiaoban ~]# ./pull.sh test defaults.ini /tmp/defaults.ini</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*   Trying 192.168.10.10...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* TCP_NODELAY set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 192.168.10.10 (192.168.10.10) port 80 (#0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; GET http://minio-api.test.com/test/defaults.ini HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Host: minio-api.test.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; User-Agent: curl/7.61.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Accept: */*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Proxy-Connection: Keep-Alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Date: Sat, 06 May 2023 10:17:18 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Content-Type: application/zstd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Authorization: AWS bhUsp7nwc6XNPzoI:sl8feCFiJC4MpaKSKrGU9HlDMLw=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Accept-Ranges: bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Content-Length: 55875</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Content-Security-Policy: block-all-mixed-content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Content-Type: application/zstd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Date: Sat, 06 May 2023 02:17:18 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Etag: &quot;1b0bdd8f4c5f31ef5661380efcaefce5&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Last-Modified: Sat, 06 May 2023 02:10:07 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Server: MinIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Strict-Transport-Security: max-age=31536000; includeSubDomains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Vary: Origin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Vary: Accept-Encoding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Amz-Id-2: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Amz-Request-Id: 175C6C4CF3EB56C4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Content-Type-Options: nosniff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; X-Xss-Protection: 1; mode=block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{ [3529 bytes data]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100 55875  100 55875    0     0  1474k      0 --:--:-- --:--:-- --:--:-- 1515k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Connection #0 to host 192.168.10.10 left intact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@tiaoban ~]# ls -lh /tmp/defaults.ini </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 55K 5月   6 10:17 /tmp/defaults.ini</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>该文章来源于网络，仅做个人备份.</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/AGou-ops/myDocsv4/edit/main/docs/CloudNative/k8s/实战案例/k8s安装MinIO对象存储.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/CloudNative/k8s/实战案例/k8s安装Apollo配置中心"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">k8s安装Apollo配置中心</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/CloudNative/k8s/实战案例/使用CSR API创建用户"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">使用CSR API创建用户</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#参考文档" class="table-of-contents__link toc-highlight">参考文档</a></li><li><a href="#部署minio" class="table-of-contents__link toc-highlight">部署minIO</a></li><li><a href="#集群角色规划" class="table-of-contents__link toc-highlight">集群角色规划</a></li><li><a href="#下载helm包" class="table-of-contents__link toc-highlight">下载helm包</a></li><li><a href="#修改配置" class="table-of-contents__link toc-highlight">修改配置</a></li><li><a href="#部署minio-1" class="table-of-contents__link toc-highlight">部署minIO</a></li><li><a href="#查看资源信息" class="table-of-contents__link toc-highlight">查看资源信息</a></li><li><a href="#创建ingress资源" class="table-of-contents__link toc-highlight">创建ingress资源</a></li><li><a href="#访问测试" class="table-of-contents__link toc-highlight">访问测试</a></li><li><a href="#访问web管理页" class="table-of-contents__link toc-highlight">访问web管理页</a></li><li><a href="#创建bucket" class="table-of-contents__link toc-highlight">创建bucket</a></li><li><a href="#创建access-keys" class="table-of-contents__link toc-highlight">创建Access Keys</a></li><li><a href="#创建访问控制权限" class="table-of-contents__link toc-highlight">创建访问控制权限</a></li><li><a href="#安装mc客户端linux二进制文件" class="table-of-contents__link toc-highlight">安装mc客户端（Linux二进制文件）</a></li><li><a href="#安装mc客户端docker" class="table-of-contents__link toc-highlight">安装mc客户端（docker）</a></li><li><a href="#mc客户端常用命令" class="table-of-contents__link toc-highlight">mc客户端常用命令</a></li><li><a href="#mc连接minio服务" class="table-of-contents__link toc-highlight">mc连接minIO服务</a></li><li><a href="#bucket操作" class="table-of-contents__link toc-highlight">bucket操作</a></li><li><a href="#上传下载操作" class="table-of-contents__link toc-highlight">上传下载操作</a></li><li><a href="#文件操作" class="table-of-contents__link toc-highlight">文件操作</a></li><li><a href="#上传文件" class="table-of-contents__link toc-highlight">上传文件</a></li><li><a href="#下载文件" class="table-of-contents__link toc-highlight">下载文件</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs Releases</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 1.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 2.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 3.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv4" target="_blank" rel="noopener noreferrer" class="footer__link-item">⭐️Version 4.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://agou-ops.cn" target="_blank" rel="noopener noreferrer" class="footer__link-item">⭐️我的博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/AGou-ops" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 AGou-ops' Documetation v4.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.769d471d.js"></script>
<script src="/assets/js/main.cfb3537f.js"></script>
</body>
</html>