<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-CloudNative/Docker/Docker Compose">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Docker Compose | AGou&#x27;s Docsv4</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.agou-ops.cn/docs/CloudNative/Docker/Docker Compose"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker Compose | AGou&#x27;s Docsv4"><meta data-rh="true" name="description" content="Docker Compose 简介"><meta data-rh="true" property="og:description" content="Docker Compose 简介"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.agou-ops.cn/docs/CloudNative/Docker/Docker Compose"><link data-rh="true" rel="alternate" href="https://docs.agou-ops.cn/docs/CloudNative/Docker/Docker Compose" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.agou-ops.cn/docs/CloudNative/Docker/Docker Compose" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-KQED41RW95","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.916b7a43.css">
<link rel="preload" href="/assets/js/runtime~main.755b355e.js" as="script">
<link rel="preload" href="/assets/js/main.7f3bf5c4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">AGou&#x27;s Docsv4</b></a><a href="https://agou-ops.cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">✨ 我的博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"> 📖 目录</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs">🌲 目录树</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/category/云原生相关">☁️ 云原生相关</a></li><li><a class="dropdown__link" href="/docs/category/linux基础">😊 Linux基础</a></li><li><a class="dropdown__link" href="/docs/category/编程语言">♨️ 编程语言</a></li><li><a class="dropdown__link" href="/docs/category/脚本相关">🕹️ 脚本相关</a></li><li><a class="dropdown__link" href="/docs/category/面试相关">👨‍⚖️ 面试相关</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">版本</a><ul class="dropdown__menu"><li><a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver1.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver2.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://agou-ops.cn/myDocsv3" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver3.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/AGou-ops" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub 仓库"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--dark_i4oU"><b>AGou&#x27;s Docsv4</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/云原生相关">云原生相关</a><button aria-label="Toggle the collapsible sidebar category &#x27;云原生相关&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cicd">CICD</a><button aria-label="Toggle the collapsible sidebar category &#x27;CICD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cloudcomptering">CloudComptering</a><button aria-label="Toggle the collapsible sidebar category &#x27;CloudComptering&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/docker">Docker</a><button aria-label="Toggle the collapsible sidebar category &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker Basic">Docker Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/CloudNative/Docker/Docker Compose">Docker Compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker Network">Docker Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker Portainer">Docker Portainer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker Private Registry">Docker Private Registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker Remote Access">Docker 远程访问</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker Volume">Docker Volume</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker openvswitch">Docker openvswitch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker 固定IP及跨主机互通">Docker 固定IP及跨主机互通</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/Docker 容器间通过主机名互相访问">Docker 容器间通过主机名互相访问</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/DockerFile">DockerFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Docker/SSH Docker container">SSH Docker container</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/elfk">ELFK</a><button aria-label="Toggle the collapsible sidebar category &#x27;ELFK&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/prometheus">Prometheus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prometheus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/k8s">k8s</a><button aria-label="Toggle the collapsible sidebar category &#x27;k8s&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Consul 入门">Consul 入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Dubbo Basic">Dubbo Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Grafana Loki Basic">Grafana Loki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/Istio Basic">Istio Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CloudNative/">CloudNative.</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/云原生相关"><span itemprop="name">云原生相关</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/docker"><span itemprop="name">Docker</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker Compose</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Docker Compose</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-compose-简介">Docker Compose 简介<a href="#docker-compose-简介" class="hash-link" aria-label="Direct link to Docker Compose 简介" title="Direct link to Docker Compose 简介">​</a></h2><p>Compose是用于定义和运行多容器Docker应用程序的工具。通过Compose，您可以使用YAML文件来配置应用程序的服务。然后，使用一个命令，就可以从配置中创建并启动所有服务。Compose可在所有环境中工作：生产，登台，开发，测试以及CI工作流。</p><p>使用Compose基本上是一个三步过程：</p><ol><li>使用定义您的应用环境，<code>Dockerfile</code>以便可以在任何地方复制。</li><li>定义组成应用程序的服务，<code>docker-compose.yml</code> 以便它们可以在隔离的环境中一起运行。</li><li>运行 <code>docker-compose up</code>启动并运行您的整个应用程序。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-compose-安装">Docker Compose 安装<a href="#docker-compose-安装" class="hash-link" aria-label="Direct link to Docker Compose 安装" title="Direct link to Docker Compose 安装">​</a></h2><p>运行以下命令以下载Docker Compose的当前稳定版本：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -L </span><span class="token string" style="color:#e3116c">&quot;https://github.com/docker/compose/releases/download/1.25.5/docker-compose-</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">uname</span><span class="token string variable" style="color:#36acaa"> -s</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">-</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">uname</span><span class="token string variable" style="color:#36acaa"> -m</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -o /usr/local/bin/docker-compose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>为其增加可执行权限：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x /usr/local/bin/docker-compose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>检查是否成功安装：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> version </span><span class="token number" style="color:#36acaa">1.25</span><span class="token plain">.5, build 1110ad01</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-常用命令及组合">Docker 常用命令及组合<a href="#docker-常用命令及组合" class="hash-link" aria-label="Direct link to Docker 常用命令及组合" title="Direct link to Docker 常用命令及组合">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-compose相关命令">docker-compose相关命令<a href="#docker-compose相关命令" class="hash-link" aria-label="Direct link to docker-compose相关命令" title="Direct link to docker-compose相关命令">​</a></h3><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 构建镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 构建镜像，--no-cache表示不用缓存，否则在重新编辑Dockerfile后再build可能会直接使用缓存而导致新编辑内容不生效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> build --no-cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># config 校验文件格式是否正确</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> -f docker-compose.yml config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 运行服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ocker-compose up -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 启动/停止服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> start/stop 服务名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 停止服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看容器日志</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> logs -f 容器ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 拉取镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> pull 镜像名</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="常用shell组合">常用shell组合<a href="#常用shell组合" class="hash-link" aria-label="Direct link to 常用shell组合" title="Direct link to 常用shell组合">​</a></h3><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 删除所有容器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> stop </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">docker</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable function" style="color:#d73a49">ps</span><span class="token variable" style="color:#36acaa"> -q -a</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xargs</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 删除所有标签为none的镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> images</span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">&gt;|</span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $3}&#x27;</span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">xargs</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> rmi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查找容器IP地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> inspect 容器名或ID </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;IPAddress&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建网段, 名称: mynet, 分配两个容器在同一网段中 (这样子才可以互相通信)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> network create mynet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -d --net mynet --name container1 my_image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -it --net mynet --name container1 another_image</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>详细参考：<!-- -->[Docker Compose 命令与配置详解]<!-- -->(Docker Compose 命令与配置详解)</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="快速入门-compose--wordpress">快速入门 Compose &amp; Wordpress<a href="#快速入门-compose--wordpress" class="hash-link" aria-label="Direct link to 快速入门 Compose &amp; Wordpress" title="Direct link to 快速入门 Compose &amp; Wordpress">​</a></h2><p>创建项目文件夹：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> my_wordpress/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> my_wordpress/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>创建<code>docker-compose.yml</code>文件：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">version: </span><span class="token string" style="color:#e3116c">&#x27;3.3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   db:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: mysql:5.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - db_data:/var/lib/mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MYSQL_ROOT_PASSWORD: somewordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MYSQL_DATABASE: wordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MYSQL_USER: wordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MYSQL_PASSWORD: wordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   wordpress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     depends_on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     image: wordpress:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - </span><span class="token string" style="color:#e3116c">&quot;8000:80&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       WORDPRESS_DB_HOST: db:3306</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       WORDPRESS_DB_USER: wordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       WORDPRESS_DB_PASSWORD: wordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       WORDPRESS_DB_NAME: wordpress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db_data: </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>构建项目：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker-compose</span><span class="token plain"> up -d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>等待完成之后，打开浏览器访问 <a href="http://127.0.0.1:8000" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8000</a> 即可.</p><blockquote><p>该示例来源于官方文档：<a href="https://docs.docker.com/compose/wordpress/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/wordpress/</a></p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docker-compose-命令与配置详解">Docker Compose 命令与配置详解<a href="#docker-compose-命令与配置详解" class="hash-link" aria-label="Direct link to Docker Compose 命令与配置详解" title="Direct link to Docker Compose 命令与配置详解">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="常用命令参数">常用命令参数<a href="#常用命令参数" class="hash-link" aria-label="Direct link to 常用命令参数" title="Direct link to 常用命令参数">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build       Build or rebuild services </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">构建项目中的服务容器</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bundle       Generate a Docker bundle from the Compose `</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">file</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">从Compose文件生成分布式应用程序包</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">config       Validate and view the Compose </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">file</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">验证并查看Compose文件</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">create       Create services </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">为服务创建容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">down        Stop and remove containers, networks, images, and volumes </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">停止容器并删除由其创建的容器，网络，卷和图像up</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">events       Receive real </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">time</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">events from containers </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">为项目中的每个容器流式传输容器事件</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable builtin class-name" style="color:#36acaa">exec</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">        </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">Execute a </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">command</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable keyword" style="color:#00009f">in</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">a running container </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">这相当于docker </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">exec</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">。使用此子命令，您可以在服务中运行任意命令。默认情况下，命令分配TTY，因此您可以使用命令docker-compose </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">exec</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">web sh来获取交互式提示。</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable builtin class-name" style="color:#36acaa">help</span><span class="token variable" style="color:#36acaa">        Get </span><span class="token variable builtin class-name" style="color:#36acaa">help</span><span class="token variable" style="color:#36acaa"> on a </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">command</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">获得一个命令的帮助</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">images       List images </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable function" style="color:#d73a49">kill</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">        </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">Kill containers </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">通过发送SIGKILL信号来强制停止服务容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">logs        View output from containers </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">查看服务容器的输出</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">pause       Pause services </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">暂停一个容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">port        Print the public port </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable keyword" style="color:#00009f">for</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">a port binding </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">打印某个容器端口所映射的公共端口</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable function" style="color:#d73a49">ps</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">         </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">List containers </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">列出项目中目前所有的容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">pull        Pull </span><span class="token variable function" style="color:#d73a49">service</span><span class="token variable" style="color:#36acaa"> images </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">拉取服务依赖镜像</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">push        Push </span><span class="token variable function" style="color:#d73a49">service</span><span class="token variable" style="color:#36acaa"> images </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">推送服务镜像</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">restart      Restart services </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">重启项目中的服务</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable function" style="color:#d73a49">rm</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">         </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">Remove stopped containers </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">删除所有停止状态的服务容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">run        Run a one-off </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">command</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">在指定服务上执行一个命令</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">scale       Set number of containers </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable keyword" style="color:#00009f">for</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">a </span><span class="token variable function" style="color:#d73a49">service</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">设置指定服务执行的容器个数</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">start       Start services </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">启动已存在的服务容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">stop        Stop services </span><span class="token variable punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">停止已存在的服务容器</span><span class="token variable punctuation" style="color:#393A34">)</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable function" style="color:#d73a49">top</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">        `Display the running processes </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">显示容器正在运行的进程</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unpause      Unpause services </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">恢复处于暂停状态的容器</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">up         Create and start containers </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">自动完成包括构建镜像、创建服务、启动服务并关联服务相关容器的一系列操作</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version      Show the Docker-Compose version information </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">输出版本</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="模板配置文件">模板配置文件<a href="#模板配置文件" class="hash-link" aria-label="Direct link to 模板配置文件" title="Direct link to 模板配置文件">​</a></h3><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Compose和Docker兼容性：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Compose 文件格式有3个版本</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">分别为1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 2.x 和 3.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    目前主流的为 3.x 其支持 docker 1.13.0 及其以上的版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">常用参数：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version           </span><span class="token comment" style="color:#999988;font-style:italic"># 指定 compose 文件的版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    services          </span><span class="token comment" style="color:#999988;font-style:italic"># 定义所有的 service 信息, services 下面的第一级别的 key 既是一个 service 的名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        build                 </span><span class="token comment" style="color:#999988;font-style:italic"># 指定包含构建上下文的路径, 或作为一个对象，该对象具有 context 和指定的 dockerfile 文件以及 args 参数值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context               </span><span class="token comment" style="color:#999988;font-style:italic"># context: 指定 Dockerfile 文件所在的路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dockerfile            </span><span class="token comment" style="color:#999988;font-style:italic"># dockerfile: 指定 context 指定的目录下面的 Dockerfile 的名称(默认为 Dockerfile)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            args                  </span><span class="token comment" style="color:#999988;font-style:italic"># args: Dockerfile 在 build 过程中需要的参数 (等同于 docker container build --build-arg 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cache_from            </span><span class="token comment" style="color:#999988;font-style:italic"># v3.2中新增的参数, 指定缓存的镜像列表 (等同于 docker container build --cache_from 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            labels                </span><span class="token comment" style="color:#999988;font-style:italic"># v3.3中新增的参数, 设置镜像的元数据 (等同于 docker container build --labels 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            shm_size              </span><span class="token comment" style="color:#999988;font-style:italic"># v3.5中新增的参数, 设置容器 /dev/shm 分区的大小 (等同于 docker container build --shm-size 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command               </span><span class="token comment" style="color:#999988;font-style:italic"># 覆盖容器启动后默认执行的命令, 支持 shell 格式和 [] 格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        configs               </span><span class="token comment" style="color:#999988;font-style:italic"># 不知道怎么用，哈哈。。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cgroup_parent         </span><span class="token comment" style="color:#999988;font-style:italic"># 不知道怎么用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        container_name        </span><span class="token comment" style="color:#999988;font-style:italic"># 指定容器的名称 (等同于 docker run --name 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        credential_spec       </span><span class="token comment" style="color:#999988;font-style:italic"># 不知道怎么用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        deploy                </span><span class="token comment" style="color:#999988;font-style:italic"># v3 版本以上, 指定与部署和运行服务相关的配置, deploy 部分是 docker stack 使用的, docker stack 依赖 docker swarm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            endpoint_mode         </span><span class="token comment" style="color:#999988;font-style:italic"># v3.3 版本中新增的功能, 指定服务暴露的方式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                vip                   </span><span class="token comment" style="color:#999988;font-style:italic"># Docker 为该服务分配了一个虚拟 IP(VIP), 作为客户端的访问服务的地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                dnsrr                 </span><span class="token comment" style="color:#999988;font-style:italic"># DNS轮询, Docker 为该服务设置 DNS 条目, 使得服务名称的 DNS 查询返回一个 IP 地址列表, 客户端直接访问其中的一个地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            labels                </span><span class="token comment" style="color:#999988;font-style:italic"># 指定服务的标签，这些标签仅在服务上设置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mode                  </span><span class="token comment" style="color:#999988;font-style:italic"># 指定 deploy 的模式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                global                </span><span class="token comment" style="color:#999988;font-style:italic"># 每个集群节点都只有一个容器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                replicated            </span><span class="token comment" style="color:#999988;font-style:italic"># 用户可以指定集群中容器的数量(默认)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            placement             </span><span class="token comment" style="color:#999988;font-style:italic"># 不知道怎么用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            replicas              </span><span class="token comment" style="color:#999988;font-style:italic"># deploy 的 mode 为 replicated 时, 指定容器副本的数量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            resources             </span><span class="token comment" style="color:#999988;font-style:italic"># 资源限制</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                limits                </span><span class="token comment" style="color:#999988;font-style:italic"># 设置容器的资源限制</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">cpus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.5&quot;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># 设置该容器最多只能使用 50% 的 CPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 50M           </span><span class="token comment" style="color:#999988;font-style:italic"># 设置该容器最多只能使用 50M 的内存空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reservations          </span><span class="token comment" style="color:#999988;font-style:italic"># 设置为容器预留的系统资源(随时可用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">cpus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.2&quot;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># 为该容器保留 20% 的 CPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 20M           </span><span class="token comment" style="color:#999988;font-style:italic"># 为该容器保留 20M 的内存空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            restart_policy        </span><span class="token comment" style="color:#999988;font-style:italic"># 定义容器重启策略, 用于代替 restart 参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                condition             </span><span class="token comment" style="color:#999988;font-style:italic"># 定义容器重启策略(接受三个参数)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    none                  </span><span class="token comment" style="color:#999988;font-style:italic"># 不尝试重启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    on</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">failure            </span><span class="token comment" style="color:#999988;font-style:italic"># 只有当容器内部应用程序出现问题才会重启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    any                   </span><span class="token comment" style="color:#999988;font-style:italic"># 无论如何都会尝试重启(默认)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                delay                 </span><span class="token comment" style="color:#999988;font-style:italic"># 尝试重启的间隔时间(默认为 0s)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                max_attempts          </span><span class="token comment" style="color:#999988;font-style:italic"># 尝试重启次数(默认一直尝试重启)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                window                </span><span class="token comment" style="color:#999988;font-style:italic"># 检查重启是否成功之前的等待时间(即如果容器启动了, 隔多少秒之后去检测容器是否正常, 默认 0s)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            update_config         </span><span class="token comment" style="color:#999988;font-style:italic"># 用于配置滚动更新配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                parallelism           </span><span class="token comment" style="color:#999988;font-style:italic"># 一次性更新的容器数量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                delay                 </span><span class="token comment" style="color:#999988;font-style:italic"># 更新一组容器之间的间隔时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                failure_action        </span><span class="token comment" style="color:#999988;font-style:italic"># 定义更新失败的策略</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    continue              </span><span class="token comment" style="color:#999988;font-style:italic"># 继续更新</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rollback              </span><span class="token comment" style="color:#999988;font-style:italic"># 回滚更新</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    pause                 </span><span class="token comment" style="color:#999988;font-style:italic"># 暂停更新(默认)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                monitor               </span><span class="token comment" style="color:#999988;font-style:italic"># 每次更新后的持续时间以监视更新是否失败(单位: ns|us|ms|s|m|h) (默认为0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                max_failure_ratio     </span><span class="token comment" style="color:#999988;font-style:italic"># 回滚期间容忍的失败率(默认值为0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                order                 </span><span class="token comment" style="color:#999988;font-style:italic"># v3.4 版本中新增的参数, 回滚期间的操作顺序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    stop</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">first            </span><span class="token comment" style="color:#999988;font-style:italic">#旧任务在启动新任务之前停止(默认)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    start</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">first           </span><span class="token comment" style="color:#999988;font-style:italic">#首先启动新任务, 并且正在运行的任务暂时重叠</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rollback_config       </span><span class="token comment" style="color:#999988;font-style:italic"># v3.7 版本中新增的参数, 用于定义在 update_config 更新失败的回滚策略</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                parallelism           </span><span class="token comment" style="color:#999988;font-style:italic"># 一次回滚的容器数, 如果设置为0, 则所有容器同时回滚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                delay                 </span><span class="token comment" style="color:#999988;font-style:italic"># 每个组回滚之间的时间间隔(默认为0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                failure_action        </span><span class="token comment" style="color:#999988;font-style:italic"># 定义回滚失败的策略</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    continue              </span><span class="token comment" style="color:#999988;font-style:italic"># 继续回滚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    pause                 </span><span class="token comment" style="color:#999988;font-style:italic"># 暂停回滚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                monitor               </span><span class="token comment" style="color:#999988;font-style:italic"># 每次回滚任务后的持续时间以监视失败(单位: ns|us|ms|s|m|h) (默认为0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                max_failure_ratio     </span><span class="token comment" style="color:#999988;font-style:italic"># 回滚期间容忍的失败率(默认值0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                order                 </span><span class="token comment" style="color:#999988;font-style:italic"># 回滚期间的操作顺序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    stop</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">first            </span><span class="token comment" style="color:#999988;font-style:italic"># 旧任务在启动新任务之前停止(默认)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    start</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">first           </span><span class="token comment" style="color:#999988;font-style:italic"># 首先启动新任务, 并且正在运行的任务暂时重叠</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 注意：支持 docker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">compose up 和 docker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">compose run 但不支持 docker stack deploy 的子选项security_opt  container_name  devices  tmpfs  stop_signal  links    cgroup_parent etwork_mode  external_links  restart  build  userns_mode  sysctls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        devices               </span><span class="token comment" style="color:#999988;font-style:italic"># 指定设备映射列表 (等同于 docker run --device 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        depends_on            </span><span class="token comment" style="color:#999988;font-style:italic"># 定义容器启动顺序 (此选项解决了容器之间的依赖关系， 此选项在 v3 版本中 使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dns                   </span><span class="token comment" style="color:#999988;font-style:italic"># 设置 DNS 地址(等同于 docker run --dns 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dns_search            </span><span class="token comment" style="color:#999988;font-style:italic"># 设置 DNS 搜索域(等同于 docker run --dns-search 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmpfs                 </span><span class="token comment" style="color:#999988;font-style:italic"># v2 版本以上, 挂载目录到容器中, 作为容器的临时文件系统(等同于 docker run --tmpfs 的作用, 在使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        entrypoint            </span><span class="token comment" style="color:#999988;font-style:italic"># 覆盖容器的默认 entrypoint 指令 (等同于 docker run --entrypoint 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env_file              </span><span class="token comment" style="color:#999988;font-style:italic"># 从指定文件中读取变量设置为容器中的环境变量, 可以是单个值或者一个文件列表, 如果多个文件中的变量重名则后面的变量覆盖前面的变量, environment 的值覆盖 env_file 的值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            文件格式：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                RACK_ENV=development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment           </span><span class="token comment" style="color:#999988;font-style:italic"># 设置环境变量， environment 的值可以覆盖 env_file 的值 (等同于 docker run --env 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        expose                </span><span class="token comment" style="color:#999988;font-style:italic"># 暴露端口, 但是不能和宿主机建立映射关系, 类似于 Dockerfile 的 EXPOSE 指令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        external_links        </span><span class="token comment" style="color:#999988;font-style:italic"># 连接不在 docker-compose.yml 中定义的容器或者不在 compose 管理的容器(docker run 启动的容器, 在 v3 版本中使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        extra_hosts           </span><span class="token comment" style="color:#999988;font-style:italic"># 添加 host 记录到容器中的 /etc/hosts 中 (等同于 docker run --add-host 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        healthcheck           </span><span class="token comment" style="color:#999988;font-style:italic"># v2.1 以上版本, 定义容器健康状态检查, 类似于 Dockerfile 的 HEALTHCHECK 指令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            test                  </span><span class="token comment" style="color:#999988;font-style:italic"># 检查容器检查状态的命令, 该选项必须是一个字符串或者列表, 第一项必须是 NONE, CMD 或 CMD-SHELL, 如果其是一个字符串则相当于 CMD-SHELL 加该字符串</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                NONE                  </span><span class="token comment" style="color:#999988;font-style:italic"># 禁用容器的健康状态检测</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                CMD                   </span><span class="token comment" style="color:#999988;font-style:italic"># test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://127.0.0.1&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                CMD</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">SHELL             </span><span class="token comment" style="color:#999988;font-style:italic"># test: [&quot;CMD-SHELL&quot;, &quot;curl -f http://127.0.0.1 || exit 1&quot;] 或者　test: curl -f https://localhost || exit 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1m30s       </span><span class="token comment" style="color:#999988;font-style:italic"># 每次检查之间的间隔时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 10s          </span><span class="token comment" style="color:#999988;font-style:italic"># 运行命令的超时时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">retries</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 重试次数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">start_period</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 40s     </span><span class="token comment" style="color:#999988;font-style:italic"># v3.4 以上新增的选项, 定义容器启动时间间隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">disable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># true 或 false, 表示是否禁用健康状态检测和　test: NONE 相同</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image                 </span><span class="token comment" style="color:#999988;font-style:italic"># 指定 docker 镜像, 可以是远程仓库镜像、本地镜像</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        init                  </span><span class="token comment" style="color:#999988;font-style:italic"># v3.7 中新增的参数, true 或 false 表示是否在容器中运行一个 init, 它接收信号并传递给进程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isolation             </span><span class="token comment" style="color:#999988;font-style:italic"># 隔离容器技术, 在 Linux 中仅支持 default 值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        labels                </span><span class="token comment" style="color:#999988;font-style:italic"># 使用 Docker 标签将元数据添加到容器, 与 Dockerfile 中的 LABELS 类似</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        links                 </span><span class="token comment" style="color:#999988;font-style:italic"># 链接到其它服务中的容器, 该选项是 docker 历史遗留的选项, 目前已被用户自定义网络名称空间取代, 最终有可能被废弃 (在使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logging               </span><span class="token comment" style="color:#999988;font-style:italic"># 设置容器日志服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            driver                </span><span class="token comment" style="color:#999988;font-style:italic"># 指定日志记录驱动程序, 默认 json-file (等同于 docker run --log-driver 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            options               </span><span class="token comment" style="color:#999988;font-style:italic"># 指定日志的相关参数 (等同于 docker run --log-opt 的作用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                max</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">size              </span><span class="token comment" style="color:#999988;font-style:italic"># 设置单个日志文件的大小, 当到达这个值后会进行日志滚动操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                max</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">file              </span><span class="token comment" style="color:#999988;font-style:italic"># 日志文件保留的数量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        network_mode          </span><span class="token comment" style="color:#999988;font-style:italic"># 指定网络模式 (等同于 docker run --net 的作用, 在使用 swarm 部署时将忽略该选项)        </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        networks              </span><span class="token comment" style="color:#999988;font-style:italic"># 将容器加入指定网络 (等同于 docker network connect 的作用), networks 可以位于 compose 文件顶级键和 services 键的二级键</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            aliases               </span><span class="token comment" style="color:#999988;font-style:italic"># 同一网络上的容器可以使用服务名称或别名连接到其中一个服务的容器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ipv4_address      </span><span class="token comment" style="color:#999988;font-style:italic"># IP V4 格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ipv6_address      </span><span class="token comment" style="color:#999988;font-style:italic"># IP V6 格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pid</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;host&#x27;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># 共享宿主机的 进程空间(PID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports                 </span><span class="token comment" style="color:#999988;font-style:italic"># 建立宿主机和容器之间的端口映射关系, ports 支持两种语法格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">SHORT 语法格式示例</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3000&quot;</span><span class="token plain">                            </span><span class="token comment" style="color:#999988;font-style:italic"># 暴露容器的 3000 端口, 宿主机的端口由 docker 随机映射一个没有被占用的端口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3000-3005&quot;</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># 暴露容器的 3000 到 3005 端口, 宿主机的端口由 docker 随机映射没有被占用的端口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8000:8000&quot;</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># 容器的 8000 端口和宿主机的 8000 端口建立映射关系</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;9090-9091:8080-8081&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1:8001:8001&quot;</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># 指定映射宿主机的指定地址的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1:5000-5010:5000-5010&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;6060:6060/udp&quot;</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># 指定协议</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LONG 语法格式示例</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">(v3.2 新增的语法格式)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># 容器端口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token key atrule" style="color:#00a4db">published</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic"># 宿主机端口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token key atrule" style="color:#00a4db">protocol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tcp                 </span><span class="token comment" style="color:#999988;font-style:italic"># 协议类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token key atrule" style="color:#00a4db">mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> host                    </span><span class="token comment" style="color:#999988;font-style:italic"># host 在每个节点上发布主机端口,  ingress 对于群模式端口进行负载均衡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secrets               </span><span class="token comment" style="color:#999988;font-style:italic"># 不知道怎么用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        security_opt          </span><span class="token comment" style="color:#999988;font-style:italic"># 为每个容器覆盖默认的标签 (在使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stop_grace_period     </span><span class="token comment" style="color:#999988;font-style:italic"># 指定在发送了 SIGTERM 信号之后, 容器等待多少秒之后退出(默认 10s)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stop_signal           </span><span class="token comment" style="color:#999988;font-style:italic"># 指定停止容器发送的信号 (默认为 SIGTERM 相当于 kill PID; SIGKILL 相当于 kill -9 PID; 在使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sysctls               </span><span class="token comment" style="color:#999988;font-style:italic"># 设置容器中的内核参数 (在使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ulimits               </span><span class="token comment" style="color:#999988;font-style:italic"># 设置容器的 limit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userns_mode           </span><span class="token comment" style="color:#999988;font-style:italic"># 如果Docker守护程序配置了用户名称空间, 则禁用此服务的用户名称空间 (在使用 swarm 部署时将忽略该选项)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumes               </span><span class="token comment" style="color:#999988;font-style:italic"># 定义容器和宿主机的卷映射关系, 其和 networks 一样可以位于 services 键的二级键和 compose 顶级键, 如果需要跨服务间使用则在顶级键定义, 在 services 中引用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">SHORT 语法格式示例</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /var/lib/mysql                </span><span class="token comment" style="color:#999988;font-style:italic"># 映射容器内的 /var/lib/mysql 到宿主机的一个随机目录中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /opt/data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/var/lib/mysql      </span><span class="token comment" style="color:#999988;font-style:italic"># 映射容器内的 /var/lib/mysql 到宿主机的 /opt/data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./cache</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/tmp/cache            </span><span class="token comment" style="color:#999988;font-style:italic"># 映射容器内的 /var/lib/mysql 到宿主机 compose 文件所在的位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ~/configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/etc/configs/</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">ro    </span><span class="token comment" style="color:#999988;font-style:italic"># 映射容器宿主机的目录到容器中去, 权限只读</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> datavolume</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/var/lib/mysql     </span><span class="token comment" style="color:#999988;font-style:italic"># datavolume 为 volumes 顶级键定义的目录, 在此处直接调用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LONG 语法格式示例</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">(v3.2 新增的语法格式)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3.2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">web</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;80:80&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> volume                  </span><span class="token comment" style="color:#999988;font-style:italic"># mount 的类型, 必须是 bind、volume 或 tmpfs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mydata              </span><span class="token comment" style="color:#999988;font-style:italic"># 宿主机目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /data               </span><span class="token comment" style="color:#999988;font-style:italic"># 容器目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token key atrule" style="color:#00a4db">volume</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic"># 配置额外的选项, 其 key 必须和 type 的值相同</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    </span><span class="token key atrule" style="color:#00a4db">nocopy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># volume 额外的选项, 在创建卷时禁用从容器复制数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bind                    </span><span class="token comment" style="color:#999988;font-style:italic"># volume 模式只指定容器路径即可, 宿主机路径随机生成; bind 需要指定容器和数据机的映射路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./static</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/app/static</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token key atrule" style="color:#00a4db">read_only</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic"># 设置文件系统为只读文件系统</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">mydata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                                 </span><span class="token comment" style="color:#999988;font-style:italic"># 定义在 volume, 可在所有服务中调用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        restart               </span><span class="token comment" style="color:#999988;font-style:italic"># 定义容器重启策略(在使用 swarm 部署时将忽略该选项, 在 swarm 使用 restart_policy 代替 restart)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            no                    </span><span class="token comment" style="color:#999988;font-style:italic"># 禁止自动重启容器(默认)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            always                </span><span class="token comment" style="color:#999988;font-style:italic"># 无论如何容器都会重启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            on</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">failure            </span><span class="token comment" style="color:#999988;font-style:italic"># 当出现 on-failure 报错时, 容器重新启动</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        其他选项：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            domainname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hostname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ipc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mac_address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> privileged</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> read_only</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shm_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stdin_open</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> working_dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            上面这些选项都只接受单个值和 docker run 的对应参数类似</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        对于值为时间的可接受的值：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2.5s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1m30s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2h32m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            5h34m56s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">时间单位</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> us</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ms</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m， h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        对于值为大小的可接受的值：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1024kb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2048k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            300m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            1gb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">单位</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> g 或者 kb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> gb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    networks          </span><span class="token comment" style="color:#999988;font-style:italic"># 定义 networks 信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        driver                </span><span class="token comment" style="color:#999988;font-style:italic"># 指定网络模式, 大多数情况下, 它 bridge 于单个主机和 overlay Swarm 上</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bridge                </span><span class="token comment" style="color:#999988;font-style:italic"># Docker 默认使用 bridge 连接单个主机上的网络</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            overlay               </span><span class="token comment" style="color:#999988;font-style:italic"># overlay 驱动程序创建一个跨多个节点命名的网络</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            host                  </span><span class="token comment" style="color:#999988;font-style:italic"># 共享主机网络名称空间(等同于 docker run --net=host)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            none                  </span><span class="token comment" style="color:#999988;font-style:italic"># 等同于 docker run --net=none</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        driver_opts           </span><span class="token comment" style="color:#999988;font-style:italic"># v3.2以上版本, 传递给驱动程序的参数, 这些参数取决于驱动程序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        attachable            </span><span class="token comment" style="color:#999988;font-style:italic"># driver 为 overlay 时使用, 如果设置为 true 则除了服务之外，独立容器也可以附加到该网络; 如果独立容器连接到该网络，则它可以与其他 Docker 守护进程连接到的该网络的服务和独立容器进行通信</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ipam                  </span><span class="token comment" style="color:#999988;font-style:italic"># 自定义 IPAM 配置. 这是一个具有多个属性的对象, 每个属性都是可选的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            driver                </span><span class="token comment" style="color:#999988;font-style:italic"># IPAM 驱动程序, bridge 或者 default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config                </span><span class="token comment" style="color:#999988;font-style:italic"># 配置项</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                subnet                </span><span class="token comment" style="color:#999988;font-style:italic"># CIDR格式的子网，表示该网络的网段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        external              </span><span class="token comment" style="color:#999988;font-style:italic"># 外部网络, 如果设置为 true 则 docker-compose up 不会尝试创建它, 如果它不存在则引发错误</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name                  </span><span class="token comment" style="color:#999988;font-style:italic"># v3.5 以上版本, 为此网络设置名称</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="示例">示例<a href="#示例" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h2><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">示例：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">compose up 以依赖顺序启动服务，下面例子中 redis 和 db 服务在 web 启动前启动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">默认情况下使用 docker</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">compose up web 这样的方式启动 web 服务时，也会启动 redis 和 db 两个服务，因为在配置文件中定义了依赖关系</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">web</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> db     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> redis </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> redis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">db</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> postgres                            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">示例</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;3.7&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mynginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ifconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">app_net</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                                </span><span class="token comment" style="color:#999988;font-style:italic"># 调用下面 networks 定义的 app_net 网络</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">ipv4_address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.16.238.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app_net</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">driver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ipam</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">driver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">subnet</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.16.238.0/24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">文件格式示例：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;6379&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">update_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">parallelism</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">delay</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">restart_policy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">condition</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">db</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> postgres</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/var/lib/postgresql/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">placement</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">constraints</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">node.role == manager</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="参考链接">参考链接<a href="#参考链接" class="hash-link" aria-label="Direct link to 参考链接" title="Direct link to 参考链接">​</a></h2><ul><li>Docker Compose Documentation：<a href="https://docs.docker.com/compose/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/</a></li><li>compose-file：<a href="https://docs.docker.com/compose/compose-file/#compose-file-structure-and-examples" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/compose-file/#compose-file-structure-and-examples</a></li><li>cnblogs @zhujingzhi ：<a href="https://www.cnblogs.com/zhujingzhi/p/9786622.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/zhujingzhi/p/9786622.html</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CloudNative/Docker/Docker Compose.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/CloudNative/Docker/Docker Basic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Docker Basic</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/CloudNative/Docker/Docker Network"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Docker Network</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#docker-compose-简介" class="table-of-contents__link toc-highlight">Docker Compose 简介</a></li><li><a href="#docker-compose-安装" class="table-of-contents__link toc-highlight">Docker Compose 安装</a></li><li><a href="#docker-常用命令及组合" class="table-of-contents__link toc-highlight">Docker 常用命令及组合</a><ul><li><a href="#docker-compose相关命令" class="table-of-contents__link toc-highlight">docker-compose相关命令</a></li><li><a href="#常用shell组合" class="table-of-contents__link toc-highlight">常用shell组合</a></li></ul></li><li><a href="#快速入门-compose--wordpress" class="table-of-contents__link toc-highlight">快速入门 Compose &amp; Wordpress</a></li><li><a href="#docker-compose-命令与配置详解" class="table-of-contents__link toc-highlight">Docker Compose 命令与配置详解</a><ul><li><a href="#常用命令参数" class="table-of-contents__link toc-highlight">常用命令参数</a></li><li><a href="#模板配置文件" class="table-of-contents__link toc-highlight">模板配置文件</a></li></ul></li><li><a href="#示例" class="table-of-contents__link toc-highlight">示例</a></li><li><a href="#参考链接" class="table-of-contents__link toc-highlight">参考链接</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs Releases</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 1.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 2.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 3.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv4" target="_blank" rel="noopener noreferrer" class="footer__link-item">⭐️Version 4.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://agou-ops.cn" target="_blank" rel="noopener noreferrer" class="footer__link-item">⭐️我的博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/AGou-ops" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 AGou-ops' Documetation v4.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.755b355e.js"></script>
<script src="/assets/js/main.7f3bf5c4.js"></script>
</body>
</html>