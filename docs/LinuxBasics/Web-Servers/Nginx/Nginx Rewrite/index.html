<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-LinuxBasics/Web-Servers/Nginx/Nginx Rewrite">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Nginx Rewrite åœ°å€é‡å†™ | AGou&#x27;s Docsv4</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.agou-ops.cn/docs/LinuxBasics/Web-Servers/Nginx/Nginx Rewrite"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Nginx Rewrite åœ°å€é‡å†™ | AGou&#x27;s Docsv4"><meta data-rh="true" name="description" content="Rewriteè§„åˆ™å¯ä»¥å®ç°å¯¹urlçš„é‡å†™ï¼Œä»¥åŠé‡å®šå‘"><meta data-rh="true" property="og:description" content="Rewriteè§„åˆ™å¯ä»¥å®ç°å¯¹urlçš„é‡å†™ï¼Œä»¥åŠé‡å®šå‘"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.agou-ops.cn/docs/LinuxBasics/Web-Servers/Nginx/Nginx Rewrite"><link data-rh="true" rel="alternate" href="https://docs.agou-ops.cn/docs/LinuxBasics/Web-Servers/Nginx/Nginx Rewrite" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.agou-ops.cn/docs/LinuxBasics/Web-Servers/Nginx/Nginx Rewrite" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-KQED41RW95","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.6908ad1e.css">
<link rel="preload" href="/assets/js/runtime~main.d3f82a4d.js" as="script">
<link rel="preload" href="/assets/js/main.7273c711.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">AGou&#x27;s Docsv4</b></a><a href="https://agou-ops.cn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">âœ¨ æˆ‘çš„åšå®¢<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"> ğŸ“– ç›®å½•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs">ğŸŒ² ç›®å½•æ ‘</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a class="dropdown__link" href="/docs/category/äº‘åŸç”Ÿç›¸å…³">â˜ï¸ äº‘åŸç”Ÿç›¸å…³</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/category/linuxåŸºç¡€">ğŸ˜Š LinuxåŸºç¡€</a></li><li><a class="dropdown__link" href="/docs/category/ç¼–ç¨‹è¯­è¨€">â™¨ï¸ ç¼–ç¨‹è¯­è¨€</a></li><li><a class="dropdown__link" href="/docs/category/è„šæœ¬ç›¸å…³">ğŸ•¹ï¸ è„šæœ¬ç›¸å…³</a></li><li><a class="dropdown__link" href="/docs/category/é¢è¯•ç›¸å…³">ğŸ‘¨â€âš–ï¸ é¢è¯•ç›¸å…³</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ç‰ˆæœ¬</a><ul class="dropdown__menu"><li><a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver1.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver2.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://agou-ops.cn/myDocsv3" target="_blank" rel="noopener noreferrer" class="dropdown__link">Ver3.0<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/AGou-ops" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub ä»“åº“"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Welcome to AGou&#x27;s Docs!" class="themedImage_ToTc themedImage--dark_i4oU"><b>AGou&#x27;s Docsv4</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/linuxåŸºç¡€">LinuxåŸºç¡€</a><button aria-label="Toggle the collapsible sidebar category &#x27;LinuxåŸºç¡€&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/ansible">Ansible</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cache">Cache</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cache&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/dhcp-pxe-cobbler">DHCP-PXE-Cobbler</a><button aria-label="Toggle the collapsible sidebar category &#x27;DHCP-PXE-Cobbler&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/databases">DataBases</a><button aria-label="Toggle the collapsible sidebar category &#x27;DataBases&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/filesystem">FileSystem</a><button aria-label="Toggle the collapsible sidebar category &#x27;FileSystem&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/kvm">KVM</a><button aria-label="Toggle the collapsible sidebar category &#x27;KVM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/kafka">Kafka</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kafka&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/loadbalancer">LoadBalancer</a><button aria-label="Toggle the collapsible sidebar category &#x27;LoadBalancer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/makefile">Makefile</a><button aria-label="Toggle the collapsible sidebar category &#x27;Makefile&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/nexus">Nexus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Nexus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/rabbitmq">RabbitMQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;RabbitMQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/shell">Shell</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shell&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/springboot">SpringBoot</a><button aria-label="Toggle the collapsible sidebar category &#x27;SpringBoot&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/terraform">Terraform</a><button aria-label="Toggle the collapsible sidebar category &#x27;Terraform&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/web-servers">Web-Servers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web-Servers&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/apache">Apache</a><button aria-label="Toggle the collapsible sidebar category &#x27;Apache&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/jvm-tomcat">Jvm-Tomcat</a><button aria-label="Toggle the collapsible sidebar category &#x27;Jvm-Tomcat&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/nginx">Nginx</a><button aria-label="Toggle the collapsible sidebar category &#x27;Nginx&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/others">Others</a><button aria-label="Toggle the collapsible sidebar category &#x27;Others&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/problems">Problems</a><button aria-label="Toggle the collapsible sidebar category &#x27;Problems&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/HTTPS  é…ç½®åŠä¼˜åŒ–">https é…ç½®åŠä¼˜åŒ–</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx - uWSGI éƒ¨ç½²Django">Nginx+uWSGIéƒ¨ç½²Djangoé¡¹ç›®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx Cache">Nginx ç¼“å­˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx Rewrite">Nginx Rewrite åœ°å€é‡å†™</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx php-fpm">nginx php-fpm å¿«é€Ÿæ‰‹å†Œ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx try_files">nginx try_files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx å†…ç½®å˜é‡">Nginx å†…ç½®å˜é‡</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx åå‘ä»£ç†">Nginx åå‘ä»£ç†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx å¹³æ»‘å‡çº§ä¸å›æ»š">Nginx å¹³æ»‘å‡çº§ä¸å›æ»š</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx å¿«é€Ÿé…ç½®æ‰‹å†Œ">Nginx å¿«é€Ÿæ‰‹å†Œ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx æ€§èƒ½ä¼˜åŒ–ä¸å®‰å…¨">Nginx æ€§èƒ½ä¼˜åŒ–ä¸å®‰å…¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx çˆ¬è™«é™åˆ¶">Nginx çˆ¬è™«é™åˆ¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx ç¼–è¯‘åŠåˆ¶ä½œåŒ…">Nginx ç¼–è¯‘åŠåˆ¶ä½œåŒ…</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx è´Ÿè½½å‡è¡¡">Nginx è´Ÿè½½å‡è¡¡</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx é«˜çº§æ¨¡å—">Nginx é«˜çº§æ¨¡å—åŠä¼˜åŒ–</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/php">PHP</a><button aria-label="Toggle the collapsible sidebar category &#x27;PHP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/python-django">Python-Django</a><button aria-label="Toggle the collapsible sidebar category &#x27;Python-Django&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/zabbix">Zabbix</a><button aria-label="Toggle the collapsible sidebar category &#x27;Zabbix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/zookeeper">Zookeeper</a><button aria-label="Toggle the collapsible sidebar category &#x27;Zookeeper&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/CertBot Nginx SSL">CertBot Nginx SSL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Fail2ban ç®€å•ä½¿ç”¨">Fail2ban ç®€å•ä½¿ç”¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Firewalld IPtableså¿«é€Ÿæ‰‹å†Œ">firewalld iptableså¿«é€Ÿæ‰‹å†Œ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/JumpServer">JumpServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Linux å‹æµ‹å¤§å…¨">Linux å‹æµ‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Linuxè¯Šæ–­">Linuxè¯Šæ–­</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/OpenVPN for CentOS">OpenVPN for CentOS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/LinuxBasics/PVE/PVE Tips">PVE</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/PowerDNS">PowerDNS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/SQL review">SQL å¤ä¹ </a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/SSH Tunnel">SSH Tunnel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Split - Logrotate">Split &amp; Logrotate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Tcpdump - Wireshark">tcpdump &amp; wireshark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Useful Command">å‘½ä»¤ç¬”è®°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/VPS èŠ‚ç‚¹æ­å»º">VPS èŠ‚ç‚¹æ­å»º</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Vagrant">Vagrant Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/Windows useful cmd">windows å‘½ä»¤æŒ‡ç¤ºç¬¦</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/WireGuard VPN for Ubuntu">WireGuard VPN for Ubuntu</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/dnsmasq">dnsmasq éƒ¨ç½²ä¸ä½¿ç”¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/">Linux Basics.</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/inotifywait æ–‡ä»¶ç›‘æ§">Inotify æ–‡ä»¶ç›‘æ§</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/k3s - k3d Basic">k3s &amp; k3d Basic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/keepalived">keepalived</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/lsyncd">lsyncd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/lvm è®²è§£">lvm è®²è§£</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/rsync - inotifyï¼ˆsersyncï¼‰">rsync + inotify(sersync)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/vim tricks">æ¯å¤©ä¸€ä¸ªvimå°æŠ€å·§</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/æœªå‘½å">æœªå‘½å</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/è‡ªå»ºdns">è‡ªå»ºdns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/è‡ªå»ºé‚®ç®±æœåŠ¡å™¨">è‡ªå»ºé‚®ç®±æœåŠ¡å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/LinuxBasics/è“é²¸è¿ç»´å¹³å°">è“é²¸è¿ç»´å¹³å°</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/linuxåŸºç¡€"><span itemprop="name">LinuxåŸºç¡€</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/web-servers"><span itemprop="name">Web-Servers</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/nginx"><span itemprop="name">Nginx</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Nginx Rewrite åœ°å€é‡å†™</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Nginx Rewrite åœ°å€é‡å†™</h1><p>Rewriteè§„åˆ™å¯ä»¥å®ç°å¯¹urlçš„é‡å†™ï¼Œä»¥åŠé‡å®šå‘</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯<a href="#åº”ç”¨åœºæ™¯" class="hash-link" aria-label="Direct link to åº”ç”¨åœºæ™¯" title="Direct link to åº”ç”¨åœºæ™¯">â€‹</a></h2><ul><li>åœ°å€è·³è½¬å’Œåè®®è·³è½¬</li><li>ä¼ªé™æ€ï¼Œåˆ©äºæœç´¢å¼•æ“çˆ¬è™«å’ŒSEO</li><li>è°ƒæ•´ç”¨æˆ·æµè§ˆçš„URLï¼Œçœ‹èµ·æ¥è§„èŒƒï¼Œåˆ©äºSEO</li><li>ç½‘ç«™æ›´æ¢æ–°åŸŸå</li><li>æ ¹æ®ç‰¹æ®Šçš„å˜é‡ã€ç›®å½•ã€å®¢æˆ·ç«¯ä¿¡æ¯è¿›è¡Œè·³è½¬</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è§„åˆ™ä¼˜å…ˆçº§">è§„åˆ™ä¼˜å…ˆçº§<a href="#è§„åˆ™ä¼˜å…ˆçº§" class="hash-link" aria-label="Direct link to è§„åˆ™ä¼˜å…ˆçº§" title="Direct link to è§„åˆ™ä¼˜å…ˆçº§">â€‹</a></h2><ol><li>å…ˆæ‰§è¡Œserverå—çš„rewriteæŒ‡ä»¤</li><li>å…¶æ¬¡æ‰§è¡ŒlocationåŒ¹é…è§„åˆ™</li><li>æœ€åæ‰§è¡Œlocationä¸­çš„rewrite</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å…¨å±€å˜é‡">å…¨å±€å˜é‡<a href="#å…¨å±€å˜é‡" class="hash-link" aria-label="Direct link to å…¨å±€å˜é‡" title="Direct link to å…¨å±€å˜é‡">â€‹</a></h2><p>åœ¨<code>rewrite</code>è¿‡ç¨‹ä¸­ï¼Œä¼šç”¨åˆ°ä¸€äº›å…¨å±€å˜é‡ï¼š</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$args</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¿™ä¸ªå˜é‡ç­‰äºè¯·æ±‚è¡Œä¸­çš„å‚æ•°ï¼ŒåŒ$query_string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$content_length</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¯·æ±‚å¤´ä¸­çš„Content-lengthå­—æ®µã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$content_type</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¯·æ±‚å¤´ä¸­çš„Content-Typeå­—æ®µã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$document_root</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å½“å‰è¯·æ±‚åœ¨rootæŒ‡ä»¤ä¸­æŒ‡å®šçš„å€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$host</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¯·æ±‚ä¸»æœºå¤´å­—æ®µï¼Œå¦åˆ™ä¸ºæœåŠ¡å™¨åç§°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$http_user_agent</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å®¢æˆ·ç«¯agentä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$http_cookie</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å®¢æˆ·ç«¯cookieä¿¡æ¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$limit_rate</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¿™ä¸ªå˜é‡å¯ä»¥é™åˆ¶è¿æ¥é€Ÿç‡ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$request_method</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œï¼Œé€šå¸¸ä¸ºGETæˆ–POSTã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$remote_addr</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å®¢æˆ·ç«¯çš„IPåœ°å€ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$remote_port</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å®¢æˆ·ç«¯çš„ç«¯å£ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$remote_user</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å·²ç»ç»è¿‡Auth Basic ModuleéªŒè¯çš„ç”¨æˆ·åã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$request_filename</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># å½“å‰è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸URIè¯·æ±‚ç”Ÿæˆã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$scheme</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># HTTPæ–¹æ³•ï¼ˆå¦‚httpï¼Œhttpsï¼‰ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$server_protocol</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯HTTP/1.0æˆ–HTTP/1.1ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$server_addr</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># æœåŠ¡å™¨åœ°å€ï¼Œåœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$server_name</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># æœåŠ¡å™¨åç§°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$server_port</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$request_uri</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># åŒ…å«è¯·æ±‚å‚æ•°çš„åŸå§‹URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œå¦‚ï¼šâ€/foo/bar.php?arg=bazâ€ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$uri</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># ä¸å¸¦è¯·æ±‚å‚æ•°çš„å½“å‰URIï¼Œ$uriä¸åŒ…å«ä¸»æœºåï¼Œå¦‚â€/foo/bar.htmlâ€ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$document_uri</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># ä¸$uriç›¸åŒã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é…ç½®è¯­æ³•">é…ç½®è¯­æ³•<a href="#é…ç½®è¯­æ³•" class="hash-link" aria-label="Direct link to é…ç½®è¯­æ³•" title="Direct link to é…ç½®è¯­æ³•">â€‹</a></h2><ul><li>Syntax# rewrite regex replacement <!-- -->[flag]<!-- -->;</li><li>Defaultï¼šâ€”â€”</li><li>Contextï¼šserverã€locationã€if</li></ul><p>regexï¼š</p><ul><li><p><code>~ </code>ä¸ºåŒºåˆ†å¤§å°å†™åŒ¹é…</p></li><li><p><code>~* </code>ä¸ºä¸åŒºåˆ†å¤§å°å†™åŒ¹é…</p></li><li><p><code>!~</code>å’Œ<code>!~*</code>åˆ†åˆ«ä¸ºåŒºåˆ†å¤§å°å†™ä¸åŒ¹é…åŠä¸åŒºåˆ†å¤§å°å†™ä¸åŒ¹é…</p></li></ul><p>Locationä¼˜å…ˆçº§ï¼š</p><p>ocation åŒ¹é…æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§</p><ol><li><code>location = /path/a/exact.png {}</code>: ç²¾ç¡®åŒ¹é…</li><li><code>location ^~ /path/a/ {}</code>: ä¼˜å…ˆå‰ç¼€åŒ¹é…ï¼ˆç¬¦åˆæœ€é•¿åŒ¹é…åŸåˆ™ï¼‰</li><li><code>location ~ /Path?/ {}</code> ï¼š åŒºåˆ†å¤§å°å†™æ­£åˆ™åŒ¹é…ï¼ˆé¦–æ¬¡åŒ¹é…åŸåˆ™ï¼‰</li><li><code>location ~* /path?/ {}</code>: ä¸åŒºåˆ†å¤§å°å†™æ­£åˆ™åŒ¹é…ï¼ˆé¦–æ¬¡åŒ¹é…åŸåˆ™ï¼‰</li><li><code>location /path/a/test.png {}</code> : å‰ç¼€åŒ¹é…ï¼ˆç¬¦åˆæœ€é•¿åŒ¹é…åŸåˆ™ï¼‰</li></ol><p>location ä¼˜å…ˆçº§åŒ¹é…ä¸é…ç½®çš„å…ˆåé¡ºåºæ— å…³ï¼Œä¼˜å…ˆçº§æ’åˆ—é¡ºåºå¦‚ä¸‹</p><p>ç²¾ç¡®åŒ¹é… &gt; ä¼˜å…ˆå‰ç¼€åŒ¹é… &gt; åŒºåˆ†å¤§å°å†™æ­£åˆ™åŒ¹é…=ä¸åŒºåˆ†å¤§å°å†™æ­£åˆ™åŒ¹é… &gt; å‰ç¼€åŒ¹é…</p><p>æ–‡ä»¶åŠç›®å½•åŒ¹é…ï¼š</p><ul><li><p><code>-f</code>å’Œ<code>!-f</code>ç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶</p></li><li><p><code>-d</code>å’Œ<code>!-d</code>ç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›®å½•</p></li><li><p><code>-e</code>å’Œ<code>!-e</code>ç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶æˆ–ç›®å½•</p></li><li><p><code>-x</code>å’Œ<code>!-x</code>ç”¨æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œ</p></li></ul><p>Flagå‚æ•°ï¼š</p><table><thead><tr><th>æ ‡è®°ç¬¦å·</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>last</td><td>ç»ˆæ­¢åœ¨æœ¬locationå—ä¸­å¤„ç†æ¥æ”¶åˆ°çš„URIï¼Œå¹¶å°†æ­¤å¤„é‡å†™çš„URIä½œä¸ºæ–°çš„URIä½¿ç”¨å…¶ä»–locationè¿›è¡Œå¤„ç†ã€‚ï¼ˆåªæ˜¯ç»ˆæ­¢å½“å‰locationçš„å¤„ç†ï¼‰<strong>ã€å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œä¼šç»§ç»­å‘ä¸‹åŒ¹é…ã€‘</strong></td></tr><tr><td>break</td><td>å°†æ­¤å¤„é‡å†™çš„URIä½œä¸ºä¸€ä¸ªæ–°çš„URIåœ¨å½“å‰locationä¸­ç»§ç»­æ‰§è¡Œï¼Œå¹¶ä¸ä¼šå°†æ–°çš„URIè½¬å‘å…¶ä»–locationã€‚ã€<strong>å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œåˆ™ä¸å†å‘ä¸‹åŒ¹é…ï¼Œç›´æ¥è¿”å›ç»“æœ404ã€‘</strong></td></tr><tr><td>redirect</td><td>å°†é‡å†™åçš„URIè¿”å›ä¸ªå®¢æˆ·ç«¯ï¼ŒçŠ¶æ€ç æ˜¯302ï¼Œè¡¨æ˜ä¸´æ—¶é‡å®šå‘ï¼Œä¸»è¦ç”¨åœ¨replacementå­—ç¬¦ä¸²ä¸ä»¥â€œhttp://â€ï¼Œâ€œ https://â€æˆ–â€œ $schemeâ€ å¼€å¤´ï¼›<strong>ã€åœ°å€æ ä¼šæ˜¾ç¤ºè·³è½¬åçš„åœ°å€ã€‘</strong></td></tr><tr><td>permanent</td><td>å°†é‡å†™çš„URIè¿”å›å®¢æˆ·ç«¯ï¼ŒçŠ¶æ€ç ä¸º301,æŒ‡æ˜æ˜¯æ°¸ä¹…é‡å®šå‘ï¼›<strong>ã€åœ°å€æ ä¼šæ˜¾ç¤ºè·³è½¬åçš„åœ°å€ã€‘</strong></td></tr></tbody></table><blockquote><p><code>break</code>ä¸<code>last</code>åŒºåˆ«ä¸¾ä¾‹ï¼š</p><p>break åªè¦åŒ¹é…åˆ°è§„åˆ™ï¼Œåˆ™ä¼šå»æœ¬åœ°é…ç½®è·¯å¾„çš„ç›®å½•ä¸­å¯»æ‰¾è¯·æ±‚çš„æ–‡ä»¶ï¼›
è€Œlaståªè¦åŒ¹é…åˆ°è§„åˆ™ï¼Œä¼šå¯¹å…¶æ‰€åœ¨çš„server(...)æ ‡ç­¾é‡æ–°å‘èµ·è¯·æ±‚ã€‚</p><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        root /code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location ~ ^/break {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rewrite ^/break /test/ break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location ~ ^/last {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rewrite ^/last /test/ last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location /test/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                default_type application/json;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return 200 &quot;ok&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>breakè¯·æ±‚ï¼š</strong> </p><p>1ã€é¦–å…ˆï¼šä¼šå»æŸ¥æ‰¾æœ¬åœ°çš„/code/test/index.html;</p><p>2ã€å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™è¿”å›/code/test/index.htmlçš„å†…å®¹ï¼› </p><p>3ã€å¦‚æœæ²¡æ‰¾åˆ°è¯¥ç›®å½•åˆ™æŠ¥é”™404ï¼Œå¦‚æœæ‰¾åˆ°è¯¥ç›®å½•æ²¡æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶åˆ™403</p><p> <strong>lastè¯·æ±‚:</strong> </p><p>1ã€é¦–å…ˆï¼šä¼šå»æŸ¥æ‰¾æœ¬åœ°çš„/code/test/index.html; </p><p>2ã€å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™è¿”å›/code/test/index.htmlçš„å†…å®¹ï¼›</p><p>3ã€å¦‚æœæ²¡æ‰¾åˆ°ï¼Œä¼šå¯¹å½“å‰serveré‡æ–°çš„å‘èµ·ä¸€æ¬¡è¯·æ±‚ã€‚example.com/test/ </p><p>4ã€å¦‚æœæœ‰locationåŒ¹é…ä¸Šï¼Œåˆ™ç›´æ¥è¿”å›è¯¥locationçš„å†…å®¹ã€‚ </p><p>5ã€å¦‚æœä¹Ÿæ²¡æœ‰locationåŒ¹é…ï¼Œå†è¿”å›404;</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹é›†åˆ">ç¤ºä¾‹é›†åˆ<a href="#ç¤ºä¾‹é›†åˆ" class="hash-link" aria-label="Direct link to ç¤ºä¾‹é›†åˆ" title="Direct link to ç¤ºä¾‹é›†åˆ">â€‹</a></h2><p>åœ¨è°ƒè¯•ç¯å¢ƒä¸‹ï¼Œå¼€å¯rewriteæ—¥å¿—å¯¹è§„åˆ™çš„åŒ¹é…ä»¥ä¾¿è§‚å¯Ÿï¼š</p><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/nginx/error.log notice;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite_log on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹ä¸€å¸¸ç”¨301302è·³è½¬">ç¤ºä¾‹ä¸€ï¼ˆå¸¸ç”¨301ã€302è·³è½¬ï¼‰ï¼š<a href="#ç¤ºä¾‹ä¸€å¸¸ç”¨301302è·³è½¬" class="hash-link" aria-label="Direct link to ç¤ºä¾‹ä¸€ï¼ˆå¸¸ç”¨301ã€302è·³è½¬ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹ä¸€ï¼ˆå¸¸ç”¨301ã€302è·³è½¬ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ä¿®æ”¹é…ç½®æ–‡ä»¶vhost1.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            server_name   vhost1.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 301 æ°¸ä¹…è·³è½¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rewrite   ^/(.*)     http://www.vhost1.com/$1 permanent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen       80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name  www.vhost1.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        root   /usr/share/nginx/html/vhost1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        index  index.html index.htm;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /aaa {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # 302 ä¸´æ—¶è·³è½¬ï¼Œç”¨æˆ·è®¿é—®/aaa/ç›®å½•å…¶å®æ˜¯è®¿é—®æœåŠ¡å™¨çš„bbbç›®å½•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # rewrite ^/aaa/(.*)$ /bbb/$1 redirect;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /ccc {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # ç”¨æˆ·è®¿é—®vhost1.com/cccå…¶å®æ˜¯è®¿é—®agou-ops.topç½‘ç«™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite (.*) https://agou-ops.top redirect;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ç”¨æˆ·è®¿é—®couese-11-22-33.htmlå®é™…ä¸ŠçœŸå®è®¿é—®çš„æ˜¯/course/11/22/33/course_33.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location /course {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # çµæ´»é…æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        alias /course;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite ^/course-(.*)-(.*)-(.*).html$ /$1/$2/$3/course_$3.html redirect;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # å›ºå®šé…æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # rewrite ^/course-(.*) /11/22/33/course_33.html redirect;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       error_page 404 /404.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location = /40x.html {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error_page 500 502 503 504 /50x.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location = /50x.html {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹äºŒåŸŸåæ–°æ—§è·³è½¬">ç¤ºä¾‹äºŒï¼ˆåŸŸåæ–°æ—§è·³è½¬ï¼‰ï¼š<a href="#ç¤ºä¾‹äºŒåŸŸåæ–°æ—§è·³è½¬" class="hash-link" aria-label="Direct link to ç¤ºä¾‹äºŒï¼ˆåŸŸåæ–°æ—§è·³è½¬ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹äºŒï¼ˆåŸŸåæ–°æ—§è·³è½¬ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     server_name www.old.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     rewrite &quot;^/(.*)$&quot; http://www.new.com/$1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹ä¸‰è·³è½¬ç«™å¤–ç½‘é¡µ">ç¤ºä¾‹ä¸‰ï¼ˆè·³è½¬ç«™å¤–ç½‘é¡µï¼‰ï¼š<a href="#ç¤ºä¾‹ä¸‰è·³è½¬ç«™å¤–ç½‘é¡µ" class="hash-link" aria-label="Direct link to ç¤ºä¾‹ä¸‰ï¼ˆè·³è½¬ç«™å¤–ç½‘é¡µï¼‰ï¼š" title="Direct link to ç¤ºä¾‹ä¸‰ï¼ˆè·³è½¬ç«™å¤–ç½‘é¡µï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen       80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name  vhost2.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           root   /usr/share/nginx/html/vhost2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            index  index.html index.htm;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error_page 404 /404.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location = /40x.html {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error_page 500 502 503 504 /50x.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            location = /50x.html {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ( $http_host ~* &quot;^(.*)&quot;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        set $domain $1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite ^(.*) http://www.baidu.com break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹å››è‡ªåŠ¨å°†httpè·³è½¬åˆ°https">ç¤ºä¾‹å››ï¼ˆè‡ªåŠ¨å°†httpè·³è½¬åˆ°httpsï¼‰ï¼š<a href="#ç¤ºä¾‹å››è‡ªåŠ¨å°†httpè·³è½¬åˆ°https" class="hash-link" aria-label="Direct link to ç¤ºä¾‹å››ï¼ˆè‡ªåŠ¨å°†httpè·³è½¬åˆ°httpsï¼‰ï¼š" title="Direct link to ç¤ºä¾‹å››ï¼ˆè‡ªåŠ¨å°†httpè·³è½¬åˆ°httpsï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># æ–¹æ³•ä¸€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name www.vhost.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite ^(.*) https://$server_name$1 redirect;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # æˆ–è€…</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 302 https://$server_name$request_uri;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen 443;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_namewww.vhost.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssl on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># æ–¹æ³•äºŒ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           root /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           if ( $scheme = http ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               rewrite  ^/(.*)  https://www.xxx.com/$1 ;    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # æŒ‡å®šç½‘é¡µè·³è½¬https</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   location /login {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       root /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       if ( $scheme = http ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           rewrite / https://www.xxx.com/login permanent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       auth_basic &quot;input password&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       auth_basic_user_file /apps/nginx/conf/.htpasswd;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹äº”åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨">ç¤ºä¾‹äº”ï¼ˆåˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼‰ï¼š<a href="#ç¤ºä¾‹äº”åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨" class="hash-link" aria-label="Direct link to ç¤ºä¾‹äº”ï¼ˆåˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹äº”ï¼ˆåˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       root  /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       if ( !-f $request_filename ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           rewrite (.*) http://www.xxx.com/index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # èµ„æºä¸å­˜åœ¨åˆ™è·³å¾€é¦–é¡µ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹å…­æ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•">ç¤ºä¾‹å…­ï¼ˆæ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•ï¼‰ï¼š<a href="#ç¤ºä¾‹å…­æ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•" class="hash-link" aria-label="Direct link to ç¤ºä¾‹å…­ï¼ˆæ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹å…­ï¼ˆæ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># å¦‚æœç”¨æˆ·ä½¿ç”¨çš„æ˜¯IEæµè§ˆå™¨åˆ™è·³è½¬è‡³nginx-ieç›®å½•ä¸­å»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($http_user_agent ~ MSIE) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite ^(.*)$  /nginx-ie/$1 break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹ä¸ƒèµ„æºé˜²ç›—é“¾">ç¤ºä¾‹ä¸ƒï¼ˆèµ„æºé˜²ç›—é“¾ï¼‰ï¼š<a href="#ç¤ºä¾‹ä¸ƒèµ„æºé˜²ç›—é“¾" class="hash-link" aria-label="Direct link to ç¤ºä¾‹ä¸ƒï¼ˆèµ„æºé˜²ç›—é“¾ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹ä¸ƒï¼ˆèµ„æºé˜²ç›—é“¾ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location /images {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       root /data/nginx/pc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_referers none blocked server_names *.example.com example.* www.example.org/galleries/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               ~\.google\.;          #å½“è®¿é—®/imagesä¸‹çš„èµ„æºæ—¶ï¼Œåªæœ‰æŒ‡å®šçš„è¿™äº›æ‰å¯ä»¥è®¿é—®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       if ( $invalid_referer ) {     #å¦‚æœè®¿é—®èµ„æºçš„ç½‘ç«™ä¸æ˜¯ä»ä¸Šé¢æŒ‡å®šçš„æœç´¢å¼•æ“è·³è½¬è¿‡æ¥çš„ï¼Œåˆ™æ‹’ç»è®¿é—®ï¼Œå¹¶ä¸”è¿”å›çŠ¶æ€ç 403</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           return 403;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           rewrite ^/ http://xxx.com/daolian.png;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">location ~* .(gif|jpg|png|swf|flv)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">valid_referers none blocked server_names *.example.com example.* www.example.org/galleries/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               ~\.google\.;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($invalid_referer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return 403;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹å…«å¤šç›®å½•è½¬æˆå‚æ•°">ç¤ºä¾‹å…«ï¼ˆå¤šç›®å½•è½¬æˆå‚æ•°ï¼‰ï¼š<a href="#ç¤ºä¾‹å…«å¤šç›®å½•è½¬æˆå‚æ•°" class="hash-link" aria-label="Direct link to ç¤ºä¾‹å…«ï¼ˆå¤šç›®å½•è½¬æˆå‚æ•°ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹å…«ï¼ˆå¤šç›®å½•è½¬æˆå‚æ•°ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># éœ€æ±‚å¦‚ä¸‹æ‰€ç¤º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">abc.domian.com/sort/2 =&gt; abc.domian.com/index.php?act=sort&amp;name=abc&amp;id=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($host ~* (.*)\.domain\.com) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    set $sub_name $1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite ^/sort\/(\d+)\/?$ /index.php?act=sort&amp;name=$sub_name&amp;id=$1 last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹ä¹ç›®å½•å¯¹æ¢">ç¤ºä¾‹ä¹ï¼ˆç›®å½•å¯¹æ¢ï¼‰ï¼š<a href="#ç¤ºä¾‹ä¹ç›®å½•å¯¹æ¢" class="hash-link" aria-label="Direct link to ç¤ºä¾‹ä¹ï¼ˆç›®å½•å¯¹æ¢ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹ä¹ï¼ˆç›®å½•å¯¹æ¢ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># éœ€æ±‚å¦‚ä¸‹æ‰€ç¤º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/123456/xxxx -&gt; /xxxx?id=123456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rewrite ^/(\d+)/(.+)/ /$2?id=$1 last;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹åè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢">ç¤ºä¾‹åï¼ˆè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢ï¼‰ï¼š<a href="#ç¤ºä¾‹åè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢" class="hash-link" aria-label="Direct link to ç¤ºä¾‹åï¼ˆè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹åï¼ˆè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location ^~ /baidu {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite ^.+ http://baidu.com/ last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹åä¸€åŸŸåé•œåƒ">ç¤ºä¾‹åä¸€ï¼ˆåŸŸåé•œåƒï¼‰ï¼š<a href="#ç¤ºä¾‹åä¸€åŸŸåé•œåƒ" class="hash-link" aria-label="Direct link to ç¤ºä¾‹åä¸€ï¼ˆåŸŸåé•œåƒï¼‰ï¼š" title="Direct link to ç¤ºä¾‹åä¸€ï¼ˆåŸŸåé•œåƒï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name mirror.test.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index index.html index.htm index.php;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root /opt/lampp/htdocs/www;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite ^/(.*) http://www.test.com/$1 last;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    access_log off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹åäºŒä¸‰çº§åŸŸåè·³è½¬">ç¤ºä¾‹åäºŒï¼ˆä¸‰çº§åŸŸåè·³è½¬ï¼‰ï¼š<a href="#ç¤ºä¾‹åäºŒä¸‰çº§åŸŸåè·³è½¬" class="hash-link" aria-label="Direct link to ç¤ºä¾‹åäºŒï¼ˆä¸‰çº§åŸŸåè·³è½¬ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹åäºŒï¼ˆä¸‰çº§åŸŸåè·³è½¬ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if ($http_host ~* â€œ^(.*)\.t\.test\.com$â€) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rewrite ^(.*) http://top.test.com$1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¤ºä¾‹åä¸‰ç»´æŠ¤ç«™ç‚¹">ç¤ºä¾‹åä¸‰ï¼ˆç»´æŠ¤ç«™ç‚¹ï¼‰ï¼š<a href="#ç¤ºä¾‹åä¸‰ç»´æŠ¤ç«™ç‚¹" class="hash-link" aria-label="Direct link to ç¤ºä¾‹åä¸‰ï¼ˆç»´æŠ¤ç«™ç‚¹ï¼‰ï¼š" title="Direct link to ç¤ºä¾‹åä¸‰ï¼ˆç»´æŠ¤ç«™ç‚¹ï¼‰ï¼š">â€‹</a></h3><div class="language-nginx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nginx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name localhost;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                root /data/code/weihutongzhi;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($request_uri !~ &quot;^/index.html$&quot;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite ^(.*) http:/urlxxx/index.html permanent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen          443;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name     localhost;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssl_certificate      xxx.pem;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ssl_certificate_key  xxx.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                root /data/code/weihutongzhi;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($request_uri !~ &quot;^/index.html$&quot;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rewrite ^(.*) https://urlxxx/index.html permanent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥<a href="#å‚è€ƒé“¾æ¥" class="hash-link" aria-label="Direct link to å‚è€ƒé“¾æ¥" title="Direct link to å‚è€ƒé“¾æ¥">â€‹</a></h2><ul><li>NGINXå†…ç½®å˜é‡ï¼š<a href="http://www.cnphp.info/nginx-embedded-variables-lasted-version.html" target="_blank" rel="noopener noreferrer">http://www.cnphp.info/nginx-embedded-variables-lasted-version.html</a></li><li>ngx_http_rewrite_moduleï¼š<a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewrite" target="_blank" rel="noopener noreferrer">http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewrite</a></li><li>ngx_http_referer_moduleï¼š<a href="http://nginx.org/en/docs/http/ngx_http_referer_module.html" target="_blank" rel="noopener noreferrer">http://nginx.org/en/docs/http/ngx_http_referer_module.html</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/AGou-ops/myDocsv4/edit/main/docs/LinuxBasics/Web-Servers/Nginx/Nginx Rewrite.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx Cache"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Nginx ç¼“å­˜</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/LinuxBasics/Web-Servers/Nginx/Nginx php-fpm"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">nginx php-fpm å¿«é€Ÿæ‰‹å†Œ</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#åº”ç”¨åœºæ™¯" class="table-of-contents__link toc-highlight">åº”ç”¨åœºæ™¯</a></li><li><a href="#è§„åˆ™ä¼˜å…ˆçº§" class="table-of-contents__link toc-highlight">è§„åˆ™ä¼˜å…ˆçº§</a></li><li><a href="#å…¨å±€å˜é‡" class="table-of-contents__link toc-highlight">å…¨å±€å˜é‡</a></li><li><a href="#é…ç½®è¯­æ³•" class="table-of-contents__link toc-highlight">é…ç½®è¯­æ³•</a></li><li><a href="#ç¤ºä¾‹é›†åˆ" class="table-of-contents__link toc-highlight">ç¤ºä¾‹é›†åˆ</a><ul><li><a href="#ç¤ºä¾‹ä¸€å¸¸ç”¨301302è·³è½¬" class="table-of-contents__link toc-highlight">ç¤ºä¾‹ä¸€ï¼ˆå¸¸ç”¨301ã€302è·³è½¬ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹äºŒåŸŸåæ–°æ—§è·³è½¬" class="table-of-contents__link toc-highlight">ç¤ºä¾‹äºŒï¼ˆåŸŸåæ–°æ—§è·³è½¬ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹ä¸‰è·³è½¬ç«™å¤–ç½‘é¡µ" class="table-of-contents__link toc-highlight">ç¤ºä¾‹ä¸‰ï¼ˆè·³è½¬ç«™å¤–ç½‘é¡µï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹å››è‡ªåŠ¨å°†httpè·³è½¬åˆ°https" class="table-of-contents__link toc-highlight">ç¤ºä¾‹å››ï¼ˆè‡ªåŠ¨å°†httpè·³è½¬åˆ°httpsï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹äº”åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨" class="table-of-contents__link toc-highlight">ç¤ºä¾‹äº”ï¼ˆåˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹å…­æ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•" class="table-of-contents__link toc-highlight">ç¤ºä¾‹å…­ï¼ˆæ ¹æ®ç”¨æˆ·æµè§ˆå™¨è·³è½¬æŒ‡å®šç›®å½•ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹ä¸ƒèµ„æºé˜²ç›—é“¾" class="table-of-contents__link toc-highlight">ç¤ºä¾‹ä¸ƒï¼ˆèµ„æºé˜²ç›—é“¾ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹å…«å¤šç›®å½•è½¬æˆå‚æ•°" class="table-of-contents__link toc-highlight">ç¤ºä¾‹å…«ï¼ˆå¤šç›®å½•è½¬æˆå‚æ•°ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹ä¹ç›®å½•å¯¹æ¢" class="table-of-contents__link toc-highlight">ç¤ºä¾‹ä¹ï¼ˆç›®å½•å¯¹æ¢ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹åè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢" class="table-of-contents__link toc-highlight">ç¤ºä¾‹åï¼ˆè®¾ç½®æŸä¸ªå­ç›®å½•è·³è½¬é¡µé¢ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹åä¸€åŸŸåé•œåƒ" class="table-of-contents__link toc-highlight">ç¤ºä¾‹åä¸€ï¼ˆåŸŸåé•œåƒï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹åäºŒä¸‰çº§åŸŸåè·³è½¬" class="table-of-contents__link toc-highlight">ç¤ºä¾‹åäºŒï¼ˆä¸‰çº§åŸŸåè·³è½¬ï¼‰ï¼š</a></li><li><a href="#ç¤ºä¾‹åä¸‰ç»´æŠ¤ç«™ç‚¹" class="table-of-contents__link toc-highlight">ç¤ºä¾‹åä¸‰ï¼ˆç»´æŠ¤ç«™ç‚¹ï¼‰ï¼š</a></li></ul></li><li><a href="#å‚è€ƒé“¾æ¥" class="table-of-contents__link toc-highlight">å‚è€ƒé“¾æ¥</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs Releases</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 1.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 2.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Version 3.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://agou-ops.cn/myDocsv4" target="_blank" rel="noopener noreferrer" class="footer__link-item">â­ï¸Version 4.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://agou-ops.cn" target="_blank" rel="noopener noreferrer" class="footer__link-item">â­ï¸æˆ‘çš„åšå®¢<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/AGou-ops" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 AGou-ops' Documetation v4.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d3f82a4d.js"></script>
<script src="/assets/js/main.7273c711.js"></script>
</body>
</html>