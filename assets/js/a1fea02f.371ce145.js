"use strict";(self.webpackChunkmy_docsv_4=self.webpackChunkmy_docsv_4||[]).push([[9440],{3905:(e,r,n)=>{n.d(r,{Zo:()=>c,kt:()=>k});var a=n(67294);function t(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function i(e,r){if(null==e)return{};var n,a,t=function(e,r){if(null==e)return{};var n,a,t={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],r.indexOf(n)>=0||(t[n]=e[n]);return t}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var o=a.createContext({}),p=function(e){var r=a.useContext(o),n=r;return e&&(n="function"==typeof e?e(r):l(l({},r),e)),n},c=function(e){var r=p(e.components);return a.createElement(o.Provider,{value:r},e.children)},m={inlineCode:"code",wrapper:function(e){var r=e.children;return a.createElement(a.Fragment,{},r)}},u=a.forwardRef((function(e,r){var n=e.components,t=e.mdxType,s=e.originalType,o=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(n),k=t,d=u["".concat(o,".").concat(k)]||u[k]||m[k]||s;return n?a.createElement(d,l(l({ref:r},c),{},{components:n})):a.createElement(d,l({ref:r},c))}));function k(e,r){var n=arguments,t=r&&r.mdxType;if("string"==typeof e||t){var s=n.length,l=new Array(s);l[0]=u;var i={};for(var o in r)hasOwnProperty.call(r,o)&&(i[o]=r[o]);i.originalType=e,i.mdxType="string"==typeof e?e:t,l[1]=i;for(var p=2;p<s;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6061:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>p});var a=n(87462),t=(n(67294),n(3905));const s={},l="SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b",i={unversionedId:"CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b",id:"CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b",title:"SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b",description:"\u8be5\u6587\u7ae0\u6765\u81ea\uff1ahttps://jiangxl.blog.csdn.net/article/details/121740024",source:"@site/docs/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b.md",sourceDirName:"CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b",slug:"/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b",permalink:"/docs/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b.md",tags:[],version:"current",frontMatter:{},sidebar:"cloudNative",previous:{title:"\uff08\u4e00\uff09\u901a\u8fc7\u7528\u6237\u8d26\u53f7\u7684\u65b9\u5f0f\u5206\u914d\u5355\u72ecNamespace\u7684\u6743\u9650",permalink:"/docs/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/RBAC \u5b9e\u6218\u6848\u4f8b"},next:{title:"\u5176\u4ed6\u5b9e\u6218\u6848\u4f8b",permalink:"/docs/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/\u5176\u4ed6\u5b9e\u6218\u6848\u4f8b"}},o={},p=[{value:"1.\u5fae\u670d\u52a1\u67b6\u6784\u53ca\u7406\u8bba\u6982\u8ff0",id:"1\u5fae\u670d\u52a1\u67b6\u6784\u53ca\u7406\u8bba\u6982\u8ff0",level:2},{value:"1.1.\u5355\u4f53\u67b6\u6784\u4e0e\u5fae\u670d\u52a1\u67b6\u6784\u7684\u533a\u522b",id:"11\u5355\u4f53\u67b6\u6784\u4e0e\u5fae\u670d\u52a1\u67b6\u6784\u7684\u533a\u522b",level:3},{value:"1.2.\u5fae\u670d\u52a1\u7ec4\u4ef6\u67b6\u6784\u56fe",id:"12\u5fae\u670d\u52a1\u7ec4\u4ef6\u67b6\u6784\u56fe",level:3},{value:"1.3.\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3",id:"13\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3",level:3},{value:"1.4.\u4e0d\u540c\u7684\u90e8\u7f72\u73af\u5883\u5bf9\u4e8e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u5982\u4f55\u7ba1\u7406",id:"14\u4e0d\u540c\u7684\u90e8\u7f72\u73af\u5883\u5bf9\u4e8e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u5982\u4f55\u7ba1\u7406",level:3},{value:"2.\u5fae\u670d\u52a1\u8fc1\u79fb\u81f3kubernetes\u5e73\u53f0\u6d41\u7a0b",id:"2\u5fae\u670d\u52a1\u8fc1\u79fb\u81f3kubernetes\u5e73\u53f0\u6d41\u7a0b",level:2},{value:"2.1.\u9879\u76ee\u8fc1\u79fb\u5230K8S\u5e73\u53f0\u6d41\u7a0b",id:"21\u9879\u76ee\u8fc1\u79fb\u5230k8s\u5e73\u53f0\u6d41\u7a0b",level:3},{value:"2.2.\u4f20\u7edf\u90e8\u7f72\u4e0eK8S\u90e8\u7f72\u7684\u533a\u522b",id:"22\u4f20\u7edf\u90e8\u7f72\u4e0ek8s\u90e8\u7f72\u7684\u533a\u522b",level:3},{value:"3.\u5fae\u670d\u52a1\u7a0b\u5e8f\u524d\u671f\u73af\u5883\u51c6\u5907\uff08\u914d\u7f6e\u3001\u7f16\u8bd1\u3001\u5236\u4f5c\u955c\u50cf\uff09",id:"3\u5fae\u670d\u52a1\u7a0b\u5e8f\u524d\u671f\u73af\u5883\u51c6\u5907\u914d\u7f6e\u7f16\u8bd1\u5236\u4f5c\u955c\u50cf",level:2},{value:"3.1.simple-microservice\u5fae\u670d\u52a1\u9879\u76ee\u4ecb\u7ecd",id:"31simple-microservice\u5fae\u670d\u52a1\u9879\u76ee\u4ecb\u7ecd",level:3},{value:"3.2.simple\u5fae\u670d\u52a1\u90e8\u7f72\u5230K8S\u903b\u8f91\u67b6\u6784",id:"32simple\u5fae\u670d\u52a1\u90e8\u7f72\u5230k8s\u903b\u8f91\u67b6\u6784",level:3},{value:"3.3.\u51c6\u5907\u5fae\u670d\u52a1\u5404\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6",id:"33\u51c6\u5907\u5fae\u670d\u52a1\u5404\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6",level:3},{value:"3.3.1.\u521b\u5efa\u5fae\u670d\u52a1\u5404\u4e2a\u7a0b\u5e8f\u7684prod\u914d\u7f6e\u6587\u4ef6",id:"331\u521b\u5efa\u5fae\u670d\u52a1\u5404\u4e2a\u7a0b\u5e8f\u7684prod\u914d\u7f6e\u6587\u4ef6",level:4},{value:"3.3.2.\u8c03\u6574\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684pom\u6587\u4ef6\u589e\u52a0prod\u73af\u5883",id:"332\u8c03\u6574\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684pom\u6587\u4ef6\u589e\u52a0prod\u73af\u5883",level:4},{value:"3.4.\u5236\u4f5c\u5fae\u670d\u52a1\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u7684\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf",id:"34\u5236\u4f5c\u5fae\u670d\u52a1\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u7684\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf",level:3},{value:"3.4.1.\u4e3a\u7a0b\u5e8f\u73af\u5883\u6784\u5efa\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf",id:"341\u4e3a\u7a0b\u5e8f\u73af\u5883\u6784\u5efa\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf",level:4},{value:"3.4.2.\u4e3a\u6bcf\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u7f16\u5199Dockerfile",id:"342\u4e3a\u6bcf\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u7f16\u5199dockerfile",level:4},{value:"3.5.\u8c03\u6574Protal\u5fae\u670d\u52a1\u4e2d\u8fde\u63a5Gateway\u7f51\u5173\u7684\u5730\u5740",id:"35\u8c03\u6574protal\u5fae\u670d\u52a1\u4e2d\u8fde\u63a5gateway\u7f51\u5173\u7684\u5730\u5740",level:3},{value:"3.6.\u90e8\u7f72Ingress\u7528\u4e8e\u5c06\u5fae\u670d\u52a1\u7a0b\u5e8f\u53d1\u5e03\u5230\u4e92\u8054\u7f51",id:"36\u90e8\u7f72ingress\u7528\u4e8e\u5c06\u5fae\u670d\u52a1\u7a0b\u5e8f\u53d1\u5e03\u5230\u4e92\u8054\u7f51",level:3},{value:"4.\u5728kubernetes\u96c6\u7fa4\u90e8\u7f72simple\u5fae\u670d\u52a1\u9879\u76ee",id:"4\u5728kubernetes\u96c6\u7fa4\u90e8\u7f72simple\u5fae\u670d\u52a1\u9879\u76ee",level:2},{value:"4.1.\u90e8\u7f72simple\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684mysql\u6570\u636e\u5e93\u73af\u5883",id:"41\u90e8\u7f72simple\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684mysql\u6570\u636e\u5e93\u73af\u5883",level:3},{value:"4.2.\u90e8\u7f72eureka\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3",id:"42\u90e8\u7f72eureka\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3",level:3},{value:"4.2.1.\u4fee\u6539Eureka\u914d\u7f6e\u6587\u4ef6\u589e\u52a0\u5404\u8282\u70b9\u5730\u5740",id:"421\u4fee\u6539eureka\u914d\u7f6e\u6587\u4ef6\u589e\u52a0\u5404\u8282\u70b9\u5730\u5740",level:4},{value:"4.2.2.\u8c03\u6574Eureka\u7684Dockerfile",id:"422\u8c03\u6574eureka\u7684dockerfile",level:4},{value:"4.2.3.\u6784\u5efaEureka\u670d\u52a1\u7684Docker\u955c\u50cf",id:"423\u6784\u5efaeureka\u670d\u52a1\u7684docker\u955c\u50cf",level:4},{value:"4.2.4.\u7f16\u5199Eureka\u90e8\u7f72YAML\u8d44\u6e90\u6587\u4ef6",id:"424\u7f16\u5199eureka\u90e8\u7f72yaml\u8d44\u6e90\u6587\u4ef6",level:4},{value:"4.2.5.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Eureka\u6ce8\u518c\u4e2d\u5fc3",id:"425\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72eureka\u6ce8\u518c\u4e2d\u5fc3",level:4},{value:"4.3.\u914d\u7f6e\u5404\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u8fde\u63a5Eureka\u96c6\u7fa4\u7684\u5730\u5740",id:"43\u914d\u7f6e\u5404\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u8fde\u63a5eureka\u96c6\u7fa4\u7684\u5730\u5740",level:3},{value:"4.4.\u5c06\u5404\u4e2a\u7a0b\u5e8f\u4ee3\u7801\u7f16\u8bd1\u6210\u53ef\u90e8\u7f72\u7684\u7a0b\u5e8f",id:"44\u5c06\u5404\u4e2a\u7a0b\u5e8f\u4ee3\u7801\u7f16\u8bd1\u6210\u53ef\u90e8\u7f72\u7684\u7a0b\u5e8f",level:3},{value:"4.3.\u4e2d\u90e8\u7f72Gateway\u7f51\u5173\u670d\u52a1",id:"43\u4e2d\u90e8\u7f72gateway\u7f51\u5173\u670d\u52a1",level:3},{value:"4.3.1.\u5c06Gateway\u7a0b\u5e8f\u6253\u5305\u6210docker\u955c\u50cf",id:"431\u5c06gateway\u7a0b\u5e8f\u6253\u5305\u6210docker\u955c\u50cf",level:4},{value:"4.3.2.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Gateway\u7f51\u5173\u670d\u52a1",id:"432\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72gateway\u7f51\u5173\u670d\u52a1",level:4},{value:"4.3.3.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Gateway\u7f51\u5173\u670d\u52a1",id:"433\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72gateway\u7f51\u5173\u670d\u52a1",level:4},{value:"4.4.\u7f16\u5199\u5feb\u901f\u90e8\u7f72\u5fae\u670d\u52a1\u5230K8S\u96c6\u7fa4\u7684\u811a\u672c",id:"44\u7f16\u5199\u5feb\u901f\u90e8\u7f72\u5fae\u670d\u52a1\u5230k8s\u96c6\u7fa4\u7684\u811a\u672c",level:3},{value:"4.5.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Order\u8ba2\u5355\u670d\u52a1",id:"45\u4f7f\u7528\u811a\u672c\u90e8\u7f72order\u8ba2\u5355\u670d\u52a1",level:3},{value:"4.5.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6",id:"451\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6",level:4},{value:"4.5.2\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Order\u8ba2\u5355\u670d\u52a1",id:"452\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72order\u8ba2\u5355\u670d\u52a1",level:4},{value:"4.6.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Product\u5546\u54c1\u670d\u52a1",id:"46\u4f7f\u7528\u811a\u672c\u90e8\u7f72product\u5546\u54c1\u670d\u52a1",level:3},{value:"4.6.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6",id:"461\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6",level:4},{value:"4.6.2.\u5728K8S\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fProduct\u5546\u54c1\u670d\u52a1",id:"462\u5728k8s\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fproduct\u5546\u54c1\u670d\u52a1",level:4},{value:"4.7.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Stock\u5e93\u5b58\u670d\u52a1",id:"47\u4f7f\u7528\u811a\u672c\u90e8\u7f72stock\u5e93\u5b58\u670d\u52a1",level:3},{value:"4.7.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6",id:"471\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6",level:4},{value:"4.7.2.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Stock\u5e93\u5b58\u670d\u52a1",id:"472\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72stock\u5e93\u5b58\u670d\u52a1",level:4},{value:"4.8.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Portal\u524d\u7aef\u9996\u9875",id:"48\u4f7f\u7528\u811a\u672c\u90e8\u7f72portal\u524d\u7aef\u9996\u9875",level:3},{value:"4.8.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6",id:"481\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6",level:4},{value:"4.8.2.\u5728K8S\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fPortal\u5b58\u670d\u52a1",id:"482\u5728k8s\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fportal\u5b58\u670d\u52a1",level:4},{value:"4.9.\u67e5\u770bEureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u5404\u4e2a\u5fae\u670d\u52a1\u7684\u4fe1\u606f",id:"49\u67e5\u770beureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u5404\u4e2a\u5fae\u670d\u52a1\u7684\u4fe1\u606f",level:3},{value:"4.10.\u4f7f\u7528simple\u5fae\u670d\u52a1\u7535\u5546\u5e73\u53f0",id:"410\u4f7f\u7528simple\u5fae\u670d\u52a1\u7535\u5546\u5e73\u53f0",level:3},{value:"5.\u57fa\u4e8eK8S\u96c6\u7fa4\u7684\u5fae\u670d\u52a1\u7684\u6269\u5bb9\u4e0e\u5347\u7ea7",id:"5\u57fa\u4e8ek8s\u96c6\u7fa4\u7684\u5fae\u670d\u52a1\u7684\u6269\u5bb9\u4e0e\u5347\u7ea7",level:2},{value:"5.1.\u5fae\u670d\u52a1\u7684\u6269\u5bb9",id:"51\u5fae\u670d\u52a1\u7684\u6269\u5bb9",level:3},{value:"5.2.\u5fae\u670d\u52a1\u7684\u5347\u7ea7",id:"52\u5fae\u670d\u52a1\u7684\u5347\u7ea7",level:3},{value:"5.2.1.\u5fae\u8c03Portal\u524d\u7aef\u9996\u9875\u7684\u4ee3\u7801",id:"521\u5fae\u8c03portal\u524d\u7aef\u9996\u9875\u7684\u4ee3\u7801",level:4},{value:"5.2.2.\u7f16\u8bd1\u6700\u65b0\u4ee3\u7801",id:"522\u7f16\u8bd1\u6700\u65b0\u4ee3\u7801",level:4},{value:"5.2.3.\u901a\u8fc7\u811a\u672c\u5c06Protal\u6700\u65b0\u4ee3\u7801\u6253\u5305\u6210\u955c\u50cf",id:"523\u901a\u8fc7\u811a\u672c\u5c06protal\u6700\u65b0\u4ee3\u7801\u6253\u5305\u6210\u955c\u50cf",level:4},{value:"5.2.4.\u5347\u7ea7K8S\u96c6\u7fa4\u4e2d\u7684Protal\u5fae\u670d\u52a1",id:"524\u5347\u7ea7k8s\u96c6\u7fa4\u4e2d\u7684protal\u5fae\u670d\u52a1",level:4}],c={toc:p};function m(e){let{components:r,...n}=e;return(0,t.kt)("wrapper",(0,a.Z)({},c,n,{components:r,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"springcloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b"},"SpringCloud\u5fae\u670d\u52a1\u7535\u5546\u7cfb\u7edf\u5728Kubernetes\u96c6\u7fa4\u4e2d\u4e0a\u7ebf\u8be6\u7ec6\u6559\u7a0b"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"\u8be5\u6587\u7ae0\u6765\u81ea\uff1a",(0,t.kt)("a",{parentName:"p",href:"https://jiangxl.blog.csdn.net/article/details/121740024"},"https://jiangxl.blog.csdn.net/article/details/121740024")),(0,t.kt)("p",{parentName:"blockquote"},"\u4ec5\u505a\u4e2a\u4eba\u5907\u4efd\u5b66\u4e60\u4f7f\u7528\u3002")),(0,t.kt)("h2",{id:"1\u5fae\u670d\u52a1\u67b6\u6784\u53ca\u7406\u8bba\u6982\u8ff0"},"1.",(0,t.kt)("a",{parentName:"h2",href:"https://so.csdn.net/so/search?q=%E5%BE%AE%E6%9C%8D%E5%8A%A1&spm=1001.2101.3001.7020"},"\u5fae\u670d\u52a1"),"\u67b6\u6784\u53ca\u7406\u8bba\u6982\u8ff0"),(0,t.kt)("p",null," \u7a0b\u5e8f",(0,t.kt)("a",{parentName:"p",href:"https://so.csdn.net/so/search?q=%E6%9E%B6%E6%9E%84&spm=1001.2101.3001.7020"},"\u67b6\u6784"),"\u4e00\u5171\u7ecf\u5386\u4e863\u4e2a\u9636\u6bb5\uff1a\u5355\u4f53\u67b6\u6784\u3001SOA\u67b6\u6784\u3001\u5fae\u670d\u52a1\u67b6\u6784\u3002"),(0,t.kt)("p",null," \u5fae\u670d\u52a1\u7cfb\u7edf\u5e94\u7528\u7531\u539f\u6765\u7684\u5355\u4f53\u53d8\u6210\u51e0\u5341\u5230\u51e0\u767e\u4e2a\u4e0d\u540c\u7684\u5de5\u7a0b\uff0c\u4f1a\u4ea7\u751f\u4f8b\u5982\u5305\u62ec\u670d\u52a1\u95f4\u7684\u4f9d\u8d56\uff0c\u670d\u52a1\u5982\u4f55\u62c6\u5c01\uff0c\u5185\u90e8\u63a5\u53e3\u89c4\u8303\uff0c\u6570\u636e\u4f20\u9012\u7b49\u7b49\u95ee\u9898\uff0c\u5c24\u5176\u662f\u670d\u52a1\u62c6\u5206\uff0c\u9700\u8981\u56e2\u961f\u719f\u6089\u4e1a\u52a1\u6d41\u7a0b\uff0c\u61c2\u5f97\u53d6\u820d\uff0c\u8981\u4fdd\u8bc1\u62c6\u5206\u7684\u7c92\u5ea6\u670d\u52a1\u65e2\u7b26\u5408\u201c\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\u201d\u7684\u57fa\u672c\u539f\u5219\uff0c\u8fd8\u8981\u517c\u987e\u4e1a\u52a1\u7684\u53d1\u5c55\u4ee5\u53ca\u516c\u53f8\u7684\u613f\u666f\uff0c\u8981\u8fd8\u8981\u8bf4\u670d\u56e2\u961f\u6210\u5458\u4e3a\u4e4b\u52aa\u529b\uff0c\u5e76\u4e14\u79ef\u6781\u6295\u5165\uff0c\u5728\u591a\u65b9\u4e2d\u95f4\u53d6\u5f97\u5e73\u8861\u3002"),(0,t.kt)("p",null," \u5fae\u670d\u52a1\u4ece\u6982\u5ff5\u4e0a\u8bb2\u5c31\u662f\u5c06\u4e00\u4e2a\u5927\u7684\u5e73\u53f0\u62c6\u5206\u6210\u51e0\u4e2a\u72ec\u7acb\u7684\u5c0f\u6a21\u5757\uff0c\u8fd9\u4e9b\u6a21\u5757\u6709\u81ea\u5df1\u4e13\u95e8\u7684\u6570\u636e\u5e93\u670d\u52a1\uff0c\u5373\u4f7f\u8fd9\u4e2a\u5355\u72ec\u6a21\u5757\u51fa\u73b0\u4e86\u6545\u969c\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u6574\u4e2a\u5e73\u53f0\u7684\u4f7f\u7528\uff0c\u4f8b\u5982\u4e00\u4e2a\u5e73\u53f0\u4e2d\u6709\u8ba2\u5355\u6a21\u5757\u3001\u65b0\u95fb\u6a21\u5757\u3001\u54a8\u8be2\u6a21\u5757\uff0c\u5373\u4f7f\u65b0\u95fb\u6a21\u5757\u5b95\u673a\u4e86\uff0c\u8ba2\u5355\u6a21\u5757\u3001\u65b0\u95fb\u6a21\u5757\u4f9d\u7136\u5de5\u4f5c\u6b63\u5e38\uff0c\u4e5f\u4e0d\u4f1a\u9020\u6210\u6574\u4e2a\u7f51\u7ad9\u7684\u762b\u75ea\u3002"),(0,t.kt)("p",null," \u5bf9\u4e8e\u5fae\u670d\u52a1\u7248\u672c\u8fed\u4ee3\u800c\u8a00\uff0c\u53ea\u9700\u8981\u9488\u5bf9\u7279\u5b9a\u529f\u80fd\u6240\u5728\u7684\u5b50\u9879\u76ee\u4e0a\u7ebf\u5373\u53ef\uff0c\u7248\u672c\u8fed\u4ee3\u66f4\u52a0\u7075\u6d3b\uff0c\u800c\u5355\u4f53\u7a0b\u5e8f\u7248\u672c\u8fed\u4ee3\uff0c\u54ea\u6015\u53ea\u662f\u4e00\u4e2a\u5c0f\u5c0f\u7684\u529f\u80fd\u4e5f\u9700\u8981\u5bf9\u6574\u4e2a\u7cfb\u7edf\u8fdb\u884c\u66f4\u65b0\u3002"),(0,t.kt)("p",null," \u76ee\u524d\u4e3b\u6d41\u7684\u7a0b\u5e8f\u67b6\u6784\u5c31\u662f\u5fae\u670d\u52a1\u7cfb\u7edf\uff0c\u8fd0\u7528\u7684\u6280\u672f\u6808\u66f4\u52a0\u4e30\u5bcc\uff0c\u4f8b\u5982kubernetes\u3001CI/CD\u3001Devops\u7b49\u7b49\u3002"),(0,t.kt)("p",null," \u5fae\u670d\u52a1\u9879\u76ee\u5728kubernetes\u73af\u5883\u90e8\u7f72\u4e3b\u8981\u6709\u4e24\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff1a\u65e0\u72b6\u6001\u7684\u90e8\u7f72\u3001istio\u5fae\u670d\u52a1\u7f51\u683c\u90e8\u7f72\u3002"),(0,t.kt)("p",null," \u53ef\u4ee5\u628a\u5fae\u670d\u52a1\u7406\u89e3\u4e3a\u662f\u4e00\u4e2a\u5927\u7684\u6846\u67b6\uff0c\u5728\u8fd9\u4e2a\u6846\u67b6\u91cc\u9762\u5185\u5d4c\u5404\u4e2a\u5b50\u7cfb\u7edf\u3002"),(0,t.kt)("h3",{id:"11\u5355\u4f53\u67b6\u6784\u4e0e\u5fae\u670d\u52a1\u67b6\u6784\u7684\u533a\u522b"},"1.1.\u5355\u4f53\u67b6\u6784\u4e0e\u5fae\u670d\u52a1\u67b6\u6784\u7684\u533a\u522b"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u5fae\u670d\u52a1\u7684\u7279\u70b9\uff1a")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u7cfb\u7edf\u670d\u52a1\u72ec\u7acb\u5316",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u5b50\u9879\u76ee\u7cfb\u7edf\u90fd\u4f1a\u72ec\u7acb\u5f00\u53d1\u3001\u90e8\u7f72\uff0c\u6709\u6548\u7684\u907f\u514d\u4e00\u4e2a\u670d\u52a1\u7684bug\u5f71\u54cd\u6574\u4e2a\u7cfb\u7edf\u7684\u4f7f\u7528"))),(0,t.kt)("li",{parentName:"ul"},"\u6280\u672f\u6808\u7075\u6d3b",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u5b50\u7cfb\u7edf\u4e4b\u95f4\u7ea6\u5b9a\u4e00\u4e2a\u901a\u4fe1\u65b9\u5f0f\uff0c\u4f8b\u5982MQ\u3001API\u7b49\uff0c\u4e0d\u518d\u50cf\u5355\u4f53\u670d\u52a1\u90a3\u4e48\u7684\u5c40\u9650\u6027"))),(0,t.kt)("li",{parentName:"ul"},"\u72ec\u7acb\u90e8\u7f72",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u5fae\u670d\u52a1\u7cfb\u7edf\u90fd\u72ec\u7acb\u90e8\u7f72\uff0c\u90fd\u6709\u5355\u72ec\u7684war\u5305\uff0c\u5373\u4f7f\u5176\u4e2d\u4e00\u4e2a\u670d\u52a1\u5f02\u5e38\u5b95\u673a\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u6574\u4e2a\u5e73\u53f0\u4ea7\u751f\u5f71\u54cd"))),(0,t.kt)("li",{parentName:"ul"},"\u6269\u5c55\u6027\u5f3a",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u53ef\u4ee5\u90e8\u7f72\u591a\u5957\uff0c\u914d\u5408\u6ce8\u518c\u4e2d\u5fc3\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u80fd\u529b"))),(0,t.kt)("li",{parentName:"ul"},"\u72ec\u7acb\u6570\u636e",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u6709\u72ec\u7acb\u7684\u5b58\u50a8\u7ec4\u4ef6\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u3001\u7f13\u5b58\u7b49\uff0c\u4e92\u4e0d\u5f71\u54cd")))),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u5355\u4f53\u670d\u52a1\u7684\u7279\u70b9")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u6613\u4e8e\u90e8\u7f72",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u5355\u4f53\u670d\u52a1\u53ea\u6709\u4e00\u4e2a\u7a0b\u5e8f\u5305\uff0c\u53ea\u9700\u8981\u90e8\u7f72\u4e00\u4e2a\u670d\u52a1\u5373\u53ef\u5b8c\u6210\u6574\u4e2a\u7cfb\u7edf\u7684\u5efa\u8bbe"))),(0,t.kt)("li",{parentName:"ul"},"\u6613\u4e8e\u6d4b\u8bd5",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6d4b\u8bd5\u7528\u4f8b\u4e5f\u53ea\u9700\u8981\u8bbe\u8ba1\u4e00\u4e2a\u5373\u53ef")))),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u5355\u4f53\u670d\u52a1\u7684\u4e0d\u8db3")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u4ee3\u7801\u91cf\u7ea7\u5de8\u5927\uff0c\u96be\u4ee5\u7ef4\u62a4\uff0c\u5982\u679c\u7cfb\u7edf\u4e2d\u5b58\u5728bug\uff0c\u4fee\u590d\u8d77\u6765\u7275\u626f\u529f\u80fd\u592a\u591a\uff0c\u6545\u969c\u767e\u51fa"),(0,t.kt)("li",{parentName:"ul"},"\u6784\u5efa\u3001\u90e8\u7f72\u7684\u6210\u672c\u5de8\u5927\uff0c\u670d\u52a1\u90fd\u96c6\u6210\u5728\u4e00\u8d77\uff0c\u542f\u52a8\u7684\u65f6\u95f4\u4e5f\u4f1a\u975e\u5e38\u7f13\u6162"),(0,t.kt)("li",{parentName:"ul"},"\u65b0\u4eba\u4e0a\u624b\u8f83\u96be\uff0c\u5982\u679c\u6574\u4e2a\u670d\u52a1\u4e5f\u6ca1\u6709\u6ce8\u91ca\u7684\u60c5\u51b5\u4e0b\uff0c\u65b0\u7684\u5f00\u53d1\u4eba\u5458\u4e0a\u624b\u4f1a\u975e\u5e38\u96be")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u5fae\u670d\u52a1\u4e0e\u5355\u4f53\u670d\u52a1\u67b6\u6784\u4e0a\u7684\u4e0d\u540c")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"\u5355\u4f53\u670d\u52a1\uff1a\u7a0b\u5e8f\u5305\u53ea\u6709\u4e00\u4e2a\uff0c\u5f00\u53d1\u56e2\u961f\u53ef\u80fd\u6709\u4e00\u7fa4\u4eba\uff0c\u7528\u6237\u4e4b\u95f4\u8bbf\u95ee\u7a0b\u5e8f\u5305\u5373\u53ef\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f\uff0c\u540e\u7aef\u5bf9\u5e94\u4e00\u4e2a\u6570\u636e\u5e93"),(0,t.kt)("p",{parentName:"blockquote"},"\u5fae\u670d\u52a1\uff1a\u7a0b\u5e8f\u5305\u6709\u591a\u4e2a\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u5305\u90fd\u662f\u4e0d\u540c\u7684\u529f\u80fd\u7ed3\u5408\uff0c\u4e14\u6bcf\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u90fd\u6709\u81ea\u5df1\u7684\u5355\u72ec\u6570\u636e\u5e93\u5b58\u50a8\u6570\u636e\uff0c\u6240\u6709\u7684\u5fae\u670d\u52a1\u4fe1\u606f\u90fd\u4f1a\u5b58\u50a8\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u7f51\u5173\u7a0b\u5e8f\u5728\u6700\u524d\u9762\uff0c\u5f53\u7528\u6237\u6709\u8bf7\u6c42\u8fdb\u6765\u540e\uff0c\u9996\u5148\u53d1\u9001\u7ed9\u7f51\u5173\u670d\u52a1\uff0c\u7136\u540e\u7f51\u5173\u6839\u636e\u6ce8\u518c\u4e2d\u5fc3\u7684\u6570\u636e\uff0c\u5c06\u4e0d\u540c\u529f\u80fd\u7684\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/caf1d3f6f0f4405ea879f6408a54faf5.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h3",{id:"12\u5fae\u670d\u52a1\u7ec4\u4ef6\u67b6\u6784\u56fe"},"1.2.\u5fae\u670d\u52a1\u7ec4\u4ef6\u67b6\u6784\u56fe"),(0,t.kt)("p",null,"\u4ee5\u7535\u5546\u5e73\u53f0\u4e3a\u4f8b\uff0c\u63cf\u8ff0\u4e00\u4e2a\u8d2d\u4e70\u5546\u54c1\u7684\u5fae\u670d\u52a1\u4e4b\u95f4\u8c03\u7528\u6d41\u7a0b"),(0,t.kt)("p",null," \u7528\u6237\u9996\u5148\u8bbf\u95ee\u5230\u5e73\u53f0\u7684\u9759\u6001\u9996\u9875\uff0c\u53d1\u9001\u4e00\u4e2a\u641c\u7d22\u8bf7\u6c42\u4ece\u524d\u7aef\u9875\u9762\u63d0\u4ea4\u7ed9\u5fae\u670d\u52a1\u7684\u7f51\u5173\u670d\u52a1\uff0c\u7f51\u5173\u670d\u52a1\u662f\u5bf9\u5916\u7684\uff0c\u4e5f\u5c31\u662f\u4e0d\u7ba1\u7528\u6237\u8981\u64cd\u4f5c\u4ec0\u4e48\u8bf7\u6c42\uff0c\u90fd\u9700\u8981\u7531\u7f51\u5173\u670d\u52a1\u8f6c\u53d1\u7ed9\u5177\u4f53\u7684\u5fae\u670d\u52a1\uff0c\u56e0\u4e3a\u7f51\u5173\u670d\u52a1\u662f\u5165\u53e3\uff0c\u56e0\u6b64\u7f51\u5173\u670d\u52a1\u4e00\u822c\u90fd\u662f\u591a\u53f0\u505a\u6210\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u641c\u7d22\u8bf7\u6c42\u5230\u8fbe\u7f51\u5173\u670d\u52a1\u540e\uff0c\u7f51\u5173\u670d\u52a1\u4f1a\u6839\u636e\u8bf7\u6c42\u7684\u529f\u80fd\u8f6c\u53d1\u5230\u641c\u7d22\u670d\u52a1\u7684\u7a0b\u5e8f\u4e0a\uff0c\u641c\u7d22\u51fa\u6765\u5546\u54c1\u540e\uff0c\u4f1a\u8c03\u7528\u5546\u54c1\u670d\u52a1\u7a0b\u5e8f\uff0c\u67e5\u770b\u5546\u54c1\u7684\u8be6\u7ec6\u60c5\u51b5\uff0c\u7528\u6237\u9009\u62e9\u5b8c\u5546\u54c1\u540e\uff0c\u5546\u54c1\u670d\u52a1\u518d\u8c03\u7528\u8ba2\u5355\u670d\u52a1\uff0c\u5b8c\u6210\u8ba2\u5355\u7684\u521b\u5efa\uff0c\u518d\u7531\u8ba2\u5355\u670d\u52a1\u8c03\u7528\u652f\u4ed8\u670d\u52a1\uff0c\u5b8c\u6210\u5546\u54c1\u7684\u8d2d\u4e70\u3002"),(0,t.kt)("p",null," \u6240\u6709\u7684\u5fae\u670d\u52a1\u63a5\u53e3\u4fe1\u606f\u90fd\u4f1a\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u5f53\u7a0b\u5e8f\u542f\u52a8\u6210\u529f\u5c31\u4f1a\u81ea\u52a8\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\uff0c\u6ce8\u518c\u4e2d\u5fc3\u4e5f\u4f1a\u8d77\u5230\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\u7684\u4f5c\u7528\uff0c\u6839\u636e\u7f51\u5173\u7684API\u8bf7\u6c42\uff0c\u5728\u6ce8\u518c\u4e2d\u5fc3\u4e0a\u627e\u5230\u7279\u5b9a\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\u8fdb\u884c\u8f6c\u53d1\u3002"),(0,t.kt)("p",null," \u5fae\u670d\u52a1\u7a0b\u5e8f\u8fd8\u6709\u81ea\u5df1\u7684\u4e00\u5957\u914d\u7f6e\u4e2d\u5fc3\uff0c\u4fdd\u5b58\u7740\u5404\u4e2a\u5fae\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6240\u6709\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\u53ef\u80fd\u90fd\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u540e\u7aef\u7ec4\u4ef6\uff0c\u6bd4\u5982MySQL\u3001Redis\u3001MQ\u3001\u5206\u5e03\u5f0f\u5b58\u50a8\u3002"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\u53ef\u4ee5\u91c7\u7528\u63a5\u53e3API\u3001MQ\u3001RPAC\u7b49\u673a\u5236"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u5728kubernetes\u96c6\u7fa4\u4e2d\u90e8\u7f72\u65f6\u53ef\u4ee5\u91c7\u7528\u65e0\u72b6\u6001\u670d\u52a1\u7684\u90e8\u7f72\uff0c\u5bf9\u4e8e\u6570\u636e\u5e93\u3001Redis\u3001MQ\u3001\u5b58\u50a8\u8fd8\u662f\u5efa\u8bae\u90e8\u7f72\u5728k8s\u96c6\u7fa4\u4e4b\u5916\u3002"),(0,t.kt)("p",null,"\u6ce8\u518c\u4e2d\u5fc3\u4e0e\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8054\u7cfb\uff1a\u53d1\u73b0\u5fae\u670d\u52a1\u2014>\u5fae\u670d\u52a1\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\u2014>\u8fdb\u884c\u5fc3\u8df3\u76d1\u6d4b\uff0c\u5f02\u5e38\u7684\u8282\u70b9\u4f1a\u8e22\u51fa"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684\u95e8\u6237\u7f51\u7ad9\u4f1a\u914d\u7f6eGateway\u7f51\u5173\u670d\u52a1\u7684\u5730\u5740\uff0c\u7531\u95e8\u6237\u7f51\u7ad9\u7528\u6237\u8bf7\u6c42\u7684\u5fae\u670d\u52a1\u4fe1\u606f\uff0c\u8f6c\u53d1\u7ed9Gateway\u7f51\u5173\u7a0b\u5e8f\uff0c\u6240\u6709\u7684\u5fae\u670d\u52a1\u90fd\u4f1a\u6ce8\u518c\u5728Eureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\uff0cGateway\u7f51\u5173\u4f1a\u5c06\u8bf7\u6c42\u901a\u8fc7\u6ce8\u518c\u4e2d\u5fc3\u8f6c\u53d1\u7ed9\u5bf9\u5e94\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\u3002\n",(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/0225cafb98dd43d98ddd102cf1203791.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h3",{id:"13\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"},"1.3.\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u9762\u5bf9\u7740\u5f88\u591a\u95ee\u9898\uff1a"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u5982\u4f55\u8bb0\u5f55\u4e00\u4e2a\u5fae\u670d\u52a1\u526f\u672c\u7684\u63a5\u53e3\u5730\u5740\uff0c\u5982\u4f55\u5bf9\u591a\u4e2a\u5fae\u670d\u52a1\u8282\u70b9\u7ec4\u6210\u7684\u96c6\u7fa4\u505a\u8d1f\u8f7d\u5747\u8861"),(0,t.kt)("li",{parentName:"ul"},"\u7b26\u5408\u5224\u65ad\u96c6\u7fa4\u4e2d\u67d0\u4e00\u4e2a\u5fae\u670d\u52a1\u662f\u5426\u53ef\u7528")),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u9762\u4e34\u7684\u8fd9\u4e9b\u95ee\u9898\u90fd\u53ef\u4ee5\u901a\u8fc7\u6ce8\u518c\u4e2d\u5fc3\u53bb\u89e3\u51b3\uff0c\u5728\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u53ef\u7528\u8bb0\u5f55\u67d0\u4e00\u4e2a\u5fae\u670d\u52a1\u7684\u6240\u6709\u526f\u672c\u8282\u70b9\uff0c\u5f53\u4e00\u4e2a\u526f\u672c\u8282\u70b9\u6302\u6389\u4e86\uff0c\u6ce8\u518c\u4e2d\u5fc3\u4e5f\u4f1a\u5c06\u5176\u8e22\u51fa\u96c6\u7fa4\uff0c\u6ce8\u518c\u4e2d\u5fc3\u4f1a\u5c06\u4e00\u4e2a\u5fae\u670d\u52a1\u7684\u6240\u6709\u526f\u672c\u8282\u70b9\u81ea\u52a8\u5f62\u6210\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861"),(0,t.kt)("p",null,"\u5728\u5fae\u670d\u52a1\u4e2d\u914d\u5408\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\u4e4b\u540e\uff0c\u7a0b\u5e8f\u4e00\u65e6\u542f\u52a8\uff0c\u65e0\u9700\u914d\u7f6e\u6ce8\u518c\u4e2d\u5fc3\uff0c\u4e14\u80fd\u591f\u81ea\u52a8\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u63a5\u5165\u6ce8\u518c\u4e2d\u5fc3\u6d41\u7a0b\uff1a\u5fae\u670d\u52a1\u7a0b\u5e8f----\x3e\u6ce8\u518c----\x3e\u6ce8\u518c\u4e2d\u5fc3\u670d\u52a1\u5668"),(0,t.kt)("p",null,"\u6ce8\u518c\u4e2d\u5fc3\u8c03\u7528\u5fae\u670d\u52a1\u6d41\u7a0b\uff1a\u5fae\u670d\u52a1\u7f51\u5173\u7a0b\u5e8f----\x3e\u6ce8\u518c/\u67e5\u8be2\u5fae\u670d\u52a1\uff08\u8c03\u7528\u5fae\u670d\u52a1\uff09----\x3e\u6ce8\u518c\u4e2d\u5fc3----\x3e\u5fae\u670d\u52a1\u7a0b\u5e8f"),(0,t.kt)("p",null,"\u5f53\u7136\u4e5f\u53ef\u4ee5\u4e0d\u9002\u7528\u6ce8\u518c\u4e2d\u5fc3\uff0ck8s\u81ea\u8eab\u7684\u529f\u80fd\u5c31\u6709\u670d\u52a1\u53d1\u73b0\u81ea\u52a8\u5f62\u6210\u8d1f\u8f7d\u5747\u8861\uff0c\u4e5f\u53ef\u4ee5\u7528\u5065\u5eb7\u68c0\u67e5\u76d1\u63a7\u670d\u52a1\u7684\u8fd0\u884c\u72b6\u51b5"),(0,t.kt)("p",null,"\u76ee\u524d\u4e3b\u6d41\u7684\u6ce8\u518c\u4e2d\u5fc3\uff1aEureka\u3001Nacos"),(0,t.kt)("h3",{id:"14\u4e0d\u540c\u7684\u90e8\u7f72\u73af\u5883\u5bf9\u4e8e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u5982\u4f55\u7ba1\u7406"},"1.4.\u4e0d\u540c\u7684\u90e8\u7f72\u73af\u5883\u5bf9\u4e8e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u5982\u4f55\u7ba1\u7406"),(0,t.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u56db\u79cd\u65b9\u5f0f\u6765\u7ba1\u7406\u4e0d\u540c\u73af\u5883\u4f7f\u7528\u4e0d\u540c\u7684\u914d\u7f6e\u6587\u4ef6"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"kubernetes configmap\u8d44\u6e90",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u6839\u636e\u7ebf\u4e0a\u3001\u9884\u53d1\u5e03\u3001\u6d4b\u8bd5\u73af\u5883\u7f16\u5199\u4e0d\u540c\u7684configmap\u8d44\u6e90\uff0c\u7136\u540e\u5c06\u5176\u6302\u8f7d\u5230\u5bf9\u5e94\u7684deployment\u8d44\u6e90\u4e0a"))),(0,t.kt)("li",{parentName:"ul"},"docker \u5bb9\u5668\u542f\u52a8\u811a\u672centrypoint.sh",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u6839\u636e\u73af\u5883\u7684\u4e0d\u540c\u5728entrypoint.sh\u58f0\u660e\u73af\u5883\u53d8\u91cf\uff0c\u8fd0\u884c\u7279\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6"))),(0,t.kt)("li",{parentName:"ul"},"java\u542f\u52a8\u547d\u4ee4\u63a7\u5236",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"java\u7a0b\u5e8f\u53ef\u4ee5\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u58f0\u660e\u5404\u81ea\u7684\u53d8\u91cf\uff0c\u7136\u540e\u4f7f\u7528",(0,t.kt)("inlineCode",{parentName:"li"},"java --spring.profiles.active=xxx xxx.jar"),"\u7684\u65b9\u5f0f\u6765\u6307\u5b9a\u4e0d\u540c\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6"))),(0,t.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u5f00\u6e90\u7684\u7edf\u4e00\u914d\u7f6e\u4e2d\u5fc3\u7a0b\u5e8f\uff0c\u6bd4\u5982\u5e02\u9762\u4e0a\u4e3b\u6d41\u7684Apollo\u4ee5\u53caDisconf\uff0c\u8fd9\u4e24\u6b3e\u7a0b\u5e8f\u90fd\u6709\u81ea\u5df1\u7684\u56fe\u5f62\u5316\u7ba1\u7406\u7cfb\u7edf\uff0c\u914d\u7f6e\u53ef\u89c6\u5316")),(0,t.kt)("h2",{id:"2\u5fae\u670d\u52a1\u8fc1\u79fb\u81f3kubernetes\u5e73\u53f0\u6d41\u7a0b"},"2.\u5fae\u670d\u52a1\u8fc1\u79fb\u81f3kubernetes\u5e73\u53f0\u6d41\u7a0b"),(0,t.kt)("h3",{id:"21\u9879\u76ee\u8fc1\u79fb\u5230k8s\u5e73\u53f0\u6d41\u7a0b"},"2.1.\u9879\u76ee\u8fc1\u79fb\u5230K8S\u5e73\u53f0\u6d41\u7a0b"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/47633ea793f24a4b8727059870501e50.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"}),"\n\u9879\u76ee\u8fc1\u79fb\u5230K8S\u5e73\u53f0\u5927\u81f4\u6d41\u7a0b\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u9636\u6bb5\uff1a"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u5236\u4f5c\u7a0b\u5e8f\u955c\u50cf",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u5728K8s\u73af\u5883\uff0c\u6240\u6709\u7684\u7a0b\u5e8f\u90fd\u662f\u4ee5Docker\u955c\u50cf\u6765\u8fd0\u884c\u7684\uff0c\u4e00\u4e2a\u955c\u50cf\u5305\u542b\u4e86\u6587\u4ef6\u7cfb\u7edf\u3001\u7a0b\u5e8f\u7684\u8fd0\u884c\u73af\u5883\u3001\u7a0b\u5e8f\u672c\u8eab\uff0c\u53ef\u4ee5\u901a\u8fc7Dockerfile\u7684\u5f62\u5f0f\u5236\u4f5c\u955c\u50cf"))),(0,t.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u8d44\u6e90\u63a7\u5236\u5668\u7ba1\u7406Pod\u8d44\u6e90",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u955c\u50cf\u8fd0\u884c\u9700\u8981\u4f9d\u9760Pod\u8d44\u6e90\uff0c\u9700\u8981\u6709Pod\u63a7\u5236\u5668\u53bb\u7ba1\u7406Pod\u8d44\u6e90"),(0,t.kt)("li",{parentName:"ul"},"\u5e38\u89c1\u7684Pod\u63a7\u5236\u5668\uff1aDeployment\uff08\u65e0\u72b6\u6001\u7a0b\u5e8f\u90e8\u7f72\uff09\u3001Statefulset\uff08\u6709\u72b6\u6001\u7a0b\u5e8f\u90e8\u7f72\uff09\u3001Job/CronJob\uff08\u6279\u91cf\u5904\u7406\uff09"))),(0,t.kt)("li",{parentName:"ul"},"\u5c06Pod\u8d44\u6e90\u4f7f\u7528\u670d\u52a1\u53d1\u73b0\u5bf9\u5916\u8fdb\u884c\u66b4\u9732",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"Services\u8d44\u6e90\u6ce8\u610f\u901a\u8fc7label\u6807\u7b7e\u4e0ePod\u8fdb\u884c\u5173\u8054\uff0c\u5b9e\u73b0\u5bf9\u4e00\u7ec4Pod\u7684\u81ea\u52a8\u8d1f\u8f7d\u5747\u8861\u4ee5\u53ca\u670d\u52a1\u53d1\u73b0"),(0,t.kt)("li",{parentName:"ul"},"Services\u8d44\u6e90\u652f\u6301Cluster\u3001Nodeport\u3001LoadBalancer\u4e09\u79cd\u7c7b\u578b"))),(0,t.kt)("li",{parentName:"ul"},"\u5bf9\u5916\u53d1\u5e03\u5e94\u7528\u7a0b\u5e8f",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u4f7f\u7528\u5355\u72ec\u7684nginx\u5bb9\u5668\u53bb\u53cd\u5411\u4ee3\u7406Cordns\u89e3\u6790\u7684services\u540d\u79f0\u5c06Pod\u5e94\u7528\u5bf9\u5916\u53d1\u5e03"),(0,t.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u4f7f\u7528ingress+services\u7684\u65b9\u5f0f\u5c06\u5e94\u7528\u7a0b\u5e8f\u5bf9\u5916\u53d1\u5e03\uff0c\u4f7f\u7528ingress\u7684\u524d\u63d0\u662f\u5fc5\u987b\u53ef\u4ee5\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\u5e94\u7528"),(0,t.kt)("li",{parentName:"ul"},"\u67b6\u6784\u56fe\u5982\u4e0b\n",(0,t.kt)("img",{parentName:"li",src:"https://cdn.agou-ops.cn/others/4450dd7d3c994bb78ca36b43af66e28a.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})))),(0,t.kt)("li",{parentName:"ul"},"\u540e\u671f\u7684\u65e5\u5fd7\u6536\u96c6\u4e0e\u76d1\u63a7",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"\u5f53\u5e94\u7528\u5728K8s\u7a0b\u5e8f\u8fd0\u884c\u540e\uff0c\u5bf9\u4e8e\u7a0b\u5e8f\u7684\u65e5\u5fd7\u6bd4\u5982nginx\u3001tomcat\u8fd9\u4e9b\u65e5\u5fd7\u6587\u4ef6\u90fd\u4e0d\u4f1a\u505a\u6301\u4e45\u5316\uff0c\u56e0\u6b64\u5c31\u9700\u8981\u8003\u8651\u5bf9\u65e5\u5fd7\u8fdb\u884c\u6536\u96c6\uff0c\u53ef\u4ee5\u91c7\u7528Filebeat+ELK\u65b9\u5f0f\u5bf9\u7a0b\u5e8f\u65e5\u5fd7\u8fdb\u884c\u6536\u96c6"),(0,t.kt)("li",{parentName:"ul"},"\u4f7f\u7528Prometheus+Grafana\u5bf9\u6574\u4e2aK8s\u5e73\u53f0\u8fdb\u884c\u5168\u65b9\u9762\u76d1\u63a7")))),(0,t.kt)("h3",{id:"22\u4f20\u7edf\u90e8\u7f72\u4e0ek8s\u90e8\u7f72\u7684\u533a\u522b"},"2.2.\u4f20\u7edf\u90e8\u7f72\u4e0eK8S\u90e8\u7f72\u7684\u533a\u522b"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("strong",{parentName:"p"},"\u4f20\u7edf\u65b9\u5f0f\u90e8\u7f72\u9879\u76ee\u65b9\u5f0f\uff1a")),(0,t.kt)("p",{parentName:"blockquote"},"\u9996\u5148\u7531\u5f00\u53d1\u4eba\u5458\u63d0\u4ea4\u4ee3\u7801\u5230Gitlab\u4ee3\u7801\u4ed3\u5e93\uff0cJenkins\u89e6\u53d1\u66f4\u65b0\u4eceGitlab\u4e0a\u83b7\u53d6\u6700\u65b0\u4ee3\u7801\uff0c\u901a\u8fc7maven\u5c06\u4ee3\u7801\u7f16\u8bd1\u6210war\u5305\u6216\u8005jar\u5305\uff0c\u518d\u7531Jenkins\u901a\u8fc7\u5199\u597d\u7684\u81ea\u52a8\u5316\u90e8\u7f72\u811a\u672c\u6216\u8005Ansible\u81ea\u52a8\u5316\u7a0b\u5e8f\u5c06war\u5305\u90e8\u7f72\u5230\u7a0b\u5e8f\u6240\u5728\u7684\u4e91\u4e3b\u673a\uff0c\u4e91\u4e3b\u673a\u4e00\u5b9a\u4f1a\u662f\u591a\u53f0\u7ec4\u6210\u7684\u8d1f\u8f7d\u5747\u8861\u96c6\u7fa4\uff0c\u5c06\u8d1f\u8f7d\u5747\u8861VIP\u4e0e\u57df\u540d\u8fdb\u884c\u7ed1\u5b9a\uff0c\u7528\u6237\u901a\u8fc7\u8bbf\u95ee\u57df\u540d\u7531\u8d1f\u8f7d\u5747\u8861\u8f6c\u53d1\u81f3\u5bf9\u5e94\u7684\u540e\u53f0\u4e3b\u673a\u3002"),(0,t.kt)("p",{parentName:"blockquote"},"\u4f20\u7edf\u67b6\u6784\u8fd0\u7ef4\u73af\u5883\u4e00\u822c\u7531zabbix\u76d1\u63a7\u7cfb\u7edf\u8fdb\u884c\u76d1\u63a7\uff0c\u65e5\u5fd7\u91c7\u96c6\u4f1a\u4f7f\u7528ELK\u5e73\u53f0\u3002")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/e34c94fc97e0416cb21cd00879244103.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},(0,t.kt)("strong",{parentName:"p"},"Kubernetes\u5e73\u53f0\u90e8\u7f72\u9879\u76ee\u65b9\u5f0f\uff1a")),(0,t.kt)("p",{parentName:"blockquote"},"\u9996\u5148\u7531\u5f00\u53d1\u4eba\u5458\u63d0\u4ea4\u4ee3\u7801\u5230Gitlab\u4ee3\u7801\u4ed3\u5e93\uff0cJenkins\u89e6\u53d1\u66f4\u65b0\u4eceGitlab\u4e0a\u83b7\u53d6\u6700\u65b0\u4ee3\u7801\uff0c\u901a\u8fc7\u5199\u597d\u6d41\u6c34\u7ebf\u5c06\u7a0b\u5e8f\u6253\u5305\u6210Docker\u955c\u50cf\u5e76\u63a8\u9001\u81f3Harbor\u4ed3\u5e93\uff0c\u518d\u7531Jenkins\u8c03\u7528K8s\u7684Master Api\u5c06\u7a0b\u5e8f\u7684\u955c\u50cf\u91c7\u7528Deployment\u63a7\u5236\u5668\u90e8\u7f72\u5230K8s\u96c6\u7fa4\uff0c\u518d\u7531service\u8d44\u6e90\u66b4\u9732pod\u8d44\u6e90\uff0c\u6700\u540e\u7531ingress\u6216\u8005nginx\u8d44\u6e90\u5c06\u7a0b\u5e8f\u53d1\u5e03\u5230\u4e92\u8054\u7f51\u3002")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/3ca0d364bdc24690a04d4ca95eb1cb05.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h2",{id:"3\u5fae\u670d\u52a1\u7a0b\u5e8f\u524d\u671f\u73af\u5883\u51c6\u5907\u914d\u7f6e\u7f16\u8bd1\u5236\u4f5c\u955c\u50cf"},"3.\u5fae\u670d\u52a1\u7a0b\u5e8f\u524d\u671f\u73af\u5883\u51c6\u5907\uff08\u914d\u7f6e\u3001\u7f16\u8bd1\u3001\u5236\u4f5c\u955c\u50cf\uff09"),(0,t.kt)("h3",{id:"31simple-microservice\u5fae\u670d\u52a1\u9879\u76ee\u4ecb\u7ecd"},"3.1.simple-microservice\u5fae\u670d\u52a1\u9879\u76ee\u4ecb\u7ecd"),(0,t.kt)("p",null,"\u672c\u6b21\u4f7f\u7528\u7684\u5fae\u670d\u52a1\u4e3aspring cloud\u7684\u7535\u5546\u5e73\u53f0\u9879\u76ee"),(0,t.kt)("p",null,"\u9879\u76ee\u540d\u79f0\uff1asimple-microservice"),(0,t.kt)("p",null,"simple-microservice\u5fae\u670d\u52a1\u7684\u5404\u4e2a\u7a0b\u5e8f\uff1a"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"eureka-service\uff08\u6ce8\u518c\u4e2d\u5fc3\uff09"),(0,t.kt)("li",{parentName:"ul"},"gateway-service\uff08\u7f51\u7ba1\u670d\u52a1\uff09"),(0,t.kt)("li",{parentName:"ul"},"order-service\uff08\u8ba2\u5355\u670d\u52a1\uff09"),(0,t.kt)("li",{parentName:"ul"},"product-service\uff08\u5546\u54c1\u670d\u52a1\uff09"),(0,t.kt)("li",{parentName:"ul"},"portal-service\uff08\u95e8\u6237\u7f51\u7ad9\uff09"),(0,t.kt)("li",{parentName:"ul"},"stock-service\uff08\u5e93\u5b58\u670d\u52a1\uff09")),(0,t.kt)("p",null,"\u7528\u6237\u8bf7\u6c42\u9996\u5148\u5230Protal\u524d\u7aef\u9875\u9762\uff0c\u4e5f\u5c31\u662f\u7a0b\u5e8f\u7684\u9996\u9875\uff0c\u5728\u9996\u9875\u7684\u5404\u9879\u529f\u80fd\u64cd\u4f5c\u90fd\u4f1a\u7531Gateway\u7f51\u5173\u670d\u52a1\u8f6c\u53d1\u5230\u5404\u81ea\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\u4e0a\uff0c\u6bd4\u5982\u8bf7\u6c42\u4e00\u4e2a\u8ba2\u5355\u670d\u52a1\uff0c\u8ba2\u5355\u670d\u52a1\u4f1a\u4e8b\u5148\u6ce8\u518c\u5230Eureka\u4e2d\uff0c\u7531Gateway\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9Eureka\uff0c\u518d\u7531Eureka\u8f6c\u53d1\u7ed9\u5177\u4f53\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\uff0c\u8fd9\u4e9b\u5fae\u670d\u52a1\u7a0b\u5e8f\u90fd\u6709\u81ea\u5df1\u5355\u72ec\u7684\u6570\u636e\u5e93\u670d\u52a1\u3002"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684\u95e8\u6237\u7f51\u7ad9\u4f1a\u914d\u7f6eGateway\u7f51\u5173\u670d\u52a1\u7684\u5730\u5740\uff0c\u7531\u95e8\u6237\u7f51\u7ad9\u7528\u6237\u8bf7\u6c42\u7684\u5fae\u670d\u52a1\u4fe1\u606f\uff0c\u8f6c\u53d1\u7ed9Gateway\u7f51\u5173\u7a0b\u5e8f\uff0c\u6240\u6709\u7684\u5fae\u670d\u52a1\u90fd\u4f1a\u6ce8\u518c\u5728Eureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\uff0cGateway\u7f51\u5173\u4f1a\u5c06\u8bf7\u6c42\u901a\u8fc7\u6ce8\u518c\u4e2d\u5fc3\u8f6c\u53d1\u7ed9\u5bf9\u5e94\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\u3002\n",(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/b89c6c882bbe4a2d9ab53f97d5fe1f35.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,"\u8be5\u5fae\u670d\u52a1\u7a0b\u5e8f\u4ee3\u7801\u53ef\u4ee5\u6258\u7ba1\u5728gitlab\u4ee3\u7801\u4ed3\u5e93\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u591a\u4e2a\u5206\u652f\u6a21\u62df\u4ece\u5f00\u53d1\u5230\u4e0a\u7ebf\u7684\u6d41\u7a0b\uff0c\u7406\u5ff5\uff1a\u5206\u522b\u521b\u5efa5\u4e2a\u5206\u652f\uff0c\u5728\u6bcf\u4e2a\u5206\u652f\u4e2d\u589e\u52a0\u5bf9\u5e94\u7684\u4ee3\u7801\uff0c\u6700\u540e\u5408\u5e76\u5230master\u5206\u652f\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5c31\u5728master\u5206\u652f\u4e0a\u65b0\u589e\u914d\u7f6e\u6587\u4ef6\uff0c\u6211\u662f\u76f4\u63a5\u62c9\u53d6dev1\u5206\u652f\uff0c\u53ea\u6709\u7a0b\u5e8f\u4ee3\u7801\u7684\u5206\u652f\uff0c\u7136\u540e\u65b0\u589e\u4e00\u7cfb\u5217\u914d\u7f6e\uff0c\u6700\u540e\u4e0a\u7ebf\u3002"),(0,t.kt)("p",null,"\u62c9\u53d6dev1\u5206\u652f\uff0c\u8fdb\u884c\u4e00\u7cfb\u5217\u914d\u7f6e\u7684\u8bdd\uff0c\u9996\u5148\u8981\u628amaster\u5206\u652f\u91cc\u7684protal\u7a0b\u5e8f\u4ee3\u7801\u540c\u6b65\u5230dev1\u5206\u652f\u91cc\uff0c\u56e0\u4e3adev1\u7684protal\u7a0b\u5e8f\u4ee3\u7801\u6709\u70b9bug\uff0c\u6574\u4e2a\u5fae\u670d\u52a1\u8fd0\u884c\u5b8c\u6bd5\u540e\uff0corder\u8ba2\u5355\u670d\u52a1\u4f1a\u62a5\u9519\u3002"),(0,t.kt)("p",null,"\u5206\u522b\u6709\u4e94\u4e2a\u5206\u652f\uff1a"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"dev1\uff1a\u4ea4\u4ed8\u4ee3\u7801"),(0,t.kt)("li",{parentName:"ul"},"dev2\uff1a\u65b0\u589e\u7a0b\u5e8f\u6253\u5305\u7684Dockerfile\u6587\u4ef6"),(0,t.kt)("li",{parentName:"ul"},"dev3\uff1a\u65b0\u589eK8s\u8d44\u6e90\u7f16\u6392Yaml\u6587\u4ef6"),(0,t.kt)("li",{parentName:"ul"},"dev4\uff1a\u5fae\u670d\u52a1\u94fe\u8def\u76d1\u63a7"),(0,t.kt)("li",{parentName:"ul"},"dev5\uff1a\u65b0\u529f\u80fd\u4ee3\u7801\u66f4\u65b0\u4e0a\u7ebf"),(0,t.kt)("li",{parentName:"ul"},"master\uff1a\u4e0a\u7ebf\u7248\u672c")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/258d6fe2cd114cd58843209bdf1f85de.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h3",{id:"32simple\u5fae\u670d\u52a1\u90e8\u7f72\u5230k8s\u903b\u8f91\u67b6\u6784"},"3.2.simple\u5fae\u670d\u52a1\u90e8\u7f72\u5230K8S\u903b\u8f91\u67b6\u6784"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"simple-microservice\u5fae\u670d\u52a1\u90e8\u7f72\u5230k8s\u5e73\u53f0\u4e3b\u8981\u5206\u4e3a\u5982\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u4fee\u6539\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\uff0c\u5c06\u6570\u636e\u5e93\u7b49\u5404\u7ec4\u4ef6\u5730\u5740\u4fee\u6539\u4e3a\u5f53\u524d\u73af\u5883"),(0,t.kt)("li",{parentName:"ul"},"\u5c06\u5404\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u4f7f\u7528Maven\u7f16\u8bd1\u6210\u53ef\u90e8\u7f72\u7684jar\u5305"),(0,t.kt)("li",{parentName:"ul"},"\u7f16\u5199Dockerfile\u5c06\u7a0b\u5e8f\u505a\u6210docker\u955c\u50cf")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u5bf9K8S\u73af\u5883\u7684\u8981\u6c42\uff1a")),(0,t.kt)("p",null,"\u4e00\u5957\u5b8c\u6574\u7684K8S\u96c6\u7fa4\u3001\u6709cordns\u53ef\u4ee5\u89e3\u6790Service\u5730\u5740\u3001Harbor\u955c\u50cf\u4ed3\u5e93\u3001Nginx\u5bb9\u5668\u5c06\u9879\u76ee\u53d1\u5e03\u5230\u4e92\u8054\u7f51\u6216\u8005INgress\u8d44\u6e90\u5c06\u9879\u76ee\u53d1\u5e03\u5230\u4e92\u8054\u7f51\u3002"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u5fae\u670d\u52a1\u90e8\u7f72\u5230K8S\u73af\u5883\u4e4b\u540e\u67b6\u6784\u662f\u600e\u6837\u7684")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"\u9996\u5148\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u57df\u540d\uff0c\u8bf7\u6c42\u8fbe\u5230\u524d\u7aef\u9875\u9762\uff0c\u70b9\u51fb\u524d\u7aef\u9875\u9762\u4e2d\u7684\u529f\u80fd\u8df3\u8f6c\u5230\u4e0d\u540c\u7684\u5fae\u670d\u52a1\uff0c\u6bd4\u5982\u5546\u54c1\u670d\u52a1\uff0c\u5c06\u5546\u54c1\u670d\u52a1\u7684\u8bf7\u6c42\u4ea4\u4e2aGateway\u7f51\u5173\u670d\u52a1\uff0c\u7531\u7f51\u5173\u670d\u52a1\u8f6c\u53d1\u7ed9\u5546\u54c1\u7684\u5fae\u670d\u52a1\u7a0b\u5e8fProduct\uff0c\u5404\u4e2a\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\uff0c\u90fd\u4eceEureka\u6ce8\u518c\u4e2d\u5fc3\u8bfb\u53d6\u5404\u4e2a\u5fae\u670d\u52a1\u7684\u4fe1\u606f\u5b8c\u6210\u8c03\u5ea6\uff0cProduct\uff08\u5546\u54c1\uff09\u3001Order\uff08\u8ba2\u5355\uff09\u3001Stock\uff08\u5e93\u5b58\uff09\u90fd\u6709\u5355\u72ec\u7684\u6570\u636e\u5e93\uff0cMySQL\u6570\u636e\u90e8\u7f72\u5728K8S\u96c6\u7fa4\u4e4b\u5916\u3002"),(0,t.kt)("p",{parentName:"blockquote"},"\u670d\u52a1\u53d1\u5e03\u5230\u4e92\u8054\u7f51\u91c7\u7528Nginx\u800c\u4e0d\u91c7\u7528Ingress\uff0cNginx\u53ef\u4ee5\u914d\u7f6e\u66f4\u591a\u7684\u53c2\u6570\uff0c\u5c06Nginx\u5bb9\u5668\u8fd0\u884c\u5728\u6bcf\u4e00\u4e2aNode\u4e3b\u673a\u4e0a\uff0c\u6620\u5c04Node\u4e3b\u673a\u768480/443\u7aef\u53e3\uff0c\u901a\u8fc7\u5728hosts\u6587\u4ef6\u91cc\u7ed1\u5b9anode\u4e3b\u673aip+\u7a0b\u5e8f\u57df\u540d\u7684\u65b9\u5f0f\u8bbf\u95ee\u5fae\u670d\u52a1\u3002")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/60f3e04a6fb3410cbdc1f54eee6a7c4e.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h3",{id:"33\u51c6\u5907\u5fae\u670d\u52a1\u5404\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6"},"3.3.\u51c6\u5907\u5fae\u670d\u52a1\u5404\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6"),(0,t.kt)("p",null,"\u5728\u4f7f\u7528Maven\u4e4b\u524d\uff0c\u9996\u5148\u5c06\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\uff0c\u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u518d\u60f3\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\uff0c\u5c31\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u4e86\uff0c\u5c06\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684\u73af\u5883\u5730\u5740\u90fd\u4fee\u6539\u6210\u81ea\u5df1\u73af\u5883\u7684\u5730\u5740\u3002"),(0,t.kt)("p",null,"\u62c9\u53d6dev1\u5206\u652f\u5c55\u5f00\u5168\u65b0\u914d\u7f6e"),(0,t.kt)("h4",{id:"331\u521b\u5efa\u5fae\u670d\u52a1\u5404\u4e2a\u7a0b\u5e8f\u7684prod\u914d\u7f6e\u6587\u4ef6"},"3.3.1.\u521b\u5efa\u5fae\u670d\u52a1\u5404\u4e2a\u7a0b\u5e8f\u7684prod\u914d\u7f6e\u6587\u4ef6"),(0,t.kt)("p",null,"eureka\uff08\u6ce8\u518c\u4e2d\u5fc3\uff09\u3001gateway\uff08\u7f51\u5173\uff09\u3001order\uff08\u8ba2\u5355\uff09\u3001portal\uff08\u9996\u9875\uff09\u3001product\uff08\u5546\u54c1\uff09\u3001stock\uff08\u5e93\u5b58\uff09\u8fd9\u51e0\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u90fd\u9700\u8981\u914d\u7f6e\uff0c\u65b0\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u7ebf\u4e0a\u751f\u4ea7\u73af\u5883"),(0,t.kt)("p",null,"order\uff08\u8ba2\u5355\uff09\u3001product\uff08\u5546\u54c1\uff09\u3001stock\uff08\u5e93\u5b58\uff09\u8fd9\u4e9b\u5fae\u670d\u52a1\u6709\u4e24\u4e2a\u5305\uff0c\u5206\u522b\u662fxxx-biz\u548cxxx-api\uff0c\u53ea\u9700\u8981\u90e8\u7f72biz\u76ee\u5f55\u4e0b\u7684jar\u5305\u5373\u53ef\uff0capi\u7684\u76ee\u5f55\u53ea\u662f\u5b58\u5728\u4e00\u4e9b\u4f9d\u8d56"),(0,t.kt)("p",null,"order\uff08\u8ba2\u5355\uff09\u3001product\uff08\u5546\u54c1\uff09\u3001stock\uff08\u5e93\u5b58\uff09\u8fd9\u4e9b\u5fae\u670d\u52a1\u90fd\u6709\u81ea\u5df1\u5355\u72ec\u7684\u6570\u636e\u5e93"),(0,t.kt)("p",null,"\u5148\u5c06prod\u7684\u914d\u7f6e\u6587\u4ef6\u521b\u5efa\u51fa\u6765\uff0c\u5f85eureka\u9879\u76ee\u90e8\u7f72\u5b8c\u6210\u540e\uff0c\u518d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u4fee\u6539\uff0c\u6700\u540e\u5c06\u7a0b\u5e8f\u7f16\u8bd1"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.eureka-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# cd eureka-service/src/main/resources/\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]\\# cp application-fat.yml application-prod.yml\n\n2.\u7a0b\u5e8f\u4f7f\u7528prod\u7684\u914d\u7f6e\u6587\u4ef6\u8fd0\u884c\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]\\# vim application.yml \nserver:\n  port: 8080        #eureka\u7684\u7aef\u53e3\u53f7\nspring:\n  application:\n    name: legendshop-basic-eureka\n  profiles:\n    active: prod    #\u5c06\u8fd9\u91cc\u4fee\u6539\u4e3aprod\u5c31\u4f1a\u8c03\u7528prod\u914d\u7f6e\u6587\u4ef6\n\n3.\u914d\u7f6eeureka\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/eureka-service/src/main/resources]\\# vim application-prod.yml \neureka:\n  server:\n    renewal-percent-threshold: 0.9\n    enable-self-preservation: false\n    eviction-interval-timer-in-ms: 40000\n  instance:\n    hostname: 127.0.0.1\n    prefer-ip-address: true\n  client:\n    register-with-eureka: false\n    serviceUrl:\n      defaultZone: http://127.0.0.1:${server.port}/eureka/\n    fetch-registry: false\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.gateway-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# cd gateway-service/src/main/resources/\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]\\# cp application-fat.yml application-prod.yml\n\n2.\u7a0b\u5e8f\u4f7f\u7528prod\u7684\u914d\u7f6e\u6587\u4ef6\u8fd0\u884c\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]\\# cat application.yml \nserver:\n  port: 8080\nspring:\n  profiles:\n    active: prod\n  application:\n    name: @artifactId@\n    \n3.\u914d\u7f6e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6    \n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service/src/main/resources]\\# vim application-prod.yml \n\xb7\xb7\xb7\xb7\xb7\xb7\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #\u4fee\u6539eureka\u5730\u5740\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"3.order-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# cd order-service/order-service-biz/src/main/resources/\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]\\# cp application-fat.yml application-prod.yml\n\n2.\u7a0b\u5e8f\u4f7f\u7528prod\u7684\u914d\u7f6e\u6587\u4ef6\u8fd0\u884c\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]\\# vim application.yml \nserver:\n  port: 8080\nspring:\n  profiles:\n    active: prod\n  application:\n    name: order-service\n\n3.\u914d\u7f6e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6    \n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources]\\# vim application-prod.yml \nspring:\n  datasource:\n    url: jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8     #mysql\u6570\u636e\u5e93\u5730\u5740\n    username: root  \n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #eureka\u5730\u5740\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"5.product-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# cd product-service/product-service-biz/src/main/resources/\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]\\# cp application-fat.yml application-prod.yml\n\n2.\u7a0b\u5e8f\u4f7f\u7528prod\u7684\u914d\u7f6e\u6587\u4ef6\u8fd0\u884c\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]\\# vim application.yml \nserver:\n  port: 8080\nspring:\n  profiles:\n    active: prod\n  application:\n    name: product-service\n\n3.\u914d\u7f6e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources]\\# vim application-prod.yml \nspring:\n  datasource:\n    url: jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8     #\u6570\u636e\u5e93\u5730\u5740\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #eureka\u5730\u5740\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"6.stock-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# cd stock-service/stock-service-biz/src/main/resources/\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]\\# cp application-fat.yml application-prod.yml\n\n2.\u7a0b\u5e8f\u4f7f\u7528prod\u7684\u914d\u7f6e\u6587\u4ef6\u8fd0\u884c\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]\\# vim application.yml \nserver:\n  port: 8080\nspring:\n  profiles:\n    active: prod\n  application:\n    name: stock-service\n\n3.\u914d\u7f6e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources]\\# vim application-prod.yml \nspring:\n  datasource:\n    url: jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8   #\u6570\u636e\u5e93\u5730\u5740\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-service.eureka:8080/eureka/      #eureka\u5730\u5740                            \n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"4.portal-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2aprod\u7684\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# cd portal-service/src/main/resources/\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service/src/main/resources]\\# cp application-fat.yml application-prod.yml\n\n2.\u7a0b\u5e8f\u4f7f\u7528prod\u7684\u914d\u7f6e\u6587\u4ef6\u8fd0\u884c\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service/src/main/resources]\\# vim application.yml \nserver:\n  port: 8080\n  undertow:\n    io-threads: 16\n    worker-threads: 256\n    buffer-size: 1024\n    direct-buffers: true\nspring:\n  application:\n    name: portal-service\n  profiles:\n    active: prod\n\n3.\u914d\u7f6e\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service/src/main/resources]\\# vim application-prod.yml \neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    service-url:\n      defaultZone: http://eureka-0.eureka-service:8080/eureka/      #\u6307\u5b9aeureka\u5730\u5740\n    register-with-eureka: true\n    fetch-registry: true\n\xb7\xb7\xb7\xb7\xb7\xb7\n")),(0,t.kt)("h4",{id:"332\u8c03\u6574\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684pom\u6587\u4ef6\u589e\u52a0prod\u73af\u5883"},"3.3.2.\u8c03\u6574\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684pom\u6587\u4ef6\u589e\u52a0prod\u73af\u5883"),(0,t.kt)("p",null,"\u7531\u4e8e\u6211\u4eec\u65b0\u52a0\u4e86\u4e00\u4e2aprod\u7ebf\u4e0a\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u56e0\u6b64\u4e5f\u9700\u8981\u5728pom.xml\u4e2d\u914d\u7f6e\uff0c\u914d\u7f6e\u5b8c\u6210\u540e\u53ef\u4ee5\u7f16\u8bd1\u4e00\u4e0b\uff0c\u770b\u770b\u662f\u5426\u53ef\u4ee5\u505a\u6210\u53ef\u90e8\u7f72\u7684\u7a0b\u5e8f\u5305"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'1.\u5b89\u88c5maven\n[root@binary-k8s-master1 ~]\\# yum -y install java-1.8.0-openjdk maven\n\n2.\u8c03\u6574pom.xml\u589e\u52a0prod\u73af\u5883\u914d\u7f6e\n[root@binary-k8s-master1 simple-microservice-dev1]\\# vim pom.xml \n\xb7\xb7\xb7\xb7\xb7\xb7      #65\u884c\u5de6\u53f3\n    <profile>\n      <id>prod</id>\n      <properties>\n        <profileActive>prod</profileActive>\n      </properties>\n    </profile>\n\n  </profiles>\n\xb7\xb7\xb7\xb7\xb7\xb7\n\n2.\u7f16\u8bd1\u7a0b\u5e8f\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# mvn clean package -D maven.test.skip=true -P prod\n\n3.\u67e5\u770b\u7f16\u8bd1\u6210\u529f\u7684war\u5305\n[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1]\\# find . -name "*.jar"\n./basic-common/basic-common-core/target/basic-common-core.jar\n./eureka-service/target/eureka-service.jar\n./gateway-service/target/gateway-service.jar\n./order-service/order-service-api/target/order-service-api.jar\n./order-service/order-service-biz/target/order-service-biz.jar\n./portal-service/target/portal-service.jar\n./product-service/product-service-api/target/product-service-api.jar\n./product-service/product-service-biz/target/product-service-biz.jar\n./stock-service/stock-service-api/target/stock-service-api.jar\n./stock-service/stock-service-biz/target/stock-service-biz.jar\n')),(0,t.kt)("h3",{id:"34\u5236\u4f5c\u5fae\u670d\u52a1\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u7684\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf"},"3.4.\u5236\u4f5c\u5fae\u670d\u52a1\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u7684\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf"),(0,t.kt)("h4",{id:"341\u4e3a\u7a0b\u5e8f\u73af\u5883\u6784\u5efa\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf"},"3.4.1.\u4e3a\u7a0b\u5e8f\u73af\u5883\u6784\u5efa\u5e95\u5c42\u7cfb\u7edf\u955c\u50cf"),(0,t.kt)("p",null,"\u7531\u4e8e\u662fSpringCloud\u5fae\u670d\u52a1\u7cfb\u7edf\uff0cSpringCloud\u5c5e\u4e8eJAVA\u8bed\u8a00\u5f00\u53d1\u7684\u9879\u76ee\uff0c\u56e0\u6b64\u8981\u6709JAVA\u542f\u52a8\u73af\u5883\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'1.\u62c9\u53d6centos7.5\u4f5c\u4e3a\u5e95\u5c42\u5bb9\u5668\n[root@binary-k8s-master1 ~]\\# docker pull centos:7.5.1804\n\n2.\u542f\u52a8\u5bb9\u5668\n[root@binary-k8s-master1 ~]\\# docker run -itd centos:7.5.1804\n\n3.\u8fdb\u5165\u7cfb\u7edf\u5bb9\u5668\u8fdb\u884c\u73af\u5883\u914d\u7f6e\n[root@binary-k8s-master1 ~]\\# docker exec -it 462237f9a0a bash\n#\u5b89\u88c5java\u73af\u5883\n[root@2fcfb51f04e0 /]\\# yum -y install java-1.8.0-openjdk net-tools\n[root@2fcfb51f04e0 /]\\# java  -version\nopenjdk version "1.8.0_302"\nOpenJDK Runtime Environment (build 1.8.0_302-b08)\nOpenJDK 64-Bit Server VM (build 25.302-b08, mixed mode)\n[root@2fcfb51f04e0 /]\\# mkdir /data/simple-microservice -p\n#\u8c03\u6574\u7cfb\u7edf\u65f6\u533a\n[root@2fcfb51f04e0 /]\\# yum -y intall tzdata\n[root@2fcfb51f04e0 /]\\# ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \n\n4.\u5c06\u5bb9\u5668\u63d0\u4ea4\u4e3a\u955c\u50cf\n[root@binary-k8s-master1 ~]\\# docker commit 2fcfb51f04e0 centos-java:v1\n\n5.\u914d\u7f6eHarbor\u955c\u50cf\u4ed3\u5e93\n[root@binary-k8s-master1 ~]\\# vim /etc/docker/daemon.json \n{\n  "registry-mirrors": ["https://9wn5tbfh.mirror.aliyuncs.com"],\n  "insecure-registries": ["192.168.20.10"]\n}\n[root@binary-k8s-master1 ~]\\# systemctl restart docker\n\n6.\u63d0\u4ea4\u955c\u50cf\u5230Harbor\u4ed3\u5e93\n[root@binary-k8s-master1 ~]\\# docker login -u admin -p Harbor12345 192.168.20.10\n[root@binary-k8s-master1 ~]\\# docker tag centos-java:v1 192.168.20.11/base/centos-java:v1\n[root@binary-k8s-master1 ~]\\# docker push 192.168.20.11/base/centos-java:v1\n')),(0,t.kt)("h4",{id:"342\u4e3a\u6bcf\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u7f16\u5199dockerfile"},"3.4.2.\u4e3a\u6bcf\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u7f16\u5199Dockerfile"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"\u8bbe\u8ba1\u6982\u5ff5\uff1a")),(0,t.kt)("p",null,"\u91c7\u75283.3.1\u4e2d\u5236\u4f5c\u7684\u5e95\u5c42\u955c\u50cf"),(0,t.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u5728\u955c\u50cf\u91cc\u9762\u521b\u5efa",(0,t.kt)("inlineCode",{parentName:"p"},"/data/simple-microservice/\u5fae\u670d\u52a1\u540d\u79f0"),"\u8fd9\u6837\u7684\u76ee\u5f55\u7528\u4e8e\u5b58\u653e\u7a0b\u5e8f\u7684jar\u5305"),(0,t.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u5c06\u7a0b\u5e8f\u7684jar\u5305\u62f7\u8d1d\u81f3\u955c\u50cf\u4e2d"),(0,t.kt)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u751f\u6210\u4e00\u4e2a\u542f\u52a8\u811a\u672c\uff0c\u7531\u4e8e\u670d\u52a1\u540d\u79f0\u90fd\u4e0d\u4e00\u6837\u4e5f\u5c31\u662f\u6bcf\u4e2a\u7a0b\u5e8f\u7684\u8def\u5f84\u90fd\u4e0d\u540c\uff0c\u60f3\u8981\u505a\u5230\u4e00\u4e2a\u5e95\u5c42\u955c\u50cf\u591a\u4e2a\u7a0b\u5e8f\u590d\u7528\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5728\u542f\u52a8\u811a\u672c\u91cc\u624b\u52a8\u6307\u5b9a\u7a0b\u5e8f\u7684\u8def\u5f84\uff0c\u5728\u811a\u672c\u4e2d\u6307\u5b9a\u7a0b\u5e8f\u7684\u90e8\u7f72\u8def\u5f84\u4ee5\u53ca\u65e5\u5fd7\u8def\u5f84"),(0,t.kt)("p",null,"\u7b2c\u56db\u6b65\uff1a\u66b4\u97328080\u7aef\u53e3"),(0,t.kt)("p",null,"\u5c06Dockerfile\u653e\u5230\u7a0b\u5e8f\u7f16\u8bd1\u7684\u76ee\u5f55\u4e5f\u5c31\u662f\u4e0esrc\u5728\u540c\u4e00\u76ee\u5f55"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.eureka-service\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"\u57284.2.2.\u4f1a\u5199\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.gateway-service\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/gateway-service]\\# vim Dockerfile \nFROM 192.168.20.11/base/centos-java:v1\nRUN mkdir /data/simple-microservice/gateway-service -p\nCOPY ./target/gateway-service.jar /data/simple-microservice/gateway-service/\nRUN echo -e "#!/bin/bash \\njava -jar /data/simple-microservice/gateway-service/gateway-service.jar > /data/simple-microservice/gateway-service/gateway-service.log & \\ntail -f /data/simple-microservice/gateway-service/gateway-service.log" > /data/entrypoint.sh && chmod a+x /data/entrypoint.sh\nEXPOSE 8080\nENTRYPOINT /data/entrypoint.sh\n')),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"3.order-service\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/order-service/order-service-biz]\\# vim Dockerfile \nFROM 192.168.20.11/base/centos-java:v1\nRUN mkdir /data/simple-microservice/order-service -p\nCOPY ./target/order-service-biz.jar /data/simple-microservice/order-service/\nRUN echo -e "#!/bin/bash \\njava -jar /data/simple-microservice/order-service/order-service-biz.jar > /data/simple-microservice/order-service/order-service-biz.log & \\ntail -f /data/simple-microservice/order-service/order-service-biz.log" > /data/entrypoint.sh && chmod a+x /data/entrypoint.sh\nEXPOSE 8080\nENTRYPOINT /data/entrypoint.sh\n')),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"4.portal-service\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/portal-service]\\# vim Dockerfile \nFROM 192.168.20.11/base/centos-java:v1\nRUN mkdir /data/simple-microservice/portal-service -p\nCOPY ./target/portal-service.jar /data/simple-microservice/portal-service/\nRUN echo -e "#!/bin/bash \\njava -jar /data/simple-microservice/portal-service/portal-service.jar > /data/simple-microservice/portal-service/portal-service.log & \\ntail -f /data/simple-microservice/portal-service/portal-service.log" > /data/entrypoint.sh && chmod a+x /data/entrypoint.sh\nEXPOSE 8080\nENTRYPOINT /data/entrypoint.sh\n')),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"5.product-service\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/product-service/product-service-biz]\\# vim Dockerfile\nFROM 192.168.20.11/base/centos-java:v1\nRUN mkdir /data/simple-microservice/product-service -p\nCOPY ./target/product-service-biz.jar /data/simple-microservice/product-service/\nRUN echo -e "#!/bin/bash \\njava -jar /data/simple-microservice/product-service/product-service-biz.jar > /data/simple-microservice/product-service/product-service-biz.log & \\ntail -f /data/simple-microservice/product-service/product-service-biz.log" > /data/entrypoint.sh && chmod a+x /data/entrypoint.sh\nEXPOSE 8080\nENTRYPOINT /data/entrypoint.sh\n')),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"6.stock-service\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'[root@binary-k8s-master1 ~/springcloud/simple-microservice-dev1/stock-service/stock-service-biz]\\# cat Dockerfile\nFROM 192.168.20.11/base/centos-java:v1\nRUN mkdir /data/simple-microservice/stock-service -p\nCOPY ./target/stock-service-biz.jar /data/simple-microservice/stock-service/\nRUN echo -e "#!/bin/bash \\njava -jar /data/simple-microservice/stock-service/stock-service-biz.jar > /data/simple-microservice/stock-service/stock-service-biz.log & \\ntail -f /data/simple-microservice/stock-service/stock-service-biz.log" > /data/entrypoint.sh && chmod a+x /data/entrypoint.sh\nEXPOSE 8080\nENTRYPOINT /data/entrypoint.sh\n')),(0,t.kt)("h3",{id:"35\u8c03\u6574protal\u5fae\u670d\u52a1\u4e2d\u8fde\u63a5gateway\u7f51\u5173\u7684\u5730\u5740"},"3.5.\u8c03\u6574Protal\u5fae\u670d\u52a1\u4e2d\u8fde\u63a5Gateway\u7f51\u5173\u7684\u5730\u5740"),(0,t.kt)("p",null,"Protal\u662f\u6211\u4eec\u7535\u5546\u5e73\u53f0\u7684\u95e8\u6237\u7f51\u7ad9\uff0c\u4e5f\u5c31\u662f\u524d\u7aef\u9996\u9875\uff0c\u5728Protal\u5fae\u670d\u52a1\u4e2d\u4f1a\u586b\u5199\u597d\u5176\u4ed6\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684\u5730\u5740\uff0cGateway\u7f51\u5173\u7a0b\u5e8f\u7684\u5730\u5740\u5c31\u662f\u5199\u6b7b\u5728Protal\u9879\u76ee\u7684js\u91cc\uff0c\u5728\u6211\u4eec\u5b9a\u4e49\u597dGateway\u7f51\u5173\u670d\u52a1\u7684\u57df\u540d\u540e\uff0c\u5c31\u8981\u5c06\u57df\u540d\u5199\u5165\u5230\u5bf9\u5e94\u7684js\u6587\u4ef6\u91cc\uff0c\u5426\u5219\u5f53\u9879\u76ee\u542f\u52a8\u4e4b\u540e\u662f\u65e0\u6cd5\u8c03\u901a\u7684\u3002"),(0,t.kt)("p",null,"\u9700\u8981\u4fee\u6539\u4e0b\u5217\u8fd9\u56db\u4e2a\u6587\u4ef6"),(0,t.kt)("p",null,"portal-service/src/main/resources/static/js/orderList.js"),(0,t.kt)("p",null,"portal-service/src/main/resources/static/js/productList.js\n",(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/d0e207db0cb54e6296ca185728e5ed1c.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"\u6253\u5f00\u8fd9\u56db\u4e2a\u6587\u4ef6\uff0c\u5c06\u91cc\u9762\u7684gateway.ctnrs.com\u57df\u540d\u4fee\u6539\u4e3agateway.jiangxl.com\u57df\u540d\n\nvim\u4fee\u6539\u547d\u4ee4\uff1a%s/gateway.ctnrs.com/gateway.jiangxl.com/g\n")),(0,t.kt)("h3",{id:"36\u90e8\u7f72ingress\u7528\u4e8e\u5c06\u5fae\u670d\u52a1\u7a0b\u5e8f\u53d1\u5e03\u5230\u4e92\u8054\u7f51"},"3.6.\u90e8\u7f72Ingress\u7528\u4e8e\u5c06\u5fae\u670d\u52a1\u7a0b\u5e8f\u53d1\u5e03\u5230\u4e92\u8054\u7f51"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u4e0b\u8f7dingress\u90e8\u7f72\u7684yaml\u6587\u4ef6\n[root@binary-k8s-master1 ~]\\# wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/mandatory.yaml\n[root@binary-k8s-master1 ~]\\# wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/provider/baremetal/service-nodeport.yaml\n\n2.\u8c03\u6574ingress nodeport\u7aef\u53e3\n[root@binary-k8s-master1 ~/springcloud/ingress]\\# vim service-nodeport.yaml\n\xb7\xb7\xb7\xb7\xb7\xb7\n  ports:\n    - name: http\n      port: 80\n      targetPort: 80\n      nodePort: 80\n      protocol: TCP\n    - name: https\n      port: 443\n      targetPort: 443\n      nodePort: 443\n      protocol: TCP\n\xb7\xb7\xb7\xb7\xb7\xb7\n\n3.\u90e8\u7f72ingress\n[root@binary-k8s-master1 ~/springcloud/ingress]\\# kubectl apply -f mandatory.yaml\n\n4.\u67e5\u770bingress\u90e8\u7f72\u7684\u7ed3\u679c\n[root@binary-k8s-master1 ~]\\# kubectl get all -n ingress-nginx\nNAME                                            READY   STATUS    RESTARTS   AGE\npod/nginx-ingress-controller-766867958b-n7dwj   1/1     Running   0          49m\n\nNAME                    TYPE       CLUSTER-IP   EXTERNAL-IP   PORT(S)                 AGE\nservice/ingress-nginx   NodePort   10.0.0.107   <none>        80:80/TCP,443:443/TCP   49m\n\nNAME                                       READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/nginx-ingress-controller   1/1     1            1           49m\n\nNAME                                                  DESIRED   CURRENT   READY   AGE\nreplicaset.apps/nginx-ingress-controller-766867958b   1         1         1       49m\n")),(0,t.kt)("h2",{id:"4\u5728kubernetes\u96c6\u7fa4\u90e8\u7f72simple\u5fae\u670d\u52a1\u9879\u76ee"},"4.\u5728kubernetes\u96c6\u7fa4\u90e8\u7f72simple\u5fae\u670d\u52a1\u9879\u76ee"),(0,t.kt)("p",null,"simple\u5fae\u670d\u52a1\u9879\u76ee\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72\uff0c\u53ea\u6709eureka\u670d\u52a1\u91c7\u7528statefulset\u63a7\u5236\u5668\u90e8\u7f72\uff0c\u5176\u4f59\u6240\u6709\u5fae\u670d\u52a1\u5747\u91c7\u7528deployment\u63a7\u5236\u5668\u90e8\u7f72\uff0c\u6240\u6709\u7684\u5fae\u670d\u52a1\u901a\u8fc7ingress\u53d1\u5e03\u5728\u4e92\u8054\u7f51\u3002"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"simple\u5fae\u670d\u52a1\u7535\u5546\u9879\u76ee\u5728K8S\u96c6\u7fa4\u90e8\u7f72\u6d41\u7a0b")),(0,t.kt)("p",null,"1\uff09\u90e8\u7f72simple\u7535\u5546\u5fae\u670d\u52a1\u9879\u76ee\u7684\u6570\u636e\u5e93\u73af\u5883"),(0,t.kt)("p",null,"2\uff09\u5728K8S\u4e2d\u90e8\u7f72Eureka\u6ce8\u518c\u4e2d\u5fc3"),(0,t.kt)("p",null,"3\uff09\u4fee\u6539\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6307\u5b9aeureka\u6ce8\u518c\u4e2d\u5fc3\u96c6\u7fa4\u7684\u5730\u5740"),(0,t.kt)("p",null,"4\uff09\u4f7f\u7528maven\u5c06\u6bcf\u4e2a\u5fae\u670d\u52a1\u6784\u5efa\u6210\u53ef\u90e8\u7f72\u7684jar\u5305"),(0,t.kt)("p",null,"5\uff09\u90e8\u7f72Gateway\u5173\u670d\u52a1"),(0,t.kt)("p",null,"6\uff09\u90e8\u7f72protal\u3001order\u3001product\u3001stock\u670d\u52a1"),(0,t.kt)("h3",{id:"41\u90e8\u7f72simple\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684mysql\u6570\u636e\u5e93\u73af\u5883"},"4.1.\u90e8\u7f72simple\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684mysql\u6570\u636e\u5e93\u73af\u5883"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u5b89\u88c5MySQL\u6570\u636e\u5e93\n[root@harbor-mysql ~]\\# rpm -ivh http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm\n[root@harbor-mysql ~]\\#  yum install mysql-community-server \n\n2.\u542f\u52a8MySQL\n[root@harbor-mysql ~]\\# systemctl start mysqld\n[root@harbor-mysql ~]\\# systemctl enable mysqld\n\n3.\u8bbe\u7f6e\u6570\u636e\u5e93\u5bc6\u7801\n[root@harbor-mysql ~]\\# mysqladmin -u root password '123456'\n\n4.\u521b\u5efaorder\uff08\u8ba2\u5355\uff09\u3001product\uff08\u5546\u54c1\uff09\u3001stock\uff08\u5e93\u5b58\uff09\u5fae\u670d\u52a1\u7684\u6570\u636e\u5e93\n[root@harbor-mysql ~]\\# mysql -uroot -p123456\nmysql> create database tb_order;\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> create database tb_product;\nQuery OK, 1 row affected (0.01 sec)\n\nmysql> create database tb_stock;\nQuery OK, 1 row affected (0.00 sec)\n\n5.\u5bfc\u5165\u6570\u636e\u5e93\u6570\u636e\n#\u5c06\u6570\u636e\u5e93\u6587\u4ef6\u4f20\u5230\u6570\u636e\u5e93\u670d\u52a1\u5668\n[root@binary-k8s-master1 simple-microservice-dev1]\\# scp -r db root@192.168.20.11:/root\n#\u5bfc\u5165order\u6570\u636e\u5e93\u7684\u6570\u636e\nmysql> use tb_order\nmysql> source /root/db/order.sql\n#\u5bfc\u5165product\u6570\u636e\u5e93\u7684\u6570\u636e\nmysql> use tb_product\nmysql> source /root/db/product.sql\n#\u5bfc\u5165stock\u6570\u636e\u5e93\u7684\u6570\u636e\nmysql> use tb_stock;\nmysql> source /root/db/stock.sql\n\n6.\u5141\u8bb8\u6570\u636e\u5e93\u8fdc\u7a0b\u8bbf\u95ee\nmysql> grant all privileges on *.* to 'root'@'%' identified by '123456' with grant option;\nQuery OK, 0 rows affected (0.00 sec)\n")),(0,t.kt)("h3",{id:"42\u90e8\u7f72eureka\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"},"4.2.\u90e8\u7f72eureka\u5fae\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"),(0,t.kt)("p",null,"Eureka\u5728\u6574\u4e2a\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u8d77\u5230\u81f3\u5173\u91cd\u8981\u7684\u7684\u4f5c\u7528\uff0c\u5fc5\u987b\u4fdd\u8bc1Eureka\u670d\u52a1\u9ad8\u53ef\u7528\u3002"),(0,t.kt)("p",null,"Eureka\u670d\u52a1\u91c7\u7528statefulset\u6709\u72b6\u6001\u5e94\u7528\u90e8\u7f72\u65b9\u5f0f\u518dK8S\u96c6\u7fa4\u4e2d\u8fdb\u884c\u90e8\u7f72\u3002"),(0,t.kt)("p",null,"Eureka\u672c\u8eab\u5c31\u53ef\u4ee5\u5229\u7528\u81ea\u8eab\u7684\u670d\u52a1\u53d1\u73b0\u6765\u5b9e\u73b0\u96c6\u7fa4\u7684\u9ad8\u53ef\u7528\uff0c\u53ea\u9700\u8981\u5728Eureka\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u5404\u4e2aEureka\u8282\u70b9\u7684\u5730\u5740\u5c31\u53ef\u4ee5\u5b9e\u73b0\u3002"),(0,t.kt)("p",null,"\u5c06\u7a0b\u5e8f\u90e8\u7f72\u5728K8S\u4e4b\u540e\uff0c\u5982\u4f55\u80fd\u591f\u4fdd\u8bc1\u6bcf\u4e2aEureka Pod\u7684\u5730\u5740\u552f\u4e00\u4e0d\u53d8\uff0c\u5c31\u9700\u8981\u7528\u5230Statefulset\u63a7\u5236\u5668\u91c7\u7528\u6709\u72b6\u6001\u7684\u5e94\u7528\u90e8\u7f72\uff0c\u4f7f\u7528Statefulset\u63a7\u5236\u5668\u4e4b\u540e\uff0c\u6bcf\u4e2aPod\u7684\u540d\u79f0\u90fd\u662f\u552f\u4e00\u4e0d\u53d8\u7684\uff0c\u5e76\u4e14\u6bcf\u4e2aPod\u90fd\u6709\u4e00\u4e2aDNS\u670d\u52a1\u53d1\u73b0\u5730\u5740\uff0c\u901a\u8fc7\u8fd9\u4e2aDNS\u5730\u5740\u5c31\u53ef\u4ee5\u8bf7\u6c42\u5230Pod\u4e2d\u7684\u670d\u52a1\uff0c\u4e3b\u8981\u662fcoredns\u7ec4\u4ef6\u6765\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u96c6\u7fa4\u8fd8\u9700\u8981\u5b89\u88c5\u6709coredns\u670d\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6bcf\u4e00\u4e2aEureka Pod\u7684DNS\u670d\u52a1\u53d1\u73b0\u5730\u5740\u5199\u5165\u5230Eureka\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6bcf\u4e2aEureka\u8282\u70b9\u76f8\u4e92\u6ce8\u518c\uff0c\u6700\u7ec8\u5f62\u6210\u9ad8\u53ef\u7528\u96c6\u7fa4\u3002"),(0,t.kt)("p",null,"Statefulset+Headless\u90e8\u7f72\u7684\u7a0b\u5e8fDNS\u540d\u683c\u5f0f\uff1a",(0,t.kt)("inlineCode",{parentName:"p"},"<statefulsetName-index>.<service-name>.<namespace-name>.svc.cluster.local"),"\u540e\u9762\u7684.svc.cluster.local\u53ef\u4ee5\u53bb\u6389\uff0cK8S\u9ed8\u8ba4\u5c31\u662f.svc.cluster.local\u3002"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"<statefulsetName-index>"),"\u5c31\u662fPod\u7684\u540d\u79f0\uff0c-index\u662f\u6bcf\u4e00\u4e2aPod\u540d\u79f0\u540e\u9762\u7684\u6570\u5b57\u7f16\u53f7\uff0cStatefulset\u63a7\u5236\u5668\u90e8\u7f72\u597d\u7684Pod\uff0c\u4f1a\u5728\u6bcf\u4e00\u4e2aPod\u540d\u79f0\u540e\u9762\u52a0\u4e0a\u4e00\u4e2a\u6570\u5b57\u7f16\u53f7\uff0c\u4ece0\u5f00\u59cb\uff0c\u4e00\u6b21\u7d2f\u52a0\uff0c\u4fdd\u8bc1\u6240\u6709\u7684Pod\u90fd\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u8bbf\u95ee\u5165\u53e3"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"<service-name>"),"\u662f\u7a0b\u5e8f\u7684service\u8d44\u6e90\u7684\u540d\u79f0"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"<namespace-name>"),"\u662f\u7a0b\u5e8f\u6240\u5728\u7684namespace\u540d\u79f0"),(0,t.kt)("p",null,"\u6211\u4eec\u7684Eureka\u89c4\u5b9a\u7684\u8282\u70b9\u6570\u4e3a3\u4e2a\uff0c\u4e5f\u5c31\u662f\u6700\u7ec8statefulset\u4f1a\u542f\u52a83\u4e2aPod\u526f\u672c\u7ec4\u6210Eureka\u96c6\u7fa4\u3002"),(0,t.kt)("h4",{id:"421\u4fee\u6539eureka\u914d\u7f6e\u6587\u4ef6\u589e\u52a0\u5404\u8282\u70b9\u5730\u5740"},"4.2.1.\u4fee\u6539Eureka\u914d\u7f6e\u6587\u4ef6\u589e\u52a0\u5404\u8282\u70b9\u5730\u5740"),(0,t.kt)("p",null,"Eureka\u96c6\u7fa4\u8282\u70b9\u6bcf\u4e2aPod\u526f\u672c\u670d\u52a1\u53d1\u73b0\u5730\u5740\u5982\u4e0b\uff0c\u9700\u8981\u5c06\u5176\u914d\u7f6e\u5728eureka\u4e2d"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"http://eureka-0.eureka-service.simple-ms`\n`http://eureka-0.eureka-service.simple-ms`\n`http://eureka-0.eureka-service.simple-ms\n")),(0,t.kt)("p",null,"\u4fee\u6539Eureka\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u91c7\u7528Dns\u670d\u52a1\u53d1\u73b0\u5730\u5740\u7684\u5f62\u5f0f\u5c06\u6bcf\u4e2a\u8282\u70b9\u7684\u5730\u5740\u90fd\u5199\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5f53Eureka\u542f\u52a8\u4e4b\u540e\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u4f1a\u76f8\u4e92\u53d1\u73b0\u6700\u7ec8\u5f62\u6210\u9ad8\u53ef\u7528\u96c6\u7fa4\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u4fee\u6539Eureka\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u8282\u70b9\u5730\u5740\n[root@binary-k8s-master1 eureka-service]\\# vim src/main/resources/application-prod.yml\neureka:\n  server:\n    renewal-percent-threshold: 0.9\n    enable-self-preservation: false\n    eviction-interval-timer-in-simple-ms: 40000\n  instance:\n    hostname: 127.0.0.1\n    prefer-ip-address: false\n  client:\n    register-with-eureka: true\n    serviceUrl:\n      defaultZone: http://eureka-0.eureka.simple-ms:${server.port}/eureka/,http://eureka-1.eureka.simple-ms:${server.port}/eureka/,http://eureka-2.eureka.simple-ms:${server.port}/eureka/\n    fetch-registry: true\n\n2.\u4f7f\u7528maven\u5c06\u6700\u65b0\u7684Eureka\u7f16\u8bd1\n[root@binary-k8s-master1 simple-microservice-dev1]\\# mvn clean package -D maven.test.skip=true -P prod\n\n\u6ce8\u610f\uff1a\u53ea\u80fd\u5728\u9879\u76ee\u6700\u5916\u5c42\u7684\u76ee\u5f55\u4e2d\u6267\u884cmvn clean package\n")),(0,t.kt)("h4",{id:"422\u8c03\u6574eureka\u7684dockerfile"},"4.2.2.\u8c03\u6574Eureka\u7684Dockerfile"),(0,t.kt)("p",null,"\u7531\u4e8e\u6211\u4eec\u5728Eureka\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u662f\u4ee5dns\u540d\u79f0\u6765\u4e92\u76f8\u53d1\u73b0\u5bf9\u65b9\uff0c\u5e76\u4e0d\u662f\u4ee5IP\u5730\u5740\u5f62\u5f0f\u53d1\u73b0\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u914d\u7f6eDockerfile\uff0c\u5728\u542f\u52a8\u7a0b\u5e8f\u65f6\u5c06\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684hostname\u5b57\u6bb5\u503c\u4fee\u6539\u4e3a\u5f53\u524dPod\u7684dns\u540d\u79f0\u3002"),(0,t.kt)("p",null,"\u56e0\u4e3a\u6211\u4eec\u7684Eureka\u662f\u591aPod\u7ec4\u6210\u7684\u9ad8\u53ef\u7528\u96c6\u7fa4\uff0c\u56e0\u6b64\u4e0d\u80fd\u5c06dns\u540d\u79f0\u5199\u6b7b\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u4e0d\u7136\u6bcf\u4e2aPod\u90fd\u662f\u540c\u6837\u7684\u5730\u5740\uff0c\u96c6\u7fa4\u662f\u7ec4\u4ef6\u4e0d\u6210\u529f\u7684\uff0c\u6240\u4ee5\u5c31\u9700\u8981\u5728Dockerfile\u4e2d\u5b9a\u4e49\u7a0b\u5e8f\u542f\u52a8\u547d\u4ee4\u65f6\uff0c\u5c06dns\u540d\u79f0\u5730\u5740\u8bbe\u7f6e\u6210\u53d8\u91cf\uff0c\u7531Pod\u8d44\u6e90\u5c06\u53d8\u91cf\u503c\u4f20\u5165\u5230\u542f\u52a8\u547d\u4ee4\u4e2d\uff0c\u7a0b\u5e8f\u542f\u52a8\u65f6\u5c31\u4f1a\u7528Pod\u7684dns\u540d\u79f0\u5730\u5740\u66ff\u6362\u6389\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684IP\u5730\u5740\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},'1.\u4fee\u6539DOckerfile\u6587\u4ef6\u5185\u5bb9\n[root@binary-k8s-master1 eureka-service]\\# vim Dockerfile \nFROM 192.168.20.11/base/centos-java:v1\nRUN mkdir /data/simple-microservice/eureka-service -p\nCOPY ./target/eureka-service.jar /data/simple-microservice/eureka-service/\nRUN echo -e "#!/bin/bash \\njava -jar -Deureka.instance.hostname=${MY_POD_NAME}.eureka.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar > /data/simple-microservice/eureka-service/eureka-service.log & \\ntail -f /data/simple-microservice/eureka-service/eureka-service.log" > /data/entrypoint.sh && chmod a+x /data/entrypoint.sh\nEXPOSE 8080\nENTRYPOINT /data/entrypoint.sh\n')),(0,t.kt)("p",null,"\u542f\u52a8\u547d\u4ee4\u5355\u72ec\u62c9\u51fa\u6765\u770b\u4e00\u4e0b\uff0c",(0,t.kt)("inlineCode",{parentName:"p"},"-Deureka.instance.hostname"),"\u8fd9\u4e2a\u53c2\u6570\u8868\u793a\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4e2dhostname\u53c2\u6570\u7684\u503c\uff0c",(0,t.kt)("inlineCode",{parentName:"p"},"${MY_POD_NAME}"),"\u8fd9\u4e2a\u53d8\u91cf\u4f7f\u4ecedeployment\u8d44\u6e90\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684env\u53d8\u91cf\uff0c\u5c06Pod\u7684\u540d\u79f0\u8d4b\u7ed9MY_POD_NAME\u53d8\u91cf\uff0c\u6700\u540e\u5f15\u5165\u5230\u542f\u52a8\u547d\u4ee4\u4e2d\uff0c\u6700\u540e\u5728\u914d\u7f6e\u6587\u4ef6\u4e2dhostname\u5b57\u6bb5\u7684\u503c\u5e94\u8be5\u662f",(0,t.kt)("inlineCode",{parentName:"p"},"eureka-0.eureka-service.simple-ms")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"java -jar -Deureka.instance.hostname=${MY_POD_NAME}.eureka-service.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar\n")),(0,t.kt)("h4",{id:"423\u6784\u5efaeureka\u670d\u52a1\u7684docker\u955c\u50cf"},"4.2.3.\u6784\u5efaEureka\u670d\u52a1\u7684Docker\u955c\u50cf"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 eureka-service]\\# docker build -t  192.168.20.11/simple-microservice/eureka-service:v1 .\n\n[root@binary-k8s-master1 eureka-service]\\# docker images | grep eureka\n192.168.20.11/simp-microservice/eureka-service        v1                  1dc64fc9ba09        About a minute ago   800MB\n\n[root@binary-k8s-master1 eureka-service]\\# docker push 192.168.20.11/simple-microservice/eureka-service:v1\n")),(0,t.kt)("h4",{id:"424\u7f16\u5199eureka\u90e8\u7f72yaml\u8d44\u6e90\u6587\u4ef6"},"4.2.4.\u7f16\u5199Eureka\u90e8\u7f72YAML\u8d44\u6e90\u6587\u4ef6"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1\uff09\u521b\u5efa\u547d\u540d\u7a7a\u95f4")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"1.\u521b\u5efa\u547d\u540d\u7a7a\u95f4\n# kubectl create ns simple-ms\nnamespace/simple-ms created\n\n2.\u521b\u5efa\u8d44\u6e90\u7f16\u6392YAML\u6587\u4ef6\u5b58\u653e\u8def\u5f84\n[root@binary-k8s-master1 ~]\\# mkdir springcloud/simple-microservice-dev1/k8s/\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2\uff09\u767b\u5f55Harbor")),(0,t.kt)("p",null,"\u53ef\u4ee5\u4e0d\u5728\u6bcf\u4e00\u4e2aNode\u8282\u70b9\u4f7f\u7528docker login\u767b\u9646Harbor\u4ed3\u5e93\uff0c\u53ef\u4ee5\u5c06Harbor\u4ed3\u5e93\u7684\u8ba4\u8bc1\u4fe1\u606f\u505a\u6210secret\uff0c\u901a\u8fc7\u4f7f\u7528secret\u7684\u65b9\u5f0f\u8fde\u63a5Harbor\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 ~]\\# kubectl create secret docker-registry registry-pull-secret --docker-server=192.168.20.11 --docker-username=admin --docker-password=Harbor12345 --docker-email=admin@ctnrs.com -n simple-ms\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"3\uff09\u7f16\u5199\u8d44\u6e90YAML\u6587\u4ef6")),(0,t.kt)("p",null,"eureka\u8981\u505a\u6210\u96c6\u7fa4\u5f0f\u7684\u670d\u52a1\uff0c\u6240\u4ee5\u8981\u91c7\u7528statefulset\u63a7\u5236\u5668\u90e8\u7f72\uff0c\u5e76\u91c7\u7528headless service\u4fdd\u8bc1statefulset\u521b\u5efa\u7684pod\u540d\u79f0\u552f\u4e00\u6027\uff0c\u6700\u540e\u901a\u8fc7ingress\u5c06eureka\u670d\u52a1\u53d1\u5e03\u5728\u4e92\u8054\u7f51\u73af\u5883\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},'[root@binary-k8s-master1 k8s]\\# vim eureka-deploy.yaml \n---\n#ingress\u8d44\u6e90\napiVersion: extensions/v1beta1\nkind: Ingress           #\u7c7b\u578b\u4e3aingress\nmetadata:             #\u5b9a\u4e49\u5143\u6570\u636e\u4fe1\u606f\uff1a\u8d44\u6e90\u540d\u79f0\u3001\u8d44\u6e90\u6240\u5728\u7684\u547d\u540d\u7a7a\u95f4\n  name: eureka \n  namespace: simple-ms\nspec:\n  rules:                  #\u5b9a\u4e49ingress\u89c4\u5219\n    - host: eureka.jiangxl.com          #\u5b9a\u4e49eureka\u4f7f\u7528\u7684\u57df\u540d\n      http:                   #\u91c7\u7528http\u7c7b\u578b\u7684\u8bbf\u95ee\u65b9\u5f0f\n        paths:                  #\u5b9a\u4e49\u7a0b\u5e8f\u7684url\u8def\u5f84\n        - path: /\n          backend:                #\u9488\u5bf9\u5b9a\u4e49\u7684\u7a0b\u5e8f\u8def\u5f84\u5173\u4e8e\u5bf9\u5e94\u7684\u540e\u7aefservice\u8d44\u6e90\n            serviceName: eureka\n            servicePort: 8080\n            \n---\n#headless service\u8d44\u6e90\napiVersion: v1          \nkind: Service\nmetadata:\n  name: eureka\n  namespace: simple-ms\nspec:\n  clusterIP: None       #ClusterIP\u8d44\u6e90\u8bbe\u7f6e\u4e3aNode\u5c31\u4ee3\u8868headless\u7c7b\u578b\u7684service\n  ports:            #\u5b9a\u4e49\u66b4\u9732\u7684eureka\u7aef\u53e3\u53f7\n  - port: 8080\n    name: eureka \n  selector:           #\u6807\u7b7e\u9009\u62e9\u5668\uff0c\u5173\u8054\u540e\u7aefpod\n    project: simple\n    app: eureka\n\n---\n#statefulset\u8d44\u6e90\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: eureka\n  namespace: simple-ms\nspec:\n  replicas: 3               #\u526f\u672c\u6570\n  selector:                 #\u6807\u7b7e\u9009\u62e9\u5668\n    matchLabels:\n      project: simple         \n      app: eureka\n  serviceName: "eureka"           #service\u7684\u540d\u79f0\uff0c\u4e5f\u5c31\u662f\u5c06\u6765\u7684pod\u540d\u79f0\n  template:                 \n    metadata:\n      labels:\n        project: simple\n        app: eureka\n    spec:\n      imagePullSecrets:           #harbor\u955c\u50cf\u4ed3\u5e93\u7684\u51ed\u636e\u4fe1\u606f\n      - name: registry-pull-secret\n      containers:\n      - name: eureka\n        image: 192.168.20.11/simple-microservice/eureka-service:v1\n        ports:\n          - protocol: TCP\n            containerPort: 8080\n        env:              #\u589e\u52a0\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u53d8\u91cf\u540d\u4e3aMY_POD_NAME\uff0c\u503c\u4e3apod\u7684\u540d\u79f0\uff0c\u8fd9\u4e2a\u53d8\u91cf\u4fe1\u606f\u4f1a\u4f20\u5165dockerfile\u4e2d\n          - name: MY_POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n        resources:            #\u8d44\u6e90\u914d\u989d\n          requests:           #\u6700\u5c0f\u8d44\u6e90\u9650\u5236\uff0ccpu\u4e3a0.5\uff0c\u5185\u5b58\u4e3a256M\n            cpu: 0.5\n            memory: 256Mi\n          limits:           #\u6700\u5927\u8d44\u6e90\u9650\u5236\uff0ccpu\u4e3a1\uff0c\u5185\u5b58\u4e3a1G\n            cpu: 1          \n            memory: 1Gi\n        readinessProbe:         #\u5c31\u7eea\u6027\u5065\u5eb7\u68c0\u67e5\n          tcpSocket:          #\u4ee5tcp 8080\u7aef\u53e3\u4f5c\u4e3a\u5065\u5eb7\u68c0\u67e5\u7684\u673a\u5236\n            port: 8080  \n          initialDelaySeconds: 60     #\u5bb9\u5668\u542f\u52a860\u79d2\u540e\u8fdb\u884c\u68c0\u6d4b\n          periodSeconds: 10         #\u63a2\u6d4b\u7684\u9891\u7387\n        livenessProbe:            #\u5b58\u6d3b\u6027\u5065\u5eb7\u68c0\u67e5\n          tcpSocket:            #\u4ee5tcp 8080\u7aef\u53e3\u4f5c\u4e3a\u5065\u5eb7\u68c0\u67e5\u7684\u673a\u5236\n            port: 8080  \n          initialDelaySeconds: 60       #\u5bb9\u5668\u542f\u52a860\u79d2\u540e\u8fdb\u884c\u68c0\u67e5\n          periodSeconds: 10           #\u63a2\u6d4b\u7684\u9891\u7387\u4e3a10\u79d2\u4e00\u6b21\n')),(0,t.kt)("h4",{id:"425\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72eureka\u6ce8\u518c\u4e2d\u5fc3"},"4.2.5.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Eureka\u6ce8\u518c\u4e2d\u5fc3"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u90e8\u7f72eureka\u670d\u52a1\n[root@binary-k8s-master1 k8s]\\# kubectl apply -f eureka-deploy.yaml \n\n2.\u67e5\u770b\u90e8\u7f72\u7684\u8d44\u6e90\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get all -n simple-ms\nNAME           READY   STATUS    RESTARTS   AGE\npod/eureka-0   1/1     Running   1          12h\npod/eureka-1   1/1     Running   0          12h\npod/eureka-2   1/1     Running   0          12h\n\nNAME             TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE\nservice/eureka   ClusterIP   None         <none>        8080/TCP   13h\n\nNAME                      READY   AGE\nstatefulset.apps/eureka   3/3     13h\n\n3.\u67e5\u770beureka\u7684ingress\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get ingress -n simple-ms\nNAME     CLASS    HOSTS                ADDRESS      PORTS   AGE\neureka   <none>   eureka.jiangxl.com   10.0.0.107   80      13h\n")),(0,t.kt)("p",null,"\u9996\u5148\u5728\u672c\u5730hosts\u6587\u4ef6\u4e2d\u7ed1\u5b9aeureka\u57df\u540d\u89e3\u6790\uff0c\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165eureka.jiangxl.com\u8bbf\u95eeeureka\u670d\u52a1\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/dac8c49c10904c4591acb933a094c0d7.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h3",{id:"43\u914d\u7f6e\u5404\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u8fde\u63a5eureka\u96c6\u7fa4\u7684\u5730\u5740"},"4.3.\u914d\u7f6e\u5404\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u8fde\u63a5Eureka\u96c6\u7fa4\u7684\u5730\u5740"),(0,t.kt)("p",null,"\u5728\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u586b\u5199eureka\u96c6\u7fa4\u6240\u6709\u8282\u70b9\u7684\u670d\u52a1\u53d1\u73b0\u5730\u5740"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.gateway-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim gateway-service/src/main/resources/application-prod.yml \n\xb7\xb7\xb7\xb7\xb7\xb7\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.order-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim order-service/order-service-biz/src/main/resources/application-prod.yml \nspring:\n  datasource:\n    url: jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"3.product-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim product-service/product-service-biz/src/main/resources/application-prod.yml \nspring:\n  datasource:\n    url: jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"4.stock-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim stock-service/stock-service-biz/src/main/resources/application-prod.yml \nspring:\n  datasource:\n    url: jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n\neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    register-with-eureka: true\n    fetch-registry: true\n    service-url:\n      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka\n")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"5.portal-service\u914d\u7f6e\u6587\u4ef6")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim portal-service/src/main/resources/application-prod.yml \neureka:\n  instance:\n    prefer-ip-address: true\n  client:\n    service-url:\n      defaultZone: http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka\n    register-with-eureka: true\n    fetch-registry: true\n\xb7\xb7\xb7\xb7\xb7\xb7\n")),(0,t.kt)("h3",{id:"44\u5c06\u5404\u4e2a\u7a0b\u5e8f\u4ee3\u7801\u7f16\u8bd1\u6210\u53ef\u90e8\u7f72\u7684\u7a0b\u5e8f"},"4.4.\u5c06\u5404\u4e2a\u7a0b\u5e8f\u4ee3\u7801\u7f16\u8bd1\u6210\u53ef\u90e8\u7f72\u7684\u7a0b\u5e8f"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 simple-microservice-dev1]\\# mvn clean package -D maven.test.skip=true -P prod\n")),(0,t.kt)("h3",{id:"43\u4e2d\u90e8\u7f72gateway\u7f51\u5173\u670d\u52a1"},"4.3.\u4e2d\u90e8\u7f72Gateway\u7f51\u5173\u670d\u52a1"),(0,t.kt)("h4",{id:"431\u5c06gateway\u7a0b\u5e8f\u6253\u5305\u6210docker\u955c\u50cf"},"4.3.1.\u5c06Gateway\u7a0b\u5e8f\u6253\u5305\u6210docker\u955c\u50cf"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 gateway-service]\\# docker build -t 192.168.20.11/simple-microservice/gateway-service:v1 .\n")),(0,t.kt)("h4",{id:"432\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72gateway\u7f51\u5173\u670d\u52a1"},"4.3.2.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Gateway\u7f51\u5173\u670d\u52a1"),(0,t.kt)("p",null,"\u6240\u6709\u7a0b\u5e8f\u7684\u8d44\u6e90YAML\u6587\u4ef6\u90fd\u5b58\u653e\u5728/root/springcloud/simple-microservice-dev1/k8s\u8def\u5f84\u3002"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u7a0b\u5e8f\u7684\u8bdd\u5c31\u4e0d\u9700\u8981\u6709\u72b6\u6001\u5e94\u7528\u90e8\u7f72\u4e86\uff0c\u76f4\u63a5\u91c7\u7528deployment\u65e0\u72b6\u6001\u5e94\u7528\u90e8\u7f72\u7684\u63a7\u5236\u5668\uff0c\u5b57\u6bb5\u914d\u7f6e\u548ceureka\u670d\u52a1\u7684statefulset\u914d\u7f6e\u53c2\u6570\u51e0\u4e4e\u662f\u4e00\u6837\u7684\uff0c\u5fae\u670d\u52a1\u7684\u5404\u4e2a\u7a0b\u5e8f\u4e5f\u90fd\u91c7\u7528\u6709deployment\u63a7\u5236\u5668\u53bb\u90e8\u7f72\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u7684yaml\u6587\u4ef6\u4e5f\u53ea\u6709\u540d\u5b57\u3001\u4f7f\u7528\u7684\u955c\u50cf\u4e0d\u540c\uff0c\u5176\u4f59\u6240\u6709\u53c2\u6570\u5747\u4e00\u81f4\u3002"),(0,t.kt)("p",null,"gateway\u662f\u7f51\u5173\u670d\u52a1\uff0c\u9700\u8981\u914d\u7f6e\u4e00\u4e2aingress\u548cservice\u8d44\u6e90\uff0c\u5c06\u5176\u53d1\u5e03\u5728\u96c6\u7fa4\u4e4b\u5916\u3002"),(0,t.kt)("p",null,"\u5b57\u6bb5\u914d\u7f6e\u548cstatefulset\u7684\u4e00\u81f4\uff0c\u4e0d\u518d\u505a\u6ce8\u91ca\u4fe1\u606f"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim gateway-deploy.yaml\n---\n#ingress\u8d44\u6e90YAML\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: gateway \n  namespace: simple-ms \nspec:\n  rules:\n    - host: gateway.jiangxl.com \n      http:\n        paths:\n        - path: /\n          backend:\n            serviceName: gateway\n            servicePort: 8080\n\n---\n#service\u8d44\u6e90YAML\napiVersion: v1\nkind: Service\nmetadata:\n  name: gateway\n  namespace: simple-ms\nspec:\n  ports:\n  - port: 8080\n    name: gateway\n  selector:\n    project: simple\n    app: gateway\n\n---\n#deployment\u8d44\u6e90YAML\napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: gateway\n  namespace: simple-ms \nspec:\n  replicas: 1         #\u526f\u672c\u6570\u8bbe\u7f6e1\u4e2a\uff0c\u540e\u7eed\u518d\u52a0\n  selector:\n    matchLabels:\n      project: simple\n      app: gateway\n  template:\n    metadata:\n      labels:\n        project: simple \n        app: gateway\n    spec:\n      imagePullSecrets:\n      - name: registry-pull-secret\n      containers:\n      - name: gateway\n        image: 192.168.20.11/simple-microservice/gateway-service:v1\n        imagePullPolicy: Always\n        ports:\n          - protocol: TCP\n            containerPort: 8080 \n        resources:\n          requests:\n            cpu: 0.5\n            memory: 256Mi\n          limits:\n            cpu: 1\n            memory: 1Gi\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n")),(0,t.kt)("h4",{id:"433\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72gateway\u7f51\u5173\u670d\u52a1"},"4.3.3.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Gateway\u7f51\u5173\u670d\u52a1"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u90e8\u7f72\u7f51\u5173\u670d\u52a1\n[root@binary-k8s-master1 k8s]\\# kubectl apply -f gateway-deploy.yaml\n\n2.\u67e5\u770bgateway pod\u8d44\u6e90\u7684\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get pod -n simple-ms\nNAME                       READY   STATUS    RESTARTS   AGE\neureka-0                   1/1     Running   1          2d12h\neureka-1                   1/1     Running   0          2d12h\neureka-2                   1/1     Running   0          2d12h\ngateway-7c687f6c45-mcwpf   1/1     Running   0          2m2s\n\n3.\u67e5\u770bdeployment\u548csvc\u7684\u8d44\u6e90\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get deploy,svc -n simple-ms\nNAME                      READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/gateway   1/1     1            1           17h\n\nNAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE\nservice/eureka    ClusterIP   None         <none>        8080/TCP   2d13h\nservice/gateway   ClusterIP   10.0.0.188   <none>        8080/TCP   17h\n\n4.\u67e5\u770bgateway ingress\u8d44\u6e90\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get ingress -n simple-ms\nNAME      CLASS    HOSTS                 ADDRESS      PORTS   AGE\neureka    <none>   eureka.jiangxl.com    10.0.0.107   80      2d13h\ngateway   <none>   gateway.jiangxl.com   10.0.0.107   80      17h\n")),(0,t.kt)("h3",{id:"44\u7f16\u5199\u5feb\u901f\u90e8\u7f72\u5fae\u670d\u52a1\u5230k8s\u96c6\u7fa4\u7684\u811a\u672c"},"4.4.\u7f16\u5199\u5feb\u901f\u90e8\u7f72\u5fae\u670d\u52a1\u5230K8S\u96c6\u7fa4\u7684\u811a\u672c"),(0,t.kt)("p",null,"\u7531\u4e8e\u5fae\u670d\u52a1\u7a0b\u5e8f\u4f17\u591a\uff0c\u5e76\u4e14\u6bcf\u4e2a\u7a0b\u5e8f\u5728K8S\u96c6\u7fa4\u90e8\u7f72\u7684\u6d41\u7a0b\u4e5f\u57fa\u672c\u4e00\u6837\uff0c\u56e0\u6b64\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u90e8\u7f72\u811a\u672c\uff0c\u53ea\u8981\u51c6\u5907\u597d\u7a0b\u5e8f\u7684jar\u5305\u4ee5\u53ca\u8d44\u6e90YAML\u6587\u4ef6\u5c31\u53ef\u4ee5\u5c06\u5176\u4e00\u952e\u90e8\u7f72\u5230K8S\u96c6\u7fa4\uff0c\u5f53\u524d\u4e5f\u53ef\u4ee5\u901a\u8fc7Helm\u6765\u5b9e\u73b0\u3002"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.\u811a\u672c\u5185\u5bb9")),(0,t.kt)("p",null,"\u5b9e\u73b0\u903b\u8f91\uff1a"),(0,t.kt)("p",null,"1.\u5c06harbor\u4ed3\u5e93\u7684\u5730\u5740\u3001\u6240\u6709\u5fae\u670d\u52a1\u7684\u540d\u79f0\u3001k8s yaml\u6587\u4ef6\u7684\u8def\u5f84\u3001\u5fae\u670d\u52a1\u4ee3\u7801\u6240\u5728\u7684\u8def\u5f84\u90fd\u5b9a\u4e49\u6210\u73af\u5883\u53d8\u91cf\u3002"),(0,t.kt)("p",null,"2.\u5982\u679c\u53ea\u60f3\u90e8\u7f72\u5176\u4e2d\u4e00\u4e2a\u5fae\u670d\u52a1\u7684\u8bdd\uff0c\u901a\u8fc7\u4f4d\u7f6e\u4f20\u53c2\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\uff0c\u4e5f\u5c31\u662f\u518d\u5b9a\u4e49\u4e00\u4e2a\u5fae\u670d\u52a1\u540d\u79f0\u7684\u53d8\u91cf\uff0c\u53d8\u91cf\u503c\u4e3aKaTeX parse error: Expected '}', got 'EOF' at end of input: {1:-{service_list}}\uff0c\u5c06\u8981\u90e8\u7f72\u7684\u5fae\u670d\u52a1\u540d\u79f0\u901a\u8fc7\u4f4d\u7f6e\u4f20\u53c2\u7684\u65b9\u5f0f\uff0c\u5c06\u503c\u4f20\u5165\u5230service_list\u53d8\u91cf\u540d\u91cc\uff0c\u8986\u76d6\u539fservice_list\u53d8\u91cf\u503c\uff0c\u5b9e\u73b0\u5355\u4e2a\u5fae\u670d\u52a1\u7684\u90e8\u7f72\uff0c\u5982\u679c\u6ca1\u6709\u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\uff0c\u90a3\u4e48\u9ed8\u8ba4\u90e8\u7f72\u5168\u90e8\u7684\u5fae\u670d\u52a1\u3002"),(0,t.kt)("p",null,"3.\u8fdb\u5165\u5fae\u670d\u52a1\u4ee3\u7801\u6240\u5728\u7684\u8def\u5f84\u3002\u7136\u540e\u901a\u8fc7for\u5faa\u73af\u7684\u65b9\u5f0f\uff0c\u904d\u5386service_list\u53d8\u91cf\u4e2d\u7684\u5404\u4e2a\u5fae\u670d\u52a1\uff0c\u7136\u540e\u672c\u6b21\u5faa\u73af\u7684\u5fae\u670d\u52a1\u4ee3\u7801\u8def\u5f84\uff0c\u5224\u65ad\u662f\u5426\u6709\u5305\u542bbiz\u7684\u76ee\u5f55\uff0c\u5982\u679c\u6709biz\u76ee\u5f55\u5219\u5207\u5165\u5230biz\u76ee\u5f55\uff0c\u7136\u540e\u901a\u8fc7\u53d8\u91cf\u7684\u5f62\u5f0f\u5b9a\u4e49\u955c\u50cf\u540d\u79f0\uff0c\u6784\u5efa\u955c\u50cf\u3001\u63a8\u9001\u81f3\u955c\u50cf\u4ed3\u5e93\u3002"),(0,t.kt)("p",null,"4.\u5c06\u6700\u65b0\u6253\u5305\u597d\u7684docker\u8fdb\u5728yaml\u6587\u4ef6\u4e2d\u901a\u8fc7sed\u547d\u4ee4\u66ff\u6362\uff0c\u6700\u540e\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72\u8fd9\u4e2a\u5fae\u670d\u52a1\u3002"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"${1:-${service_list}}"),"\uff1a\u8fd9\u4e2a\u7684\u610f\u601d\u5c31\u662f\u5982\u679c",(0,t.kt)("inlineCode",{parentName:"p"},"$1"),"\u4f4d\u7f6e\u53c2\u6570\u6ca1\u6709\u4f20\u5165\u503c\uff0c\u90a3\u4e48service_list\u53d8\u91cf\u7684\u503c\u5c31\u662f",(0,t.kt)("inlineCode",{parentName:"p"},"$service_list"),"\u53d8\u91cf\u7684\u503c\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5224\u65ad\u3002"),(0,t.kt)("p",null,"\u672c\u811a\u672c\u53ef\u4ee5\u81ea\u52a8\u5316\u5b8c\u6210\u5fae\u670d\u52a1\u5230K8S\u96c6\u7fa4\u7684\u4e00\u4e2a\u90e8\u7f72\uff0c\u5305\u62ec\u7a0b\u5e8f\u7684\u7f16\u8bd1\u3001\u6253\u5305\u6210docker\u955c\u50cf\u3001\u63a8\u8350\u955c\u50cf\u5230Harbor\u4ed3\u5e93\uff0c\u6700\u540e\u5c06\u7a0b\u5e8f\u90e8\u7f72\u5230K8S\u96c6\u7fa4"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},'#!/bin/bash\nregistry_addr=192.168.20.11\nservice_list="eureka-service gateway-service order-service product-service stock-service portal-service"\nservice_list=${1:-${service_list}}      \ncurrent_dir=/root/springcloud/simple-microservice-dev1/k8s\nservice_dir=$(dirname $current_dir)\n\ncd $service_dir\n#mvn clean package -Dmaven.test.skip=true\n\nfor service in $service_list; do\n   cd $service_dir/$service\n   biz_count=`ls | grep biz | wc -l`\n   if [ $biz_count -eq 1 ];then\n      cd ${service}-biz\n   fi\n   service_name=`echo $service | awk -F- \'{print $1}\'`\n   image_name=${registry_addr}/simple-microservice/${service}:v1\n   yaml_name=${service_name}-deploy.yaml\n   docker build -t ${image_name} .\n   docker push ${image_name}\n   sed -i -r "s#(image: )(.*)#\\1$image_name#" ${current_dir}/${yaml_name}\n   kubectl apply -f ${current_dir}/${yaml_name}\ndone\n')),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.\u811a\u672c\u4f7f\u7528\u65b9\u5f0f")),(0,t.kt)("p",null,"\u6267\u884c\u672c\u811a\u672c\u524d\u63d0\u662f\u5fc5\u987b\u5148\u5c06\u7a0b\u5e8f\u90e8\u7f72\u7684YAML\u6587\u4ef6\u51c6\u5907\u597d\uff0c\u653e\u5728/root/springcloud/simple-microservice-dev1/k8s\u8def\u5f84"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"\u811a\u672c\u7684\u7528\u6cd5\uff1a\nsh deploy_k8s.sh \u5fae\u670d\u52a1\u540d\u79f0\n")),(0,t.kt)("h3",{id:"45\u4f7f\u7528\u811a\u672c\u90e8\u7f72order\u8ba2\u5355\u670d\u52a1"},"4.5.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Order\u8ba2\u5355\u670d\u52a1"),(0,t.kt)("h4",{id:"451\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6"},"4.5.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim order-deploy.yaml \napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: order\n  namespace: simple-ms \nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      project: simple\n      app: order\n  template:\n    metadata:\n      labels:\n        project: simple \n        app: order\n    spec:\n      imagePullSecrets:\n      - name: registry-pull-secret\n      containers:\n      - name: order\n        image: 192.168.20.11/simple-microservice/order-service:v1\n        imagePullPolicy: Always\n        ports:\n          - protocol: TCP\n            containerPort: 8080 \n        resources:\n          requests:\n            cpu: 0.5\n            memory: 256Mi\n          limits:\n            cpu: 1\n            memory: 1Gi\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n")),(0,t.kt)("h4",{id:"452\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72order\u8ba2\u5355\u670d\u52a1"},"4.5.2\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Order\u8ba2\u5355\u670d\u52a1"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.\u4f7f\u7528\u811a\u672c\u5c06Order\u670d\u52a1\u90e8\u7f72\u5230K8S\u96c6\u7fa4")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 k8s]\\# sh deploy_k8s.sh order-service\n\n\u6267\u884c\u5b8c\u811a\u672c\uff0corder\u7a0b\u5e8f\u7684docker\u955c\u50cf\u5df2\u7ecf\u5236\u4f5c\u597d\u5e76\u4e14\u63a8\u9001\u5230\u4e86harbor\u4ed3\u5e93\uff0c\u5df2\u7ecf\u4f7f\u7528sed\u547d\u4ee4\u5c06\u955c\u50cf\u7684\u540d\u79f0\u5728yaml\u4e2d\u66ff\u6362\u6210\u4e86\u6700\u65b0\u7684\u955c\u50cf\uff0c\u90e8\u7f72\u5230\u4e86K8S\u96c6\u7fa4\n")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/be81d4ca75f14ea1afd933b7e4f34ea5.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.\u67e5\u770b\u7a0b\u5e8f\u8d44\u6e90\u7684\u72b6\u6001")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u67e5\u770bpod\u7684\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get all -n simple-ms\nNAME                          READY   STATUS    RESTARTS   AGE\npod/eureka-0                  1/1     Running   1          2d15h\npod/eureka-1                  1/1     Running   0          2d15h\npod/eureka-2                  1/1     Running   0          2d15h\npod/gateway-8665d5d56-tx2m8   1/1     Running   0          39m\npod/order-6694f4c474-cp5d6    1/1     Running   0          35m\n\n2.\u67e5\u770bdeployment\u8d44\u6e90\u7684\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get deploy -n simple-ms\nNAME      READY   UP-TO-DATE   AVAILABLE   AGE\ngateway   1/1     1            1           21h\norder     1/1     1            1           36m\n")),(0,t.kt)("h3",{id:"46\u4f7f\u7528\u811a\u672c\u90e8\u7f72product\u5546\u54c1\u670d\u52a1"},"4.6.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Product\u5546\u54c1\u670d\u52a1"),(0,t.kt)("h4",{id:"461\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6"},"4.6.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim product-deploy.yaml \napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: product\n  namespace: simple-ms \nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      project: simple\n      app: product\n  template:\n    metadata:\n      labels:\n        project: simple \n        app: product\n    spec:\n      imagePullSecrets:\n      - name: registry-pull-secret\n      containers:\n      - name: product\n        image: 192.168.20.11/simple-microservice/product-service:v1\n        imagePullPolicy: Always\n        ports:\n          - protocol: TCP\n            containerPort: 8080 \n        resources:\n          requests:\n            cpu: 0.5\n            memory: 256Mi\n          limits:\n            cpu: 1\n            memory: 1Gi\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n\n")),(0,t.kt)("h4",{id:"462\u5728k8s\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fproduct\u5546\u54c1\u670d\u52a1"},"4.6.2.\u5728K8S\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fProduct\u5546\u54c1\u670d\u52a1"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.\u4f7f\u7528\u811a\u672c\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72product\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 k8s]\\# sh deploy_k8s.sh product-service\n")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/72e772fd74a1497188734a6e1fd3d28e.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.\u67e5\u770b\u7a0b\u5e8f\u8d44\u6e90\u7684\u72b6\u6001")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u67e5\u770bpod\u7684\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get pod -n simple-ms\nNAME                       READY   STATUS    RESTARTS   AGE\neureka-1                   1/1     Running   3          2d16h\neureka-2                   1/1     Running   2          2d16h\ngateway-8665d5d56-tx2m8    1/1     Running   2          74m\norder-6694f4c474-cp5d6     1/1     Running   4          69m\nproduct-77c8bb6847-vbxnr   1/1     Running   2          21m\n\n2.\u67e5\u770bdeployment\u8d44\u6e90\u7684\u72b6\u6001\n[root@binary-k8s-master1 k8s]\\# kubectl get deploy -n simple-ms\nNAME      READY   UP-TO-DATE   AVAILABLE   AGE\ngateway   1/1     1            1           21h\norder     1/1     1            1           72m\nproduct   1/1     1            1           24m\n")),(0,t.kt)("h3",{id:"47\u4f7f\u7528\u811a\u672c\u90e8\u7f72stock\u5e93\u5b58\u670d\u52a1"},"4.7.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Stock\u5e93\u5b58\u670d\u52a1"),(0,t.kt)("h4",{id:"471\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6"},"4.7.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim product-deploy.yaml \napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: product\n  namespace: simple-ms \nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      project: simple\n      app: product\n  template:\n    metadata:\n      labels:\n        project: simple \n        app: product\n    spec:\n      imagePullSecrets:\n      - name: registry-pull-secret\n      containers:\n      - name: product\n        image: 192.168.20.11/simple-microservice/product-service:v1\n        imagePullPolicy: Always\n        ports:\n          - protocol: TCP\n            containerPort: 8080 \n        resources:\n          requests:\n            cpu: 0.5\n            memory: 256Mi\n          limits:\n            cpu: 1\n            memory: 1Gi\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n")),(0,t.kt)("h4",{id:"472\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72stock\u5e93\u5b58\u670d\u52a1"},"4.7.2.\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72Stock\u5e93\u5b58\u670d\u52a1"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.\u4f7f\u7528\u811a\u672c\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72stock\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 k8s]\\# sh deploy_k8s.sh stock-service\n")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/34720b14a59e4d8e97e5d887beff8a9d.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.\u67e5\u770b\u7a0b\u5e8f\u8d44\u6e90\u7684\u72b6\u6001")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u67e5\u770bpod\u7684\u72b6\u6001\n[root@binary-k8s-master1 ~]\\# kubectl get pod -n simple-ms\nNAME                       READY   STATUS    RESTARTS   AGE\neureka-0                   1/1     Running   5          2d16h\neureka-1                   1/1     Running   3          2d16h\neureka-2                   1/1     Running   2          2d16h\ngateway-8665d5d56-tx2m8    1/1     Running   2          112m\norder-6694f4c474-cp5d6     1/1     Running   4          107m\nproduct-77c8bb6847-vbxnr   1/1     Running   2          59m\nstock-6cf98bb445-mxf7b     1/1     Running   0          30m\n\n2.\u67e5\u770bdeployment\u8d44\u6e90\u7684\u72b6\u6001\n[root@binary-k8s-master1 ~]\\# kubectl get deploy -n simple-ms\nNAME      READY   UP-TO-DATE   AVAILABLE   AGE\ngateway   1/1     1            1           22h\norder     1/1     1            1           108m\nproduct   1/1     1            1           60m\nstock     2/2     2            2           31m\n")),(0,t.kt)("h3",{id:"48\u4f7f\u7528\u811a\u672c\u90e8\u7f72portal\u524d\u7aef\u9996\u9875"},"4.8.\u4f7f\u7528\u811a\u672c\u90e8\u7f72Portal\u524d\u7aef\u9996\u9875"),(0,t.kt)("h4",{id:"481\u7f16\u5199\u8d44\u6e90\u90e8\u7f72yaml\u6587\u4ef6"},"4.8.1.\u7f16\u5199\u8d44\u6e90\u90e8\u7f72YAML\u6587\u4ef6"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-yaml"},"# vim portal-deploy.yaml \napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: portal \n  namespace: simple-ms \nspec:\n  rules:\n    - host: portal.jiangxl.com \n      http:\n        paths:\n        - path: /\n          backend:\n            serviceName: portal \n            servicePort: 8080\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: portal\n  namespace: simple-ms\nspec:\n  ports:\n  - port: 8080\n    name: portal \n  selector:\n    project: simple\n    app: portal\n---\napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: portal\n  namespace: simple-ms \nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      project: simple\n      app: portal\n  template:\n    metadata:\n      labels:\n        project: simple \n        app: portal\n    spec:\n      imagePullSecrets:\n      - name: registry-pull-secret\n      containers:\n      - name: portal\n        image: 192.168.20.11/simple-microservice/portal-service:v1\n        imagePullPolicy: Always\n        ports:\n          - protocol: TCP\n            containerPort: 8080 \n        resources:\n          requests:\n            cpu: 0.5\n            memory: 256Mi\n          limits:\n            cpu: 1\n            memory: 1Gi\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n\n")),(0,t.kt)("h4",{id:"482\u5728k8s\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fportal\u5b58\u670d\u52a1"},"4.8.2.\u5728K8S\u96c6\u7fa4\u4e2d\u719f\u4e0d\u719fPortal\u5b58\u670d\u52a1"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.\u4f7f\u7528\u811a\u672c\u5728K8S\u96c6\u7fa4\u4e2d\u90e8\u7f72portal\u670d\u52a1")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 k8s]\\# sh deploy_k8s.sh portal-service\n")),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/c452fabffdb24a97b0ec5dbfc8dbe6b5.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.\u67e5\u770b\u7a0b\u5e8f\u8d44\u6e90\u7684\u72b6\u6001")),(0,t.kt)("p",null,"\u5230\u6b64\u4e3a\u6b62\uff0c\u6240\u6709\u7684simple\u7535\u5546\u5e73\u53f0\u7684\u5fae\u670d\u52a1\u7a0b\u5e8f\u4ee5\u53ca\u5168\u90e8\u90e8\u7f72\u5b8c\u6bd5\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u67e5\u770b\u6240\u6709\u5fae\u670d\u52a1\u7684\u7a0b\u5e8f\n[root@binary-k8s-master1 k8s]\\# kubectl get all -n simple-ms\nNAME                           READY   STATUS    RESTARTS   AGE\npod/eureka-0                   1/1     Running   5          2d16h\npod/eureka-1                   1/1     Running   3          2d16h\npod/eureka-2                   1/1     Running   2          2d16h\npod/gateway-8665d5d56-tx2m8    1/1     Running   2          117m\npod/order-6694f4c474-cp5d6     1/1     Running   4          112m\npod/portal-d5d55b784-7kntp     1/1     Running   0          2m53s\npod/product-77c8bb6847-vbxnr   1/1     Running   2          64m\npod/stock-6cf98bb445-mxf7b     1/1     Running   0          35m\n\nNAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE\nservice/eureka    ClusterIP   None         <none>        8080/TCP   2d18h\nservice/gateway   ClusterIP   10.0.0.188   <none>        8080/TCP   22h\nservice/portal    ClusterIP   10.0.0.190   <none>        8080/TCP   2m53s\n\nNAME                      READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/gateway   1/1     1            1           22h\ndeployment.apps/order     1/1     1            1           112m\ndeployment.apps/portal    1/1     1            1           2m53s\ndeployment.apps/product   1/1     1            1           65m\ndeployment.apps/stock     1/1     1            1           35m\n\nNAME                                 DESIRED   CURRENT   READY   AGE\nreplicaset.apps/gateway-8665d5d56    1         1         1       117m\nreplicaset.apps/order-6694f4c474     1         1         1       112m\nreplicaset.apps/portal-d5d55b784     1         1         1       2m53s\nreplicaset.apps/product-77c8bb6847   1         1         1       64m\nreplicaset.apps/stock-6cf98bb445     1         1         1       35m\n\nNAME                      READY   AGE\nstatefulset.apps/eureka   3/3     2d18h\n\n2.\u67e5\u770b\u6240\u6709\u5fae\u670d\u52a1\u7684ingress\u8d44\u6e90\n[root@binary-k8s-master1 k8s]\\# kubectl get ingress -n simple-ms\nNAME      CLASS    HOSTS                 ADDRESS      PORTS   AGE\neureka    <none>   eureka.jiangxl.com    10.0.0.107   80      2d18h\ngateway   <none>   gateway.jiangxl.com   10.0.0.107   80      22h\nportal    <none>   portal.jiangxl.com    10.0.0.107   80      3m16s\n")),(0,t.kt)("h3",{id:"49\u67e5\u770beureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u5404\u4e2a\u5fae\u670d\u52a1\u7684\u4fe1\u606f"},"4.9.\u67e5\u770bEureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u5404\u4e2a\u5fae\u670d\u52a1\u7684\u4fe1\u606f"),(0,t.kt)("p",null,"\u6bcf\u4e2a\u5fae\u670d\u52a1\u7a0b\u5e8f\u5747\u5728Eureka\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u6ce8\u518c\u5b8c\u6210\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/feae01f050a440ed92aa5f948efd875f.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h3",{id:"410\u4f7f\u7528simple\u5fae\u670d\u52a1\u7535\u5546\u5e73\u53f0"},"4.10.\u4f7f\u7528simple\u5fae\u670d\u52a1\u7535\u5546\u5e73\u53f0"),(0,t.kt)("p",null,"\u52304.8\u6b65\u9aa4\u4e4b\u540e\uff0c\u6211\u4eec\u7684simple\u5fae\u670d\u52a1\u7535\u5546\u5e73\u53f0\u5df2\u7ecf\u5168\u90e8\u90e8\u7f72\u5728K8S\u96c6\u7fa4\u4e86\uff0c\u53ef\u4ee5\u5728\u672c\u673ahosts\u91cc\u7ed1\u5b9asimple\u5fae\u670d\u52a1\u7684\u57df\u540d\uff0c\u64cd\u4f5c\u7535\u5546\u5e73\u53f0\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/11d0320836a54e1b96d6e6801bdb9f8b.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,"\u8fd9\u4e2a\u5fae\u670d\u52a1\u5e73\u53f0\u7684\u80cc\u666f\u56fe\u5176\u5b9e\u662f\u4eac\u4e1c\u7684\u4e00\u5f20\u56fe\u800c\u5df2\uff0c\u662f\u4e0d\u53ef\u4ee5\u70b9\u7684\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/5de80a8717554409af8d9a14b6462e30.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,"\u53ea\u80fd\u5728\u5546\u54c1\u670d\u52a1\u4e2d\u67e5\u8be2\u80fd\u8d2d\u4e70\u7684\u5546\u54c1\uff0c\u7136\u540e\u8fdb\u884c\u8d2d\u4e70\uff0c\u6700\u540e\u5728\u8ba2\u5355\u670d\u52a1\u4e2d\u67e5\u8be2\u3002"),(0,t.kt)("p",null,"\u641c\u7d22\u5546\u54c1\u65f6\u4f1a\u8c03\u7528product\u5546\u54c1\u5fae\u670d\u52a1\uff0c\u4e0b\u5355\u540e\uff0c\u67e5\u8be2\u8ba2\u5355\u670d\u52a1\u65f6\u4f1a\u8c03\u7528order\u8ba2\u5355\u670d\u52a1\u3002"),(0,t.kt)("p",null,"\u70b9\u51fb\u67e5\u8be2\u5546\u54c1\u670d\u52a1\uff0c\u6211\u4eec\u6765\u4e0b\u5355\u4e00\u4e2a\u7f8e\u5973\u89c2\u5bdf\u4e00\u4e0b\u6548\u679c\uff0c\u4e0b\u5355\u540e\u4f1a\u63d0\u793a\u4e0b\u5355\u6210\u529f\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/2776324a762543f5a9df8fc3fc0f6e19.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,"\u70b9\u51fb\u67e5\u8be2\u8ba2\u5355\u670d\u52a1\u5c31\u53ef\u4ee5\u770b\u5230\u6211\u5417\u4e0b\u7684\u8ba2\u5355\u4e86"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/91eee91044a3497986b5f0f788a95738.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("h2",{id:"5\u57fa\u4e8ek8s\u96c6\u7fa4\u7684\u5fae\u670d\u52a1\u7684\u6269\u5bb9\u4e0e\u5347\u7ea7"},"5.\u57fa\u4e8eK8S\u96c6\u7fa4\u7684\u5fae\u670d\u52a1\u7684\u6269\u5bb9\u4e0e\u5347\u7ea7"),(0,t.kt)("h3",{id:"51\u5fae\u670d\u52a1\u7684\u6269\u5bb9"},"5.1.\u5fae\u670d\u52a1\u7684\u6269\u5bb9"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u5728\u7269\u7406\u673a\u73af\u5883\u8fd0\u884c\u65f6\uff0c\u7f51\u7ad9\u5e76\u53d1\u91cf\u9ad8\u7684\u60c5\u51b5\u4e0b\uff0c\u6269\u5bb9\u53ea\u80fd\u53bb\u8d2d\u4e70\u4e91\u670d\u52a1\u5668\uff0c\u7136\u540e\u642d\u5efa\u4e00\u5957\u4e00\u6a21\u4e00\u6837\u7684\u670d\u52a1\uff0c\u624b\u52a8\u7ec4\u6210\u8d1f\u8f7d\u5747\u8861\u96c6\u7fa4\uff0c\u589e\u52a0\u4e00\u53f0\u5176\u5b9e\u8fd8\u597d\uff0c\u5982\u679c\u8981\u589e\u52a0\u51e0\u5341\u53f0\uff0c\u592a\u8d39\u4eba\u5de5\u6210\u672c\u4e86\u3002"),(0,t.kt)("p",null,"\u5f53\u5fae\u670d\u52a1\u8fc1\u79fb\u5230K8S\u96c6\u7fa4\u4e4b\u540e\uff0c\u6269\u5bb9\u5176\u5b9e\u53d8\u5f97\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u589e\u52a0\u7a0b\u5e8fPod\u7684\u526f\u672c\u6570\u5c31\u53ef\u4ee5\u5b8c\u6210\u7a0b\u5e8f\u7684\u6269\u5bb9\u3002"),(0,t.kt)("p",null,"\u547d\u4ee4\u5982\u4e0b\uff0c\u4ee5\u6269\u5c55order\u5546\u54c1\u5fae\u670d\u52a1\u4e3a\u4f8b\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"\u5c06order\u5546\u54c1\u670d\u52a1\u7684\u526f\u672c\u6570\u8c03\u6574\u4e3a3\u4e2a\uff0c\u539f\u672c\u662f1\u4e2a\uff0c\u73b0\u5728\u6269\u5bb9\u52303\u4e2a\n[root@binary-k8s-master1 k8s]\\# kubectl scale deploy order --replicas=3 -n simple-ms\ndeployment.apps/order scaled\n\n\u53ef\u4ee5\u770b\u5230order\u8ba2\u5355\u670d\u52a1\u76ee\u524d\u5df2\u7ecf\u67093\u4e2apod\u526f\u672c\u4e86\n[root@binary-k8s-master1 ~]\\# kubectl get pod -n simple-ms\nNAME                       READY   STATUS    RESTARTS   AGE\neureka-0                   1/1     Running   1          6m15s\neureka-1                   1/1     Running   0          7m59s\neureka-2                   1/1     Running   1          9m40s\ngateway-848874fc9d-pwp9w   1/1     Running   0          48m\norder-6694f4c474-cp5d6     1/1     Running   4          3h29m\norder-6694f4c474-kh8hm     1/1     Running   0          96s\norder-6694f4c474-rg7kw     1/1     Running   0          96s\nportal-6fdcd765bd-mtq68    1/1     Running   1          24m\nproduct-784d9f77b5-rxsf2   1/1     Running   0          64m\nstock-6cf98bb445-l8gxb     1/1     Running   0          133m\n\n\u7f29\u5bb9\u4e5f\u5f88\u7b80\u5355\uff0c\u5c06order\u7684\u526f\u672c\u6570\u7f29\u51cf\u62101\u4e2a\n[root@binary-k8s-master1 k8s]\\# kubectl scale deploy order --replicas=1 -n simple-ms\ndeployment.apps/order scaled\n\n\u6210\u529f\u7f29\u51cf\u52301\u4e2a\u526f\u672c\n[root@binary-k8s-master1 ~]\\# kubectl get pod -n simple-ms\nNAME                       READY   STATUS    RESTARTS   AGE\neureka-0                   1/1     Running   1          9m24s\neureka-1                   1/1     Running   0          11m\neureka-2                   1/1     Running   1          12m\ngateway-848874fc9d-pwp9w   1/1     Running   0          51m\norder-6694f4c474-rg7kw     1/1     Running   0          4m45s\nportal-6fdcd765bd-mtq68    1/1     Running   1          27m\nproduct-784d9f77b5-rxsf2   1/1     Running   0          67m\nstock-6cf98bb445-l8gxb     1/1     Running   0          136m\n")),(0,t.kt)("h3",{id:"52\u5fae\u670d\u52a1\u7684\u5347\u7ea7"},"5.2.\u5fae\u670d\u52a1\u7684\u5347\u7ea7"),(0,t.kt)("p",null,"\u5fae\u670d\u52a1\u5728\u7269\u7406\u673a\u73af\u5883\u66f4\u65b0\u65f6\u53ea\u9700\u8981\u62c9\u53d6\u6700\u65b0\u7684\u4ee3\u7801\uff0c\u7f16\u8bd1\u6210jar\u5305\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u90e8\u7f72\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\u5fae\u670d\u52a1\u8fc1\u79fb\u5230K8S\u96c6\u7fa4\u4e4b\u540e\uff0c\u66f4\u65b0\u8fc7\u7a0b\u5c31\u53d8\u5f97\u6bd4\u8f83\u590d\u6742\u4e86\uff0c\u9996\u5148\u66f4\u65b0\u7684\u4ee3\u7801\uff0c\u7136\u540e\u7f16\u8bd1\u6210jar\u5305\uff0c\u518d\u901a\u8fc7Dockerfile\u5c06jar\u5305\u505a\u6210docker\u955c\u50cf\uff0c\u7136\u540e\u5728k8s\u96c6\u7fa4\u4e2d\u90e8\u7f72\uff0c\u5f53\u7136\u8fd9\u4e9b\u6d41\u7a0b\u53ef\u4ee5\u901a\u8fc7Jenkins\u5b9e\u73b0\u81ea\u52a8\u5316\u4e0a\u7ebf\u3002"),(0,t.kt)("h4",{id:"521\u5fae\u8c03portal\u524d\u7aef\u9996\u9875\u7684\u4ee3\u7801"},"5.2.1.\u5fae\u8c03Portal\u524d\u7aef\u9996\u9875\u7684\u4ee3\u7801"),(0,t.kt)("p",null,"\u5c06\u5e73\u53f0\u7684\u8fd9\u4e9b\u6587\u4ef6\u4fee\u6539\u6210jiangxl.com\u7684\u5185\u5bb9\u5b8c\u6210\u4e00\u6b21portal\u524d\u7aef\u9996\u9875\u7684\u5347\u7ea7"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/6fff8cf3680744d9bd8f4340015acf60.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("p",null,"\u9996\u5148\u627e\u5230\u8bb0\u5f55\u8fd9\u4e9b\u6587\u5b57\u7684\u6587\u4ef6"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/c8b660cdf01f4e92aed03aa0005f48a4.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"# vim templates/index.ftl\n# vim templates/orderList.ftl \n# vim templates/productList.ftl\n\n\u8fdb\u5165\u6587\u4ef6\u540e\u5728\u672b\u884c\u6a21\u5f0f\u8f93\u5165\uff1a\n%s/\u5bb9\u5668\u5b66\u9662 www.ctnrs.com/jiangxl.com/g\n%s/www.ctnrs.com/jiangxl.com/g\n\u7136\u540e\u5c06\u6240\u6709\u7684\u5bb9\u5668\u5b66\u9662\u7684\u6587\u5b57\u5220\u9664\n")),(0,t.kt)("h4",{id:"522\u7f16\u8bd1\u6700\u65b0\u4ee3\u7801"},"5.2.2.\u7f16\u8bd1\u6700\u65b0\u4ee3\u7801"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 simple-microservice-dev1]\\# mvn clean package -D maven.test.skip=true -P prod\n")),(0,t.kt)("h4",{id:"523\u901a\u8fc7\u811a\u672c\u5c06protal\u6700\u65b0\u4ee3\u7801\u6253\u5305\u6210\u955c\u50cf"},"5.2.3.\u901a\u8fc7\u811a\u672c\u5c06Protal\u6700\u65b0\u4ee3\u7801\u6253\u5305\u6210\u955c\u50cf"),(0,t.kt)("p",null,"\u76f4\u63a5\u4f7f\u7528\u524d\u9762\u90e8\u7f72\u7a0b\u5e8f\u7684\u811a\u672c\u5373\u53ef"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 k8s]\\# sh deploy_k8s.sh portal-service\n")),(0,t.kt)("h4",{id:"524\u5347\u7ea7k8s\u96c6\u7fa4\u4e2d\u7684protal\u5fae\u670d\u52a1"},"5.2.4.\u5347\u7ea7K8S\u96c6\u7fa4\u4e2d\u7684Protal\u5fae\u670d\u52a1"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-sh"},"[root@binary-k8s-master1 k8s]\\# kubectl -n simple-ms set image deployment portal portal=192.168.20.11/simple-microservice/portal-service:v1 --record\n")),(0,t.kt)("p",null,"\u7a0b\u5e8f\u66f4\u65b0\u5b8c\u6210\u540e\u5237\u65b0\u9875\u9762\u5c31\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u66f4\u65b0\u7684\u9875\u9762\u5185\u5bb9"),(0,t.kt)("p",null,(0,t.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASmlhbmd4bH4=,size_20,color_FFFFFF,t_70,g_se,x_16.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})))}m.isMDXComponent=!0}}]);