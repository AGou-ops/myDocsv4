"use strict";(self.webpackChunkmy_docsv_4=self.webpackChunkmy_docsv_4||[]).push([[3229],{3905:(a,t,e)=>{e.d(t,{Zo:()=>i,kt:()=>g});var n=e(67294);function o(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function r(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.push.apply(e,n)}return e}function l(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?r(Object(e),!0).forEach((function(t){o(a,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))}))}return a}function s(a,t){if(null==a)return{};var e,n,o=function(a,t){if(null==a)return{};var e,n,o={},r=Object.keys(a);for(n=0;n<r.length;n++)e=r[n],t.indexOf(e)>=0||(o[e]=a[e]);return o}(a,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(n=0;n<r.length;n++)e=r[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(o[e]=a[e])}return o}var p=n.createContext({}),c=function(a){var t=n.useContext(p),e=t;return a&&(e="function"==typeof a?a(t):l(l({},t),a)),e},i=function(a){var t=c(a.components);return n.createElement(p.Provider,{value:t},a.children)},m={inlineCode:"code",wrapper:function(a){var t=a.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(a,t){var e=a.components,o=a.mdxType,r=a.originalType,p=a.parentName,i=s(a,["components","mdxType","originalType","parentName"]),u=c(e),g=o,d=u["".concat(p,".").concat(g)]||u[g]||m[g]||r;return e?n.createElement(d,l(l({ref:t},i),{},{components:e})):n.createElement(d,l({ref:t},i))}));function g(a,t){var e=arguments,o=t&&t.mdxType;if("string"==typeof a||o){var r=e.length,l=new Array(r);l[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=a,s.mdxType="string"==typeof a?a:o,l[1]=s;for(var c=2;c<r;c++)l[c]=e[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,e)}u.displayName="MDXCreateElement"},18009:(a,t,e)=>{e.r(t),e.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=e(87462),o=(e(67294),e(3905));const r={},l="Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6",s={unversionedId:"LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6",id:"LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6",title:"Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6",description:"\u8be5\u6587\u7ae0\u6765\u6e90\uff1a",source:"@site/docs/LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6.md",sourceDirName:"LinuxBasics/Web-Servers/Jvm-Tomcat",slug:"/LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6",permalink:"/docs/LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6.md",tags:[],version:"current",frontMatter:{},sidebar:"linuxBasics",previous:{title:"Tomcat \u8c03\u4f18",permalink:"/docs/LinuxBasics/Web-Servers/Jvm-Tomcat/Tomcat \u8c03\u4f18"},next:{title:"Nginx",permalink:"/docs/category/nginx"}},p={},c=[{value:"1.JAVA\u7b80\u4ecb",id:"1java\u7b80\u4ecb",level:2},{value:"2.Tomcat\u5fc5\u5907\u77e5\u8bc6",id:"2tomcat\u5fc5\u5907\u77e5\u8bc6",level:2},{value:"3.Tomcat\u73af\u5883\u642d\u5efa",id:"3tomcat\u73af\u5883\u642d\u5efa",level:2},{value:"3.1.jdk",id:"31jdk",level:3},{value:"3.2.Tomcat",id:"32tomcat",level:3},{value:"3.3.\u542f\u52a8\u4e0e\u7ba1\u7406",id:"33\u542f\u52a8\u4e0e\u7ba1\u7406",level:3},{value:"4.Tomcat\u76ee\u5f55\u7ed3\u6784",id:"4tomcat\u76ee\u5f55\u7ed3\u6784",level:2},{value:"5.\u914d\u7f6eTomcat\u7ba1\u7406\u529f\u80fd",id:"5\u914d\u7f6etomcat\u7ba1\u7406\u529f\u80fd",level:2},{value:"6.\u90e8\u7f72jpress",id:"6\u90e8\u7f72jpress",level:2},{value:"6.1.\u6570\u636e\u5e93\u51c6\u5907",id:"61\u6570\u636e\u5e93\u51c6\u5907",level:3},{value:"6.2.\u83b7\u53d6jpress\u4ee3\u7801",id:"62\u83b7\u53d6jpress\u4ee3\u7801",level:3},{value:"7.\u663e\u793ajvm\u5185\u5b58\u4fe1\u606f",id:"7\u663e\u793ajvm\u5185\u5b58\u4fe1\u606f",level:2},{value:"8.Tomcat\u4e3b\u914d\u7f6e\u6587\u4ef6",id:"8tomcat\u4e3b\u914d\u7f6e\u6587\u4ef6",level:2},{value:"9.Tomcat\u591a\u5b9e\u4f8b\u914d\u7f6e",id:"9tomcat\u591a\u5b9e\u4f8b\u914d\u7f6e",level:2},{value:"10.Tomcat\u76d1\u63a7",id:"10tomcat\u76d1\u63a7",level:2},{value:"11.Tomcat\u5b89\u5168\u4f18\u5316",id:"11tomcat\u5b89\u5168\u4f18\u5316",level:2},{value:"12.Tomcat\u603b\u7ed3",id:"12tomcat\u603b\u7ed3",level:2}],i={toc:c};function m(a){let{components:t,...e}=a;return(0,o.kt)("wrapper",(0,n.Z)({},i,e,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6"},"Tomcat\u4e2d\u95f4\u4ef6\u65b9\u65b9\u9762\u9762\u50a8\u5907\u77e5\u8bc6"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8be5\u6587\u7ae0\u6765\u6e90\uff1a"),(0,o.kt)("p",{parentName:"blockquote"},"\u4ec5\u505a\u4e2a\u4eba\u5907\u4efd\u5b66\u4e60\u4f7f\u7528\u3002")),(0,o.kt)("h1",{id:"lnmt"},"LNMT"),(0,o.kt)("h2",{id:"1java\u7b80\u4ecb"},"1.JAVA\u7b80\u4ecb"),(0,o.kt)("p",null,"\u5e38\u89c1\u7684\u5927\u578b\u5e73\u53f0\u6709LNMP\u3001LNMP\u3001LNMT"),(0,o.kt)("p",null,"JAVA\uff1aLNMT\uff08T\u8868\u793aTomcat\u5bb9\u5668\uff0c\u653ejava\u4ee3\u7801\u7684\uff09"),(0,o.kt)("p",null," Tomcat"),(0,o.kt)("p",null," resin"),(0,o.kt)("p",null," ",(0,o.kt)("a",{parentName:"p",href:"https://so.csdn.net/so/search?q=weblogic&spm=1001.2101.3001.7020"},"weblogic"),"\uff08\u914d\u5408oracle\u6570\u636e\u5e93\u8fdb\u884c\u4f7f\u7528\uff09"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"\u73af\u5883"),(0,o.kt)("th",{parentName:"tr",align:null},"\u5904\u7406\u6a21\u578b"),(0,o.kt)("th",{parentName:"tr",align:null},"\u5904\u7406\u7528\u6237\u8bf7\u6c42\u533a\u522b"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"lnmp"),(0,o.kt)("td",{parentName:"tr",align:null},"epoll\uff08\u5f02\u6b65\uff09\u7f13\u5b58"),(0,o.kt)("td",{parentName:"tr",align:null},"\u901a\u8fc7fastcgi\u4ea4\u7ed9php-fpm\u8fdb\u884c\u5904\u7406")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"lamp"),(0,o.kt)("td",{parentName:"tr",align:null},"select\uff08\u540c\u6b65\uff09\u9047\u5230\u4e00\u4e2a\u5904\u7406\u4e00\u4e2a"),(0,o.kt)("td",{parentName:"tr",align:null},"lamp\u901a\u8fc7Apache\u6a21\u5757\u4e0ephp\u8fdb\u884c\u6c9f\u901a")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:null}),(0,o.kt)("td",{parentName:"tr",align:null})))),(0,o.kt)("p",null,"\u5f02\u6b65\u7c7b\u4f3c\u4e8e\u6709\u4e00\u5f20\u8868\uff0c\u6839\u636e\u5bf9\u5e94\u7684\u4fe1\u606f\u627e\u5bf9\u5e94\u7684\u9875\u9762"),(0,o.kt)("p",null,"\u540c\u6b65\u7c7b\u4f3c\u4e8e\u5728\u4e00\u4e2a\u76ee\u5f55\u4e2d\uff0c\u5728\u6bcf\u4e00\u4e2a\u6587\u4ef6\u4e2d\u627e\u60f3\u8981\u7684\u4fe1\u606f\n",(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502220826692.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h2",{id:"2tomcat\u5fc5\u5907\u77e5\u8bc6"},"2.Tomcat\u5fc5\u5907\u77e5\u8bc6"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"tomcat\u90e8\u7f72"),(0,o.kt)("li",{parentName:"ul"},"\u76ee\u5f55\u7ed3\u6784"),(0,o.kt)("li",{parentName:"ul"},"\u914d\u7f6etomcat\u7ba1\u7406\u529f\u80fd"),(0,o.kt)("li",{parentName:"ul"},"\u90e8\u7f72jpress"),(0,o.kt)("li",{parentName:"ul"},"tomcat\u591a\u5b9e\u4f8b"),(0,o.kt)("li",{parentName:"ul"},"tomcat\u76d1\u63a7"),(0,o.kt)("li",{parentName:"ul"},"tomcat\u5b89\u5168\u4f18\u5316"),(0,o.kt)("li",{parentName:"ul"},"Tomcat\uff1aapache-tomcat"),(0,o.kt)("li",{parentName:"ul"},"\u4e0eTomcat\u6709\u5173\u7684"),(0,o.kt)("li",{parentName:"ul"},"jvm\uff1ajava virtual machine java\u865a\u62df\u673a",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u89e3\u51b3\u4e86\u4ee3\u7801\u7684\u53ef\u79fb\u690d\u6027\uff0c1\u4efd\u4ee3\u7801\u5904\u5904\u4f7f\u7528"),(0,o.kt)("li",{parentName:"ul"},"\u5360\u7528\u5185\u5b58"))),(0,o.kt)("li",{parentName:"ul"},"jdk java development kit java\u5f00\u53d1\u73af\u5883",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"java\u547d\u4ee4"),(0,o.kt)("li",{parentName:"ul"},"jvm\u73af\u5883"))),(0,o.kt)("li",{parentName:"ul"},"jdk\u7248\u672c",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"oracle jdk \u5b98\u7f51\u4e0b\u8f7d"),(0,o.kt)("li",{parentName:"ul"},"openjdk Linux\u81ea\u5e26\uff0c\u5f00\u6e90")))),(0,o.kt)("h2",{id:"3tomcat\u73af\u5883\u642d\u5efa"},"3.Tomcat\u73af\u5883\u642d\u5efa"),(0,o.kt)("p",null,"\u670d\u52a1\u5668 192.168.81.210 ens33"),(0,o.kt)("h3",{id:"31jdk"},"3.1.jdk"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"#\u8fd9\u91cc\u7684eof\u4f7f\u7528\u5355\u5f15\u53f7\u5f15\u8d77\u6765\u662f\u4e3a\u4e86\u8ba9\u7279\u6b8a\u7b26\u53f7\u4e5f\u5199\u5165\u6587\u4ef6\n#PATH \u5b58\u653e\u547d\u4ee4\u7684\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u5c0f\u5fc3\u6539\u9519\u4e86/etc/profile\u6587\u4ef6\u90a3\u4e48\u547d\u4ee4\u5c31\u4e0d\u80fd\u4f7f\u7528\u4e86\uff0c\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u7684\u7edd\u5bf9\u8def\u5f84\u6765\u4fee\u6539/bin/vim /etc/profile\u6539\u5b8c\u540eexit\u91cd\u65b0\u8fde\u4e00\u4e0b\u5c31\u884c\n#\u5b89\u88c5jdk\u4e4b\u524d\u5148\u628a\u4e4b\u524drpm\u88c5\u7684\u5220\u6389\n\ncat >>/etc/profile <<'EOF'\nexport JAVA_HOME=/application/jdk\nexport PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$PATH\nexport CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib:$JAVA_HOME/lib/tools.jar\nEOF\n\n[root@localhost ~]\\# mkdir /application\n[root@localhost application]\\# rz -E\nrz waiting to receive.\n[root@localhost application]\\# ln -s jdk1.8.0_60/ jdk\n")),(0,o.kt)("h3",{id:"32tomcat"},"3.2.Tomcat"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost application]\\# tar xf apache-tomcat-8.5.53.tar.gz\n[root@localhost application]\\# ln -s apache-tomcat-8.5.53 tomcat\n[root@localhost application]\\# mkdir soft\n[root@localhost application]\\# mv *.gz soft/\n[root@localhost application]\\# /application/tomcat/bin/version.sh \nUsing CATALINA_BASE:   /application/tomcat\nUsing CATALINA_HOME:   /application/tomcat\nUsing CATALINA_TMPDIR: /application/tomcat/temp\nUsing JRE_HOME:        /application/jdk\nUsing CLASSPATH:       /application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-juli.jar\nServer version: Apache Tomcat/8.5.53\nServer built:   Mar 11 2020 10:01:39 UTC\nServer number:  8.5.53.0\nOS Name:        Linux\nOS Version:     3.10.0-957.el7.x86_64\nArchitecture:   amd64\nJVM Version:    1.8.0_60-b27\nJVM Vendor:     Oracle Corporation\n\n#\u5230\u6b64\u4e3a\u6b62Tomcat\u90e8\u7f72\u5b8c\u6210\n")),(0,o.kt)("h3",{id:"33\u542f\u52a8\u4e0e\u7ba1\u7406"},"3.3.\u542f\u52a8\u4e0e\u7ba1\u7406"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"startup.sh \u542f\u52a8"),(0,o.kt)("li",{parentName:"ul"},"shutdown.sh \u5173\u95ed"),(0,o.kt)("li",{parentName:"ul"},"catalina.sh \u6838\u5fc3\u811a\u672c")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'#startup.sh\u6700\u4e3b\u8981\u7684\u90e8\u5206\nPRG="$0"    #\u811a\u672c\u540d\uff1a/application/bin/startup.sh\nPRGDIR=`dirname "$PRG"`   #dirname\u7528\u4e8e\u53d6\u51fa\u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\uff0cbasename\u7528\u4e8e\u53d6\u51fa\u6587\u4ef6\u540d\nEXECUTABLE=catalina.sh\nexec "$PRGDIR"/"$EXECUTABLE" start "$@"\n#\u76f8\u5f53\u4e8e exec /application/tomcat/bin/catalina.sh start   exec\u53ef\u4ee5\u7701\u7565\n\n')),(0,o.kt)("p",null,"\u542f\u52a8\u5206\u6790"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'[root@localhost tomcat]\\# ./bin/startup.sh \nUsing CATALINA_BASE:   /application/tomcat\nUsing CATALINA_HOME:   /application/tomcat\nUsing CATALINA_TMPDIR: /application/tomcat/temp\nUsing JRE_HOME:        /application/jdk\nUsing CLASSPATH:       /application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-juli.jar\nTomcat started.\n\n[root@localhost tomcat]\\# ss -lnptu | grep java\ntcp    LISTEN     0      100      :::8080                 :::*                   users:(("java",pid=67926,fd=52))\ntcp    LISTEN     0      1      ::ffff:127.0.0.1:8005                 :::*                   users:(("java",pid=67926,fd=64))\n\n[root@localhost tomcat]\\# ps -ef | grep java\nroot      67926      1 21 14:31 pts/0    00:00:04 /application/jdk/bin/java -Djava.util.logging.config.file=/application/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -classpath /application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-juli.jar -Dcatalina.base=/application/tomcat -Dcatalina.home=/application/tomcat -Djava.io.tmpdir=/application/tomcat/temp org.apache.catalina.startup.Bootstrap start\n\n\n/application/jdk/bin/java   #java\u542f\u52a8\u7a0b\u5e8f\u7684\u76ee\u5f55\n#\u65e5\u5fd7\u7684\u914d\u7f6e\u6587\u4ef6\n-Djava.util.logging.config.file=/application/tomcat/conf/logging.properties \n-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \n-Djdk.tls.ephemeralDHKeySize=2048\n-Djava.protocol.handler.pkgs=org.apache.catalina.webresources\n-Dorg.apache.catalina.security.SecurityListener.UMASK=0027 \n-Dignore.endorsed.dirs= \n-classpath /application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-juli.jar \n#Tomcat\u7684\u90e8\u7f72\u76ee\u5f55\uff0c\u591a\u5b9e\u4f8b\u5728\u533a\u5206\u65f6\u4e3b\u8981\u770b\u8fd9\u91cc\n-Dcatalina.base=/application/tomcat \n-Dcatalina.home=/application/tomcat \n-Djava.io.tmpdir=/application/tomcat/temp org.apache.catalina.startup.Bootstrap\nstart\n\n')),(0,o.kt)("h2",{id:"4tomcat\u76ee\u5f55\u7ed3\u6784"},"4.Tomcat\u76ee\u5f55\u7ed3\u6784"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost tomcat]\\# ll\n\u603b\u7528\u91cf 124\ndrwxr-x---. 2 root root  4096 3\u6708  31 14:30 bin\n-rw-r-----. 1 root root 19318 3\u6708  11 18:06 BUILDING.txt\ndrwx------. 3 root root   254 3\u6708  31 14:31 conf\n-rw-r-----. 1 root root  5408 3\u6708  11 18:06 CONTRIBUTING.md\ndrwxr-x---. 2 root root  4096 3\u6708  31 14:05 lib\n-rw-r-----. 1 root root 57011 3\u6708  11 18:06 LICENSE\ndrwxr-x---. 2 root root   197 3\u6708  31 14:31 logs\n-rw-r-----. 1 root root  1726 3\u6708  11 18:06 NOTICE\n-rw-r-----. 1 root root  3255 3\u6708  11 18:06 README.md\n-rw-r-----. 1 root root  7136 3\u6708  11 18:06 RELEASE-NOTES\n-rw-r-----. 1 root root 16262 3\u6708  11 18:06 RUNNING.txt\ndrwxr-x---. 2 root root    30 3\u6708  31 14:05 temp\ndrwxr-x---. 7 root root    81 3\u6708  11 18:04 webapps\ndrwxr-x---. 3 root root    22 3\u6708  31 14:31 work\n\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"bin tomcat\u7ba1\u7406\u547d\u4ee4 startup.sh shutdown.sh catalina.sh"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"catalina.sh\u662fstartup.sh\u548cshutdown.sh\u90fd\u4f1a\u8c03\u7528\u7684"),(0,o.kt)("li",{parentName:"ul"},"\u4ee5\u540e\u5bf9\u4e8eTomcat\u4f18\u5316\uff08jvm\u4f18\u5316 \u8bbe\u7f6e\u6700\u5927\u5185\u5b58 \u6700\u5c0f\u5185\u5b58\uff09\u548c\u914d\u7f6e\u76d1\u63a7\u529f\u80fd"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"conf \u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u76ee\u5f55"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"server.xml\uff08\u76f8\u5f53\u4e8enginx.conf\uff09\u90fd\u662f\u4e3b\u914d\u7f6e\u6587\u4ef6"),(0,o.kt)("li",{parentName:"ul"},"web.xm \u5982\u679c\u8981\u589e\u52a0\u63d2\u67b6\u6216\u8005\u4f18\u5316\u90fd\u9700\u8981\u4fee\u6539\u6b64\u6587\u4ef6"),(0,o.kt)("li",{parentName:"ul"},"tomcat-users.xml tomcat\u7ba1\u7406\u7aef\u914d\u7f6e\u6587\u4ef6"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"webapps tomcat\u7684\u7ad9\u70b9\u76ee\u5f55\u7c7b\u4f3c\u4e8enginx\u7684html")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"log \u65e5\u5fd7\u6587\u4ef6\u5b58\u653e\u76ee\u5f55"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"catalina.out tomcat\u7684\u6838\u5fc3\u65e5\u5fd7\u6587\u4ef6\uff0c\u5b58\u653e\u7740\u4ece\u542f\u52a8\u5230\u5173\u95ed\u505a\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u6301\u7eed\u53d8\u5927\u6301\u7eed\u589e\u52a0\uff0c\u5373\u4f7f\u505a\u4e86\u65e5\u5fd7\u5207\u5272\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u4e0d\u4f1a\u7f29\u5c0f")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"catalina.2019-09-20.log catalina.out\u5207\u5272\u51fa\u6765\u7684\u65e5\u5fd7\uff0cLinux\u7cfb\u7edf\u6709\u4e00\u4e2a\u5207\u5272\u5de5\u5177logrotate\uff0cyum\u88c5\u7684\u7a0b\u5e8f\u9ed8\u8ba4\u4f1a\u91c7\u7528\u8fd9\u4e2a\u8fdb\u884c\u5207\u5272")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"localhost.2020-03-31.log tomcat\u7684\u8bbf\u95ee\u65e5\u5fd7\u548cnginx\u7684access.log\u57fa\u672c\u4e00\u81f4"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost tomcat]\\# cat /etc/log\nlogin.defs      logrotate.conf  logrotate.d/    \n[root@localhost tomcat]\\# cat /etc/logrotate.d/\nbootlog         cups            httpd           libvirtd        libvirtd.qemu   numad           psacct          sssd            wpa_supplicant  \nchrony          glusterfs       iscsiuiolog     libvirtd.lxc    mariadb         ppp             samba           syslog          yum             \n[root@localhost tomcat]\\# cat /etc/logrotate.d/syslog \n/var/log/cron\n/var/log/maillog\n/var/log/messages\n/var/log/secure\n/var/log/spooler\n{\n    missingok\n    sharedscripts\n    postrotate\n  /bin/kill -HUP `cat /var/run/syslogd.pid 2> /dev/null` 2> /dev/null || true\n    endscript\n}\n[root@localhost tomcat]\\# \n\n1234567891011121314151617181920\n")))))),(0,o.kt)("h2",{id:"5\u914d\u7f6etomcat\u7ba1\u7406\u529f\u80fd"},"5.\u914d\u7f6eTomcat\u7ba1\u7406\u529f\u80fd"),(0,o.kt)("p",null,"\u542f\u52a8\u5b8ctomcat\u70b9\u4e0b\u56fe\u6846\u4e2d\u9ed8\u8ba4\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u6ca1\u6709\u8d26\u53f7\u5bc6\u7801\uff0c\u5c1d\u8bd5\u591a\u6b21\u540e\u4f1a\u62a5401\n",(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502220909683.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u6211\u4eec\u9700\u8981\u4fee\u6539conf/tomcat-users.xml\u6587\u4ef6\u5373\u53ef\uff0c\u4e0b\u8f7d\u5728\u767b\u5f55\u65f6\u8f93\u5165username\u5f53\u65f6\u914d\u7f6e\u7684\u5373\u53ef\u6b63\u5e38\u767b\u5f55"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'[root@localhost tomcat]\\# cat conf/tomcat-users.xml\n<?xml version="1.0" encoding="UTF-8"?>\n<tomcat-users xmlns="http://tomcat.apache.org/xml"\n              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n              xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"\n              version="1.0">\n  <role rolename="admin-gui"/>\n  <role rolename="host-gui"/>\n  <role rolename="manager-gui"/>\n  <user username="admin" password="admin" roles="admin-gui,host-gui,manager-gui"/>\n</tomcat-users>\n\n#\u914d\u7f6e\u5b8c\u6210\u540e\u9700\u8981\u91cd\u542f\n\u5728\u6267\u884c./shutdown\u540e\u4e00\u5b9a\u8981\u67e5\u770b\u8fdb\u7a0b\u548c\u7aef\u53e3\u5728\u4e0d\u5728\n\n')),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502220946745.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"tomcat8.5\u4ee5\u540e\u7684\u7248\u672c\u9ed8\u8ba4\u53ea\u5141\u8bb8\u673a\u8bbf\u95ee\uff0c\u6362\u9700\u8981\u4fee\u6539webapps/manager/META-INF/context.xml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'#\u5c06value class\u7684\u884c\u6ce8\u91ca\u6389\u5373\u53ef\n[root@localhost tomcat]\\# cat webapps/manager/META-INF/context.xml\n<?xml version="1.0" encoding="UTF-8"?>\n<Context antiResourceLocking="false" privileged="true" >\n  \x3c!--<Valve className="org.apache.catalina.valves.RemoteAddrValve"\n         allow="127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1" />\n--\x3e\n  <Manager sessionAttributeValueClassNameFilter="java\\.lang\\.(?:Boolean|Integer|Long|Number|String)|org\\.apache\\.catalina\\.filters\\.CsrfPreventionFilter\\$LruCache(?:\\$1)?|java\\.util\\.(?:Linked)?HashMap"/>\n</Context>\n\n')),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/2020050222102775.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h2",{id:"6\u90e8\u7f72jpress"},"6.\u90e8\u7f72jpress"),(0,o.kt)("h3",{id:"61\u6570\u636e\u5e93\u51c6\u5907"},"6.1.\u6570\u636e\u5e93\u51c6\u5907"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"MariaDB [(none)]> create database jpress charset utf8mb4;\nQuery OK, 1 row affected (0.02 sec)\n\nMariaDB [(none)]> show create database jpress;\n+----------+--------------------------------------------------------------------+\n| Database | Create Database                                                    |\n+----------+--------------------------------------------------------------------+\n| jpress   | CREATE DATABASE `jpress` /*!40100 DEFAULT CHARACTER SET utf8mb4 */ |\n+----------+--------------------------------------------------------------------+\n1 row in set (0.00 sec)\n\nMariaDB [(none)]> grant all on jpress.* to 'jpress'@'localhost' identified by '123456';\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [(none)]> \nMariaDB [(none)]> select user,host from mysql.user;\n+--------+-----------------------+\n| user   | host                  |\n+--------+-----------------------+\n| root   | 127.0.0.1             |\n| root   | ::1                   |\n|        | localhost             |\n| jpress | localhost             |\n| root   | localhost             |\n|        | localhost.localdomain |\n| root   | localhost.localdomain |\n+--------+-----------------------+\n7 rows in set (0.00 sec)\n\nMariaDB [(none)]> grant all on jpress.* to 'jpress'@'192.168.81.%' identified by '123456';\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [(none)]> drop user ''@'localhost';\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [(none)]> \nMariaDB [(none)]> select user,host from mysql.user;\n+--------+-----------------------+\n| user   | host                  |\n+--------+-----------------------+\n| root   | 127.0.0.1             |\n| jpress | 192.168.81.%          |\n| root   | ::1                   |\n| jpress | localhost             |\n| root   | localhost             |\n|        | localhost.localdomain |\n| root   | localhost.localdomain |\n+--------+-----------------------+\n7 rows in set (0.00 sec)\n\nMariaDB [(none)]> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n\n")),(0,o.kt)("h3",{id:"62\u83b7\u53d6jpress\u4ee3\u7801"},"6.2.\u83b7\u53d6jpress\u4ee3\u7801"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://gitee.com/GalaIO/jpress/blob/master/wars/jpress-web-newest.war"},"https://gitee.com/GalaIO/jpress/blob/master/wars/jpress-web-newest.war"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221054840.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost webapps]\\# cp jpress/jpress/wars/jpress-web-newest.war  .\n[root@localhost webapps]\\# rm -rf jpress\n[root@localhost webapps]\\# rm -rf jpress.war \n[root@localhost webapps]\\# mv jpress-web-newest jpress\n[root@localhost webapps]\\# mv jpress-web-newest.war jpress.war\n[root@localhost webapps]\\# ls\ndocs  examples  host-manager  jpress  jpress.war  jpress-web-newest  manager  ROOT\n\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u4e0b\u9762\u8bbf\u95ee",(0,o.kt)("a",{parentName:"li",href:"http://192.168.81.210:8080/jpress"},"http://192.168.81.210:8080/jpress"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221126344.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221151818.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221209322.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221247953.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u6211\u4eec\u53bb\u91cd\u542f\u4e00\u4e0btomcat"),(0,o.kt)("li",{parentName:"ul"},"jpress\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8ewebapps/jpress/WEB-INF/classes\uff0c db.properties"),(0,o.kt)("li",{parentName:"ul"},"\u5b89\u88c5\u5b8c\u6210\u9ed8\u8ba4\u662f\u8fdb\u5165\u6574\u4f53\u7684\u9996\u9875\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5355\u72ec\u8d26\u53f7\u8fdb\u884c\u767b\u5f55"),(0,o.kt)("li",{parentName:"ul"},"\u7136\u540e\u53bb\u8bbf\u95ee",(0,o.kt)("a",{parentName:"li",href:"http://192.168.81.210:8080/jpress/admin"},"http://192.168.81.210:8080/jpress/admin"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221414412.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221516725.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u5199\u4e00\u7bc7\u6587\u7ae0\u5e76\u4e0a\u4f20\u56fe\u7247"),(0,o.kt)("p",{parentName:"li"},"  ",(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221538238.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"}))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5728jpress/attachment/20200331/\u76ee\u5f55\u53ef\u4ee5\u770b\u5230\u7528\u6237\u4e0a\u4f20\u7684\u9644\u4ef6")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u770b\u5230jpress\u4e2d\u7684\u8868"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'MariaDB [(none)]> show tables from jpress;\n+-------------------+\n| Tables_in_jpress  |\n+-------------------+\n| jpress_attachment |\n| jpress_comment    |\n| jpress_content    |\n| jpress_mapping    |\n| jpress_metadata   |\n| jpress_option     |\n| jpress_taxonomy   |\n| jpress_user       |\n+-------------------+\n8 rows in set (0.01 sec)\n\n\u6587\u7ae0\u5185\u5bb9\u5e94\u8be5\u662f\u5728content\u8868\u4e2d\nMariaDB [(none)]> select * from jpress.jpress_content \\G;\n*************************** 1. row ***************************\n              id: 1\n           title: \u7b2c\u4e00\u7bc7\u6d4b\u8bd5\u6587\u6863\n            text: <p>\u6c5f\u6653\u9f99\u5f88\u725b\uff01\uff01\uff01\uff01<img src="/jpress/attachment/20200331/da5a9dd62da44c3fb1cab6fe9f7b293d.jpg" alt="\u554a\u554a\u554a" width="554" height="221"></p>\n       thumbnail: NULL\n          module: article\n           style: NULL\n         user_id: 1\n       parent_id: NULL\n       object_id: NULL\n    order_number: 0\n          status: normal\n         vote_up: 0\n       vote_down: 0\n           price: 0.00\n  comment_status: NULL\n   comment_count: 0\n      view_count: 0\n         created: 2020-03-31 18:16:56\n        modified: 2020-03-31 18:16:56\n            slug: \u7b2c\u4e00\u7bc7\u6d4b\u8bd5\u6587\u6863\n            flag: NULL\n             lng: NULL\n             lat: NULL\n   meta_keywords: NULL\nmeta_description: NULL\n         remarks: NULL\n1234567891011121314151617181920212223242526272829303132333435363738394041424344\n'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5220\u9664\u8fd9\u6761\u8bb0\u5f55\uff0c\u9875\u9762\u7684\u6587\u7ae0\u8ddf\u7740\u6d88\u5931")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5728\u63d2\u56de\u53bb\uff0c\u5185\u5bb9\u8fd8\u4f1a\u5b58\u5728"))),(0,o.kt)("h2",{id:"7\u663e\u793ajvm\u5185\u5b58\u4fe1\u606f"},"7.\u663e\u793ajvm\u5185\u5b58\u4fe1\u606f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'#\u9700\u8981\u5728webapps/ROOT\u76ee\u5f55\u4e0b\u5199\u4e00\u4e2amem.jsp\u7684\u6587\u4ef6\n[root@localhost tomcat]\\# cat webapps/ROOT/mem.jsp \n<%\nRuntime rtm = Runtime.getRuntime();\nlong mm = rtm.maxMemory()/1024/1024;\nlong tm = rtm.totalMemory()/1024/1024;\nlong fm = rtm.freeMemory()/1024/1024;\n\nout.println("JVM memory detail info :<br>");\nout.println("Max memory:"+mm+"MB"+"<br>");\nout.println("Total memory:"+tm+"MB"+"<br>");\nout.println("Free memory:"+fm+"MB"+"<br>");\nout.println("Available memory can be used is :"+(mm+fm-tm)+"MB"+"<br>");\n%>\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u8bbf\u95ee",(0,o.kt)("a",{parentName:"li",href:"http://192.168.81.210:8080/mem.jsp"},"http://192.168.81.210:8080/mem.jsp"),(0,o.kt)("img",{parentName:"li",src:"https://cdn.agou-ops.cn/others/202005022216493.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"}))),(0,o.kt)("h2",{id:"8tomcat\u4e3b\u914d\u7f6e\u6587\u4ef6"},"8.Tomcat\u4e3b\u914d\u7f6e\u6587\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'#shutdown\u7aef\u53e3  \u8fde\u63a5\u5230\u8fd9\u4e2a\u7aef\u53e3\u5e76\u8f93\u5165\u540e\u9762\u7684\u6697\u53f7 SHUTDOWN \u628atomcat\u5173\u95ed\uff0c\u9700\u8981\u628a\u6697\u53f7\u7ed9\u6539\u6389\n<Server port="8005" shutdown="SHUTDOWN">\n\n[root@localhost tomcat]\\# ss -lnptu | grep java\ntcp    LISTEN     0      100      :::8080                 :::*                   users:(("java",pid=77014,fd=52))\ntcp    LISTEN     0      1      ::ffff:127.0.0.1:8005                 :::*                   users:(("java",pid=77014,fd=62))\n[root@localhost tomcat]\\# telnet 127.0.0.1 8005\nTrying 127.0.0.1...\nConnected to 127.0.0.1.\nEscape character is \'^]\'.\nSHUTDOWN\nConnection closed by foreign host.\n[root@localhost tomcat]\\# ss -lnptu | grep java\n\n\n#tomcat\u7ba1\u7406\u7aef\uff0c\u4e00\u822c\u4e0d\u5f00\u653e\uff0c\u4ee5\u514d\u7528\u6237\u770b\u5230\u914d\u7f6e\n<GlobalNamingResources>\n    \x3c!-- Editable user database that can also be used by\n         UserDatabaseRealm to authenticate users\n    --\x3e\n    <Resource name="UserDatabase" auth="Container"\n              type="org.apache.catalina.UserDatabase"\n              description="User database that can be updated and saved"\n              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"\n              pathname="conf/tomcat-users.xml" />\n</GlobalNamingResources>\n\n#\u8bbe\u7f6etomcat\u7684\u7aef\u53e3\uff0cweb\u529f\u80fd\uff0credirectPort\u662f\u8868\u793a\u542f\u7528\u4e86https\u540e\u7684\u7aef\u53e3\u4e5f\u5c31\u662f443\n<Connector port="8080" protocol="HTTP/1.1"\n               connectionTimeout="20000"\n               redirectPort="8443" />\n\n\n#tomcat\u7ebf\u7a0b\u6570\uff0cmaxThreads\u8868\u793a\u5728tomcat\u5fd9\u7684\u65f6\u5019\u6700\u591a\u5904\u7406\u591a\u5c11\u4e2a\u7ebf\u7a0b\uff0cminSpareThreads\u8868\u793a\u6b63\u5e38\u60c5\u51b5\u4e0btomcat\u5904\u7406\u7ebf\u7a0b\u7684\u6570\u91cf\n     <Executor name="tomcatThreadPool" namePrefix="catalina-exec-"\n        maxThreads="150" minSpareThreads="4"/>\n\n\n#8009 ajp \u5de5\u4f5c\u65b9\u5f0f\uff1a\u4e0eApache\u914d\u5408\n<Connector protocol="AJP/1.3"\n               address="::1"\n               port="8009"\n               redirectPort="8443" />\n               \n\n#host  \u865a\u62df\u4e3b\u673a\u90e8\u5206\n#host name\uff1a\u914d\u7f6e\u57df\u540d\n#appBase\uff1a\u7ad9\u70b9\u76ee\u5f55\n#uppackWARS\uff1a\u662f\u5426\u81ea\u52a8\u89e3\u538bwar\u5305\uff0ctrue\u5c31\u662f\u89e3\u538b\uff0cfalse\u5c31\u662f\u4e0d\u89e3\u538b\n#autoDeploy\uff1a\u662f\u5426\u81ea\u52a8\u90e8\u7f72\u628a\u78c1\u76d8\u4e2d\u7684\u6254\u5230jvm\u4e2d\n <Host name="localhost"  appBase="webapps"\n            unpackWARs="true" autoDeploy="true">\n        \x3c!--<Context docBase="/application/tomcat/webapps/" path="" reloadable="false">\n        </Context>--\x3e\n\n        \x3c!-- SingleSignOn valve, share authentication between web applications\n             Documentation at: /docs/config/valve.html --\x3e\n        \x3c!--\n        <Valve className="org.apache.catalina.authenticator.SingleSignOn" />\n        --\x3e\n\n        \x3c!-- Access log processes all example.\n             Documentation at: /docs/config/valve.html\n             Note: The pattern used is equivalent to using pattern="common" --\x3e\n        <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"\n               prefix="localhost_access_log" suffix=".txt"\n               pattern="%h %l %u %t &quot;%r&quot; %s %b" />\n\n      </Host>\n      \n      \n#tomcat\u8bbf\u95ee\u65e5\u5fd7\u7684\u683c\u5f0f\n <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"\n               prefix="localhost_access_log" suffix=".txt"\n               pattern="%h %l %u %t &quot;%r&quot; %s %b" />\n\n')),(0,o.kt)("h2",{id:"9tomcat\u591a\u5b9e\u4f8b\u914d\u7f6e"},"9.Tomcat\u591a\u5b9e\u4f8b\u914d\u7f6e"),(0,o.kt)("p",null,"\u4e00\u53f0\u4e3b\u673a\u53ef\u80fd\u4f1a\u8dd1\u591a\u4e2atomcat"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost soft]\\# tar -xf apache-tomcat-8.5.53.tar.gz \n[root@localhost soft]\\# ls\napache-tomcat-8.5.53  apache-tomcat-8.5.53.tar.gz  jdk-8u60-linux-x64.tar.gz\n[root@localhost soft]\\# mv apache-tomcat-8.5.53 ../tomcat_8081\n[root@localhost soft]\\# tar -xf apache-tomcat-8.5.53.tar.gz \n[root@localhost soft]\\# mv apache-tomcat-8.5.53 ../tomcat_8082\n\n[root@localhost application]\\# sed -ri 's/8080/8081/g' tomcat_8081/conf/server.xml \n[root@localhost application]\\# sed -ri 's/8005/8006/g' tomcat_8081/conf/server.xml \n[root@localhost application]\\# sed -ri 's/8009/8010/g' tomcat_8081/conf/server.xml\n[root@localhost application]\\# sed -ri 's/8080/8082/g' tomcat_8082/conf/server.xml \n[root@localhost application]\\# sed -ri 's/8005/8007/g' tomcat_8082/conf/server.xml \n[root@localhost application]\\# sed -ri 's/8009/8011/g' tomcat_8082/conf/server.xml\n\n[root@localhost application]\\# tomcat_8081/bin/startup.sh \n[root@localhost application]\\# tomcat_8082/bin/startup.sh \n\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/20200502221730623.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"#\u4e66\u5199tomcat\u76f8\u5173\u811a\u672c\u65f6\uff08\u542f\u52a8 \u91cd\u542f \u76d1\u63a7\uff09\u90fd\u6709\u7cbe\u786e\u8fc7\u6ee4\nps aux | grep java | grep tomcat_8081\n")),(0,o.kt)("h2",{id:"10tomcat\u76d1\u63a7"},"10.Tomcat\u76d1\u63a7"),(0,o.kt)("p",null,"\u76d1\u63a7\u65b9\u5f0f"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u7b80\u5355\u547d\u4ee4"),(0,o.kt)("li",{parentName:"ul"},"\u73b0\u6210\u811a\u672c"),(0,o.kt)("li",{parentName:"ul"},"\u901a\u8fc7zabbix\u81ea\u5b9a\u4e49\u76d1\u63a7",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u81ea\u5b9a\u4e49\u76d1\u63a7 \u53ea\u8981\u662f\u7528\u547d\u4ee4\u80fd\u5f97\u5230\u7684\u4e1c\u897f\u90fd\u80fd\u53bb\u76d1\u63a7"),(0,o.kt)("li",{parentName:"ul"},"\u901a\u8fc7jmx \u5bf9java\u8fdb\u884c\u76d1\u63a7"))),(0,o.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u76d1\u63a7",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u901a\u8fc7ipmi \u76d1\u63a7\u786c\u4ef6\u7684"),(0,o.kt)("li",{parentName:"ul"},"\u901a\u8fc7snmp \u76d1\u63a7\u7f51\u7edc\u8bbe\u5907\u7684\uff0c\u53ea\u8981\u652f\u6301snmp\u90fd\u80fd\u76d1\u63a7")))),(0,o.kt)("p",null,"java\u81ea\u5e26\u7684\u76d1\u63a7\u547d\u4ee4"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"jps \u5bfc\u51fajava\u76f8\u5173\u7684\u8fdb\u7a0b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u683c\u5f0f\uff1ajps -lvm")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u53c2\u6570\u9009\u9879\uff1a-lvm\u6700\u8be6\u7ec6"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost ~]\\# jps -lvm\n7457 org.apache.catalina.startup.Bootstrap start start -Djava.util.logging.config.file=/application/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/application/tomcat -Dcatalina.home=/application/tomcat -Djava.io.tmpdir=/application/tomcat/temp\n7525 org.apache.catalina.startup.Bootstrap start start -Djava.util.logging.config.file=/application/tomcat_8082/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/application/tomcat_8082 -Dcatalina.home=/application/tomcat_8082 -Djava.io.tmpdir=/application/tomcat_8082/temp\n9144 sun.tools.jps.Jps -lvm -Denv.class.path=.:/application/jdk/lib:/application/jdk/jre/lib:/application/jdk/lib/tools.jar -Dapplication.home=/application/jdk1.8.0_60 -Xms8m\n7482 org.apache.catalina.startup.Bootstrap start start -Djava.util.logging.config.file=/application/tomcat_8081/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/application/tomcat_8081 -Dcatalina.home=/application/tomcat_8081 -Djava.io.tmpdir=/application/tomcat_8081/temp\n\n123456\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"jmap \u5bfc\u51fajvm\u4fe1\u606f\uff0c\u5e38\u7528\u4e8e\u81ea\u5b9a\u4e49\u76d1\u63a7")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u683c\u5f0f\uff1ajmap pid")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u53c2\u6570\uff1a-heap"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost ~]\\# jmap -heap 7457\nAttaching to process ID 7457, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.60-b23\n\nusing thread-local object allocation.\nMark Sweep Compact GC\n\nHeap Configuration:\n   MinHeapFreeRatio         = 40\n   MaxHeapFreeRatio         = 70\n   MaxHeapSize              = 255852544 (244.0MB)\n   NewSize                  = 5570560 (5.3125MB)\n   MaxNewSize               = 85262336 (81.3125MB)\n   OldSize                  = 11206656 (10.6875MB)\n   NewRatio                 = 2\n   SurvivorRatio            = 8\n   MetaspaceSize            = 21807104 (20.796875MB)\n   CompressedClassSpaceSize = 1073741824 (1024.0MB)\n   MaxMetaspaceSize         = 17592186044415 MB\n   G1HeapRegionSize         = 0 (0.0MB)\n\nHeap Usage:     #\u76d1\u63a7\u7684\u8bdd\u5173\u6ce8\u8fd9\u4e00\u5217\nNew Generation (Eden + 1 Survivor Space):\n   capacity = 12779520 (12.1875MB)\n   used     = 11689352 (11.147834777832031MB)\n   free     = 1090168 (1.0396652221679688MB)\n   91.46941356169872% used\nEden Space:       #\u76d1\u63a7\u7684\u8bdd\u5173\u6ce8\u8fd9\u4e00\u5217\n   capacity = 11403264 (10.875MB)\n   used     = 11059616 (10.547271728515625MB)\n   free     = 343648 (0.327728271484375MB)\n   96.98640669899426% used\nFrom Space:         #\u76d1\u63a7\u7684\u8bdd\u5173\u6ce8\u8fd9\u4e00\u5217\n   capacity = 1376256 (1.3125MB)\n   used     = 629736 (0.6005630493164062MB)\n   free     = 746520 (0.7119369506835938MB)\n   45.75718470982143% used\nTo Space:       #\u76d1\u63a7\u7684\u8bdd\u5173\u6ce8\u8fd9\u4e00\u5217\n   capacity = 1376256 (1.3125MB)\n   used     = 0 (0.0MB)\n   free     = 1376256 (1.3125MB)\n   0.0% used\ntenured generation:       #\u76d1\u63a7\u7684\u8bdd\u5173\u6ce8\u8fd9\u4e00\u5217\n   capacity = 28164096 (26.859375MB)\n   used     = 18313224 (17.46485137939453MB)\n   free     = 9850872 (9.394523620605469MB)\n   65.02329774760035% used\n\n21146 interned Strings occupying 1882520 bytes.\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"jstatck \u5bfc\u51fajava\u7684\u8fdb\u7a0b\u4fe1\u606f\uff0c\u5e38\u7528\u4e8ejava\u7a0b\u5e8f\u6545\u969c\uff0c\u9700\u8981\u5bfc\u51fa\u7ebf\u7a0b\u4fe1\u606f\u4e0e\u5f00\u53d1\u4e00\u8d77\u7814\u7a76")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u683c\u5f0f\uff1ajstack -l pid"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[root@localhost ~]\\#  jstack -l 7457\n1\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"tomcat\u6545\u969c\u6848\u4f8b\uff1a\u7cfb\u7edf\u8d1f\u8f7d\u9ad8\uff0ctomcat\u5360\u7528CPU\u8f83\u9ad8"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"1.jps/top/htop\u7cbe\u786e\u786e\u5b9a\u54ea\u4e2ajava\u8fdb\u7a0b\u5bfc\u81f4"),(0,o.kt)("li",{parentName:"ul"},"2.jstack\u5bfc\u51fajava\u7ebf\u7a0b"),(0,o.kt)("li",{parentName:"ul"},"3.catalina.out\u65e5\u5fd7\u5206\u6790"),(0,o.kt)("li",{parentName:"ul"},"4.jmap\u5bfc\u51fajvm\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7mat\u5de5\u5177\u8fdb\u884c\u5206\u6790"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"tomcat\u76d1\u63a7")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u81ea\u5b9a\u4e49\u76d1\u63a7\uff1a\u76f4\u63a5\u5728tomcat\u670d\u52a1\u5668\u4e0a\u5199\u597d\u811a\u672c\uff0c\u5728zabbix\u914d\u7f6e\u6587\u4ef6\u5199\u597d\u5c31\u884c")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u9996\u5148\u9700\u8981\u5728zabiix\u670d\u52a1\u7aef\u5b89\u88c5zabbix-java-gateway\u7136\u540e\u5728tomcat\u670d\u52a1\u5668\u5f00\u542f\u76d1\u63a7\u529f\u80fd")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"tomcat\u5f00\u542fjmx\u76d1\u63a7\u529f\u80fd"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'#\u4fee\u6539bin/catalina.sh\n[root@localhost tomcat]\\# vim bin/catalina.sh\n#\u6ce8\u610f\u4e0d\u80fd\u5206\u884c\u5199\u4f1a\u62a5\u9519\u627e\u4e0d\u5230\u547d\u4ee4\uff0c\u8981\u5199\u5728\u4e00\u884c\u4e0a\nCATALINA_OPTS="$CATALINA_OPTS"\n-Dcom.sun.management.jmxremote\n-Dcom.sun.management.jmxremote.port=12345\n-Dcom.sun.management.jmxremote.authenticate=false\n-Dcom.sun.management.jxmremote.ssl=false\n-Djava.rmi.server.hostname="192.168.81.210"\n#\u6b63\u786e\u5199\u6cd5\nCATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=12345 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jxmremote.ssl=false -Djava.rmi.server.hostname=192.168.81.210"\n\n\n#\u8bf4\u660e\nCATALINA_OPTS="$CATALINA_OPTS"    #\u4fee\u6539tomcat\u542f\u52a8\u53c2\u6570\n-Dcom.sun.management.jmxremote    #\u5f00\u542ftomcat\u8fdc\u7a0b\u7ba1\u7406\u529f\u80fd\n-Dcom.sun.management.jmxremote.port=12345 #\u8fdc\u7a0b\u7ba1\u7406\u529f\u80fd\uff0c\u9664\u4e8612345\u7aef\u53e3\uff0c\u8fd8\u4f1a\u751f\u62102\u4e2a\u968f\u673a\u7aef\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u653e\u6240\u6709\u7aef\u53e3\nDcom.sun.management.jmxremote.authenticat=false     #\u662f\u5426\u5728\u76d1\u63a7\u65f6\u9700\u8981\u8ba4\u8bc1\n-Dcom.sun.management.jmxremote.ssl=false  #\u662f\u5426\u5f00\u542fssl\u8fde\u63a5\n-Djava.rmi.server.hostname="192.168.81.210"   #\u8bbe\u7f6etomcat\u6240\u5728\u670d\u52a1\u5668\u7684ip\n\n\u914d\u7f6e\u5b8c\u6210\u540e\u91cd\u542ftomcat\u5373\u53ef\n\u4f7f\u7528ps\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u8f93\u51fa\u7684\u4fe1\u606f\u591a\u4e86\u6211\u4eec\u5199\u5165\u7684\u51e0\u884c\n[root@localhost tomcat]\\# ps aux | grep java\nroot      17786  5.7 10.6 2306592 105860 pts/1  Sl   15:52   0:08 /application/jdk/bin/java\n-Djava.util.logging.config.file=/application/tomcat/conf/logging.properties \n-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \n-Djdk.tls.ephemeralDHKeySize=2048 \n-Djava.protocol.handler.pkgs=org.apache.catalina.webresources\n-Dorg.apache.catalina.security.SecurityListener.UMASK=0027\n-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=12345\n-Dcom.sun.management.jmxremote.authenticate=false \n-Dcom.sun.management.jxmremote.ssl=false \n-Djava.rmi.server.hostname=192.168.81.210 \n-Dignore.endorsed.dirs= \n-classpath /application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-juli.jar \n-Dcatalina.base=/application/tomcat \n-Dcatalina.home=/application/tomcat \n-Djava.io.tmpdir=/application/tomcat/temp org.apache.catalina.startup.Bootstrap start\n\n\u4f7f\u7528ss/netstat \u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u591a\u51fa\u5566\u7684\u4e09\u4e2a\u7aef\u53e3\n[root@localhost tomcat]\\# ss -lnptu | grep java\ntcp    LISTEN     0      100      :::8080                 :::*                   users:(("java",pid=17786,fd=56))\n#\u6211\u4eec\u5236\u5b9a\u7684\ntcp    LISTEN     0      50       :::12345                :::*                   users:(("java",pid=17786,fd=22))\n#\u968f\u673a\u76841\ntcp    LISTEN     0      50       :::46272                :::*                   users:(("java",pid=17786,fd=21))\n#\u968f\u673a\u76842\ntcp    LISTEN     0      50       :::46081                :::*                   users:(("java",pid=17786,fd=24))\ntcp    LISTEN     0      1      ::ffff:127.0.0.1:8005                 :::*                   users:(("java",pid=17786,fd=65))\n\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152\n'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u4f7f\u7528jsconsole\u8fdb\u884c\u6d4b\u8bd5"))),(0,o.kt)("h2",{id:"11tomcat\u5b89\u5168\u4f18\u5316"},"11.Tomcat\u5b89\u5168\u4f18\u5316"),(0,o.kt)("p",null,"tomcat\u5b89\u5168\u7ba1\u7406\u89c4\u8303"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u4fee\u65398005\u7aef\u53e3\u7684\u6697\u53f7"),(0,o.kt)("li",{parentName:"ul"},"\u4fee\u65398009\u7aef\u53e3"),(0,o.kt)("li",{parentName:"ul"},"\u7981\u7528\u7ba1\u7406\u7aef"),(0,o.kt)("li",{parentName:"ul"},"\u964d\u6743\u542f\u52a8\uff0ctomcat\u4e00\u822c\u4ee5\u666e\u901a\u7528\u6237\u8fdb\u884c\u7ba1\u7406"),(0,o.kt)("li",{parentName:"ul"},"\u5173\u95ed\u6587\u4ef6\u5217\u8868\u529f\u80fd"),(0,o.kt)("li",{parentName:"ul"},"\u7248\u672c\u4fe1\u606f\u9690\u85cf\uff0ctomcat\u62a5\u9519\u540e\u4f1a\u6709\u7248\u672c\u63d0\u793a\uff0c\u5b9a\u4e49\u4e00\u4e2aerror-code"),(0,o.kt)("li",{parentName:"ul"},"server header\u91cd\u5199\uff0c\u4fee\u6539http\u54cd\u5e94\u5934\u4e2d\u7684\u670d\u52a1\u7aef\u540d\u79f0"),(0,o.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e\u8bbf\u95ee\u9650\u5236"),(0,o.kt)("li",{parentName:"ul"},"\u811a\u672c\u6743\u9650\u8bbe\u7f6e"),(0,o.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u8bbe\u7f6e")),(0,o.kt)("h2",{id:"12tomcat\u603b\u7ed3"},"12.Tomcat\u603b\u7ed3"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"tomcat\u6545\u969c\u6848\u4f8b"),(0,o.kt)("li",{parentName:"ul"},"tomcat\u5b89\u5168\u4f18\u5316"),(0,o.kt)("li",{parentName:"ul"},"tomcat\u76ee\u5f55 \u914d\u7f6e"),(0,o.kt)("li",{parentName:"ul"},"\u591a\u5b9e\u4f8b"),(0,o.kt)("li",{parentName:"ul"},"\u76d1\u63a7")))}m.isMDXComponent=!0}}]);