"use strict";(self.webpackChunkmy_docsv_4=self.webpackChunkmy_docsv_4||[]).push([[4346],{3905:(e,n,t)=>{t.d(n,{Zo:()=>k,kt:()=>m});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),u=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},k=function(e){var n=u(e.components);return r.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},i=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,k=l(e,["components","mdxType","originalType","parentName"]),i=u(t),m=a,d=i["".concat(c,".").concat(m)]||i[m]||p[m]||o;return t?r.createElement(d,s(s({ref:n},k),{},{components:t})):r.createElement(d,s({ref:n},k))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,s=new Array(o);s[0]=i;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var u=2;u<o;u++)s[u]=t[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}i.displayName="MDXCreateElement"},77415:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var r=t(87462),a=(t(67294),t(3905));const o={},s=void 0,l={unversionedId:"CloudNative/k8s/Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4",id:"CloudNative/k8s/Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4",title:"Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4",description:"1.\u96c6\u7fa4\u7c7b\u578b",source:"@site/docs/CloudNative/k8s/Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4.md",sourceDirName:"CloudNative/k8s",slug:"/CloudNative/k8s/Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4",permalink:"/docs/CloudNative/k8s/Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4",draft:!1,editUrl:"https://github.com/AGou-ops/myDocsv4/edit/main/docs/CloudNative/k8s/Kubeadm \u5feb\u901f\u90e8\u7f72k8s\u96c6\u7fa4.md",tags:[],version:"current",frontMatter:{},sidebar:"cloudNative",previous:{title:"\u5176\u4ed6\u5b9e\u6218\u6848\u4f8b",permalink:"/docs/CloudNative/k8s/\u5b9e\u6218\u6848\u4f8b/\u5176\u4ed6\u5b9e\u6218\u6848\u4f8b"},next:{title:"Kubernetes REST API",permalink:"/docs/CloudNative/k8s/Kubernetes REST API"}},c={},u=[{value:"1.\u96c6\u7fa4\u7c7b\u578b",id:"1\u96c6\u7fa4\u7c7b\u578b",level:2},{value:"2.\u96c6\u7fa4\u5b89\u88c5\u65b9\u5f0f",id:"2\u96c6\u7fa4\u5b89\u88c5\u65b9\u5f0f",level:2},{value:"3.\u73af\u5883\u89c4\u5212",id:"3\u73af\u5883\u89c4\u5212",level:2},{value:"4.\u7cfb\u7edf\u521d\u59cb\u5316",id:"4\u7cfb\u7edf\u521d\u59cb\u5316",level:2},{value:"4.1.\u68c0\u67e5\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c",id:"41\u68c0\u67e5\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c",level:3},{value:"4.2.\u4e3b\u673a\u540d\u89e3\u6790",id:"42\u4e3b\u673a\u540d\u89e3\u6790",level:3},{value:"4.3.\u65f6\u95f4\u540c\u6b65",id:"43\u65f6\u95f4\u540c\u6b65",level:3},{value:"4.4.\u7981\u7528\u9632\u706b\u5899",id:"44\u7981\u7528\u9632\u706b\u5899",level:3},{value:"4.5.\u7981\u7528selinux",id:"45\u7981\u7528selinux",level:3},{value:"4.6.\u7981\u7528swapp\u5206\u533a",id:"46\u7981\u7528swapp\u5206\u533a",level:3},{value:"4.7.\u4fee\u6539linux\u5185\u6838\u53c2\u6570",id:"47\u4fee\u6539linux\u5185\u6838\u53c2\u6570",level:3},{value:"4.8.\u914d\u7f6eipvs\u529f\u80fd",id:"48\u914d\u7f6eipvs\u529f\u80fd",level:3},{value:"4.9.\u91cd\u542f\u670d\u52a1\u5668",id:"49\u91cd\u542f\u670d\u52a1\u5668",level:3},{value:"5.\u90e8\u7f72kubernetes\u96c6\u7fa4",id:"5\u90e8\u7f72kubernetes\u96c6\u7fa4",level:2},{value:"5.1.\u6240\u6709\u8282\u70b9\u90e8\u7f72docker",id:"51\u6240\u6709\u8282\u70b9\u90e8\u7f72docker",level:3},{value:"5.2.\u6240\u6709\u8282\u70b9\u5b89\u88c5kubernetes\u7ec4\u4ef6",id:"52\u6240\u6709\u8282\u70b9\u5b89\u88c5kubernetes\u7ec4\u4ef6",level:3},{value:"5.3.\u6240\u6709\u8282\u70b9\u51c6\u5907\u96c6\u7fa4\u7ec4\u4ef6\u955c\u50cf\u5305",id:"53\u6240\u6709\u8282\u70b9\u51c6\u5907\u96c6\u7fa4\u7ec4\u4ef6\u955c\u50cf\u5305",level:3},{value:"5.5.node\u8282\u70b9\u521d\u59cb\u5316",id:"55node\u8282\u70b9\u521d\u59cb\u5316",level:3},{value:"6.\u90e8\u7f72\u4e00\u4e2anginx\u5bb9\u5668\u9a8c\u8bc1\u96c6\u7fa4\u53ef\u7528\u6027",id:"6\u90e8\u7f72\u4e00\u4e2anginx\u5bb9\u5668\u9a8c\u8bc1\u96c6\u7fa4\u53ef\u7528\u6027",level:2},{value:"7.k8s\u547d\u4ee4\u5f00\u542ftab\u529f\u80fd",id:"7k8s\u547d\u4ee4\u5f00\u542ftab\u529f\u80fd",level:2},{value:"8.\u90e8\u7f72rancher\u7ba1\u7406k8s",id:"8\u90e8\u7f72rancher\u7ba1\u7406k8s",level:2}],k={toc:u};function p(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"1\u96c6\u7fa4\u7c7b\u578b"},"1.\u96c6\u7fa4\u7c7b\u578b"),(0,a.kt)("p",null,"kubernetes\u96c6\u7fa4\u5927\u4f53\u4e0a\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u4e3b\u591a\u4ece\u548c\u591a\u4e3b\u591a\u4ece"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4e00\u4e3b\u591a\u4ece\uff1a\u4e00\u53f0master\u8282\u70b9\u548c\u591a\u53f0node\u8282\u70b9\uff0c\u642d\u5efa\u7b80\u5355\uff0c\u4f46\u662f\u6709\u5355\u673a\u6545\u969c\u98ce\u9669\uff0c\u9002\u5408\u7528\u4e8e\u6d4b\u8bd5\u73af\u5883"),(0,a.kt)("li",{parentName:"ul"},"\u591a\u4e3b\u591a\u4ece\uff1a\u591a\u53f0master\u8282\u70b9\u548c\u591a\u53f0node\u8282\u70b9\uff0c\u642d\u5efa\u9ebb\u70e6\uff0c\u5b89\u5168\u6027\u9ad8\uff0c\u9002\u5408\u7528\u4e8e\u751f\u4ea7\u73af\u5883")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072119_61ce3eef1c8d185797.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_\u5176\u4ed6"})),(0,a.kt)("h2",{id:"2\u96c6\u7fa4\u5b89\u88c5\u65b9\u5f0f"},"2.\u96c6\u7fa4\u5b89\u88c5\u65b9\u5f0f"),(0,a.kt)("p",null,"kubernetes\u6709\u591a\u79cd\u90e8\u7f72\u65b9\u5f0f\uff0c\u76ee\u524d\u4e3b\u6d41\u7684\u65b9\u5f0f\u6709kubeadm\u3001minikube\u3001\u4e8c\u8fdb\u5236\u5b89\u88c5"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"minikube\uff1a\u5feb\u901f\u642d\u5efa\u5355\u8282\u70b9\u7684kubernetes\u5de5\u5177"),(0,a.kt)("li",{parentName:"ul"},"kubeadm\uff1a\u5feb\u901f\u642d\u5efakubernetes\u96c6\u7fa4\u7684\u5de5\u5177"),(0,a.kt)("li",{parentName:"ul"},"\u4e8c\u8fdb\u5236\u5305\uff1a\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u662f\u5355\u72ec\u7684\u4e8c\u8fdb\u5236\u5305\uff0c\u4f9d\u6b21\u53bb\u5b89\u88c5\uff0c\u53ef\u4ee5\u5bf9kubernetes\u66f4\u52a0\u7406\u89e3")),(0,a.kt)("h2",{id:"3\u73af\u5883\u89c4\u5212"},"3.\u73af\u5883\u89c4\u5212"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"IP\u5730\u5740"),(0,a.kt)("th",{parentName:"tr",align:null},"\u64cd\u4f5c\u7cfb\u7edf"),(0,a.kt)("th",{parentName:"tr",align:null},"\u89d2\u8272"),(0,a.kt)("th",{parentName:"tr",align:null},"\u914d\u7f6e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"192.168.81.210"),(0,a.kt)("td",{parentName:"tr",align:null},"centos7.5"),(0,a.kt)("td",{parentName:"tr",align:null},"Master"),(0,a.kt)("td",{parentName:"tr",align:null},"CPU\uff1a2\u6838 \u5185\u5b58\uff1a2G")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"192.168.81.220"),(0,a.kt)("td",{parentName:"tr",align:null},"centos7.5"),(0,a.kt)("td",{parentName:"tr",align:null},"Node-1"),(0,a.kt)("td",{parentName:"tr",align:null},"CPU\uff1a2\u6838 \u5185\u5b58\uff1a2G")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"192.168.81.230"),(0,a.kt)("td",{parentName:"tr",align:null},"centos7.5"),(0,a.kt)("td",{parentName:"tr",align:null},"Node-2"),(0,a.kt)("td",{parentName:"tr",align:null},"CPU\uff1a2\u6838 \u5185\u5b58\uff1a2G")))),(0,a.kt)("h2",{id:"4\u7cfb\u7edf\u521d\u59cb\u5316"},"4.\u7cfb\u7edf\u521d\u59cb\u5316"),(0,a.kt)("p",null,"\u7cfb\u7edf\u521d\u59cb\u5316\u8981\u6c42\u6240\u6709\u8282\u70b9\u90fd\u6267\u884c"),(0,a.kt)("p",null,"\u6240\u6709\u8282\u70b9\u914d\u7f6eyum\u6e90"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo ;curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n")),(0,a.kt)("h3",{id:"41\u68c0\u67e5\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c"},"4.1.\u68c0\u67e5\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c"),(0,a.kt)("p",null,"kubeadm\u5b89\u88c5\u7684k8s\u8981\u6c42\u7cfb\u7edf\u7248\u672c\u5728centos 7.5\u4ee5\u4e0a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"cat /etc/redhat-release \nCentOS Linux release 7.6.1810 (Core) \n")),(0,a.kt)("h3",{id:"42\u4e3b\u673a\u540d\u89e3\u6790"},"4.2.\u4e3b\u673a\u540d\u89e3\u6790"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"vim /etc/hosts\n192.168.81.210 k8s-master\n192.168.81.220 k8s-node1\n192.168.81.230 k8s-node2                \n")),(0,a.kt)("h3",{id:"43\u65f6\u95f4\u540c\u6b65"},"4.3.\u65f6\u95f4\u540c\u6b65"),(0,a.kt)("p",null,"kubernetes\u8981\u6c42\u96c6\u7fa4\u4e2d\u8282\u70b9\u7684\u65f6\u95f4\u5fc5\u987b\u4e00\u81f4"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"systemctl start chronyd\nsystemctl enable chronyd\n")),(0,a.kt)("h3",{id:"44\u7981\u7528\u9632\u706b\u5899"},"4.4.\u7981\u7528\u9632\u706b\u5899"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"systemctl stop firewalld\nsystemctl disable firewalld\n")),(0,a.kt)("h3",{id:"45\u7981\u7528selinux"},"4.5.\u7981\u7528selinux"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"setenforce 0\nsed -ri '/^SELINUX=/c SELINUX=disabled' /etc/sysconfig/selinux\nsed -ri '/^SELINUX=/c SELINUX=disabled' /etc/selinux/config \n")),(0,a.kt)("h3",{id:"46\u7981\u7528swapp\u5206\u533a"},"4.6.\u7981\u7528swapp\u5206\u533a"),(0,a.kt)("p",null,"\u5c06fstab\u6587\u4ef6\u4e2d\u7684swap\u5206\u533a\u6ce8\u91ca\u6389\u5373\u53ef"),(0,a.kt)("p",null,"kubernetes\u8981\u6c42\u6bcf\u4e2a\u8282\u70b9\u90fd\u8981\u7981\u7528swap\u8bbe\u5907"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"vim /etc/fstab \n#/dev/mapper/centos-swap swap                    swap    defaults        0 0\n\n\u5173\u95ed\u6210\u529f\u5982\u4e0b\u6240\u793a\nfree -h\n              total        used        free      shared  buff/cache   available\nMem:           1.8G        340M        1.0G         12M        425M        1.3G\nSwap:            0B          0B          0B\n")),(0,a.kt)("h3",{id:"47\u4fee\u6539linux\u5185\u6838\u53c2\u6570"},"4.7.\u4fee\u6539linux\u5185\u6838\u53c2\u6570"),(0,a.kt)("p",null,"\u6dfb\u52a0\u7f51\u6865\u8fc7\u6ee4\u548c\u5730\u5740\u8f6c\u53d1\u529f\u80fd"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u6dfb\u52a0\u5185\u6838\u53c2\u6570\nvim /etc/sysctl.d/kubernetes.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.ipv4.ip_forward = 1\n\n2.\u52a0\u8f7d\u914d\u7f6e\nsysctl -p\n\n3.\u52a0\u8f7d\u7f51\u6865\u8fc7\u6ee4\u6a21\u5757\nmodprobe br_netfilter\n\n4.\u67e5\u770b\u662f\u5426\u52a0\u8f7d\u6210\u529f\nlsmod | grep br_netfilter\nbr_netfilter           22256  0 \nbridge                151336  1 br_netfilter\n")),(0,a.kt)("h3",{id:"48\u914d\u7f6eipvs\u529f\u80fd"},"4.8.\u914d\u7f6eipvs\u529f\u80fd"),(0,a.kt)("p",null,"\u5728kubernetes\u4e2dservice\u6709\u4e24\u79cd\u4ee3\u7406\u6a21\u5f0f\uff0c\u4e00\u79cd\u662f\u57fa\u4e8eiptables\u7684\uff0c\u4e00\u79cd\u662f\u57fa\u4e8eipvs\u7684"),(0,a.kt)("p",null,"ipvs\u7684\u6027\u80fd\u6bd4iptables\u8981\u9ad8\uff0c\u56e0\u6b64\u91c7\u7528ipvs\uff0c\u5982\u679c\u8981\u7528ipvs\uff0c\u9700\u8981\u624b\u52a8\u8f7d\u5165ipvs\u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u5b89\u88c5ipset\u548cipvsadm\nyum -y install ipset ipvsadmin\n\n2.\u914d\u7f6e\u52a0\u8f7d\u6a21\u5757\u811a\u672c\nvim /etc/sysconfig/modules/ipvs.modules\n#!/bin/bash\nmodprobe -- ip_vs\nmodprobe -- ip_vs_rr\nmodprobe -- ip_vs_wrr\nmodprobe -- ip_vs_sh\nmodprobe -- nf_conntrack_ipv4\n\n3.\u589e\u52a0\u6267\u884c\u6743\u9650\nchmod a+x /etc/sysconfig/modules/ipvs.modules\n\n4.\u6267\u884c\u811a\u672c\u6587\u4ef6\nsh /etc/sysconfig/modules/ipvs.modules\n\n5.\u67e5\u770b\u662f\u5426\u52a0\u8f7d\u6210\u529f\nlsmod | grep -E 'ip_vs|nf_conntrack'\nnf_conntrack_ipv4      15053  0 \nnf_defrag_ipv4         12729  1 nf_conntrack_ipv4\nip_vs_sh               12688  0 \nip_vs_wrr              12697  0 \nip_vs_rr               12600  0 \nip_vs                 145497  6 ip_vs_rr,ip_vs_sh,ip_vs_wrr\nnf_conntrack          133095  2 ip_vs,nf_conntrack_ipv4\nlibcrc32c              12644  3 xfs,ip_vs,nf_conntrack\n\n")),(0,a.kt)("h3",{id:"49\u91cd\u542f\u670d\u52a1\u5668"},"4.9.\u91cd\u542f\u670d\u52a1\u5668"),(0,a.kt)("p",null,"\u521d\u59cb\u5316\u64cd\u4f5c\u914d\u7f6e\u5b8c\u6210\u540e\u9700\u8981\u91cd\u542f\u670d\u52a1\u5668"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"reboot\n")),(0,a.kt)("h2",{id:"5\u90e8\u7f72kubernetes\u96c6\u7fa4"},"5.\u90e8\u7f72kubernetes\u96c6\u7fa4"),(0,a.kt)("h3",{id:"51\u6240\u6709\u8282\u70b9\u90e8\u7f72docker"},"5.1.\u6240\u6709\u8282\u70b9\u90e8\u7f72docker"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'1.\u51c6\u5907\u955c\u50cf\u6e90\n[root@k8s-master ~]\\# wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo\n\n2.\u67e5\u770b\u5f53\u524d\u652f\u6301\u7684docker\u7248\u672c\n[root@k8s-master ~]\\# yum list docker-ce --showduplicates\n\n3.\u5b89\u88c5\u7279\u5b9a\u7248\u672c\u7684docker-ce\n[root@k8s-master ~]\\# yum -y install --setopt=obsoletes=0 docker-ce-19.03.11-3.el7\n\n4.\u521b\u5efadocker\u914d\u7f6e\u6587\u4ef6\ndocker\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f7f\u7528cgroup driver\u4f5c\u4e3acgroupfs\uff0c\u800ck8s\u63a8\u8350\u4f7f\u7528systemd\u6765\u4ee3\u66ffcgroupfs\n[root@k8s-master ~]\\# mkdir /etc/docker\n[root@k8s-master ~]\\# vim /etc/docker/daemon.json\n{\n        "exec-opts": ["native.cgroupdriver=systemd"],\n        "registry-mirrors": ["https://zggyaen3.mirror.aliyuncs.com"]\n}\n\n5.\u542f\u52a8docker\n[root@k8s-master ~]\\# systemctl start docker\n[root@k8s-master ~]\\# systemctl enable docker\n\n6.\u67e5\u770bdocker\u7248\u672c\n[root@k8s-master ~]\\# docker version\n')),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072119_61ce3eef66b7188674.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_\u5176\u4ed6_02"})),(0,a.kt)("h3",{id:"52\u6240\u6709\u8282\u70b9\u5b89\u88c5kubernetes\u7ec4\u4ef6"},"5.2.\u6240\u6709\u8282\u70b9\u5b89\u88c5kubernetes\u7ec4\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'1.\u51c6\u5907k8s\u955c\u50cf\u6e90\n[root@k8s-master ~]\\# vim /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes Repo\nbaseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64   \ngpgcheck=0\nenabled=1\nrepo_gpgcheck=0\ngpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpgp\n       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\n\n2.\u67e5\u8be2kubeadm\u53ef\u7528\u7684\u7248\u672c\n[root@k8s-master ~]\\# yum list kubeadm --showduplicates\n\n3.\u5b89\u88c5kubeadm\u3001kubelet\u3001kubect\n[root@k8s-master ~]\\# yum -y install --setopt=obsoletes=0 kubeadm-1.19.6-0 kubelet-1.19.6-0 kubectl-1.19.6-0 --downloaddir=/root/soft/kubernetes\n\n4.\u914d\u7f6ekubelet\u7684cgroup\u4ee5\u53ca\u4f7f\u7528ipvs\u8f6c\u53d1\n[root@k8s-master ~]\\# vim /etc/sysconfig/kubelet \nKUBELET_EXTRA_ARGS="--cgroup-driver=systemd"\nKUBE_PROXY_MODE="ipvs"\n\n5.\u8bbe\u7f6ekubelet\u5f00\u673a\u81ea\u542f\n#\u5b89\u88c5\u597dkubelet\u540e\u5148\u4e0d\u7528\u542f\u52a8\uff0c\u5f53\u96c6\u7fa4\u521d\u59cb\u5316\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u542f\u52a8kubelet\uff0c\u9009\u62e9\u542f\u52a8kubelet\u4f1a\u62a5\u9519\n[root@k8s-master ~]\\# systemctl enable kubelet\n\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u9009\u62e9\u8f6f\u4ef6\u7248\u672c")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072119_61ce3eeff1c5061461.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_\u5176\u4ed6_03"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u6240\u6709\u8282\u70b9\u6210\u529f\u5b89\u88c5kubeadm\u3001kublet\u3001kubectl")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072120_61ce3ef0681be88204.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_docker_04"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5b89\u88c5\u5b8ckubelet\u5148\u4e0d\u7528\u542f\u52a8\uff0c\u542f\u52a8\u4f1a\u62a5\u9519")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072120_61ce3ef0bb97f70034.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_linux_05"})),(0,a.kt)("h3",{id:"53\u6240\u6709\u8282\u70b9\u51c6\u5907\u96c6\u7fa4\u7ec4\u4ef6\u955c\u50cf\u5305"},"5.3.\u6240\u6709\u8282\u70b9\u51c6\u5907\u96c6\u7fa4\u7ec4\u4ef6\u955c\u50cf\u5305"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5728\u5b89\u88c5kubernetes\u96c6\u7fa4\u4e4b\u524d\uff0c\u5fc5\u987b\u8981\u63d0\u524d\u51c6\u5907\u597d\u96c6\u7fa4\u9700\u8981\u7684\u955c\u50cf"),(0,a.kt)("p",{parentName:"blockquote"},"\u7531\u4e8e\u955c\u50cf\u90fd\u5728\u56fd\u5916\uff0c\u963f\u91cc\u4e91\u4e0a\u6709\u5bf9\u5e94\u7684\u955c\u50cf\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4ece\u963f\u91cc\u4e91\u4e0a\u4e0b\u8f7d\uff0c\u7136\u540e\u4fee\u6539\u4e3a\u56fd\u5916\u955c\u50cf\u7684\u540d\u5b57\u5373\u53ef"),(0,a.kt)("p",{parentName:"blockquote"},"\u9996\u5148\u67e5\u4e00\u4e0b\u9002\u5408\u5f53\u524dk8s\u96c6\u7fa4\u7248\u672c\u7684\u7ec4\u4ef6\u955c\u50cf\u5305\u5728\u53bb\u4e0b\u8f7d\uff0c\u5176\u5b9e\u4e3b\u8981\u662f\u770bpause\u3001etcd\u3001coredns\u8fd9\u4e09\u4e2a\u7ec4\u4ef6\u7684\u7248\u672c\uff0capiserver\u3001contorller-manager\u3001scheduler\u3001proxy\u90fd\u548ckubeadm\u7684\u7248\u672c\u4e00\u81f4"),(0,a.kt)("pre",{parentName:"blockquote"},(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u67e5\u770b\u955c\u50cf\u5305\u5217\u8868\n[root@k8s-master ~]\\# kubeadm config images list\nk8s.gcr.io/kube-apiserver:v1.19.8\nk8s.gcr.io/kube-controller-manager:v1.19.8\nk8s.gcr.io/kube-scheduler:v1.19.8\nk8s.gcr.io/kube-proxy:v1.19.8\nk8s.gcr.io/pause:3.2\nk8s.gcr.io/etcd:3.4.13-0\nk8s.gcr.io/coredns:1.7.0\n"))),(0,a.kt)("p",null,"2.\u4e0b\u8f7d\u955c\u50cf\n","[root@k8s-master ~]","#"," images=(\nkube-apiserver:v1.19.6\nkube-controller-manager:v1.19.6\nkube-scheduler:v1.19.6\nkube-proxy:v1.19.6\npause:3.2\netcd:3.4.13-0\ncoredns:1.7.0\n)\n","[root@k8s-master ~]","#"," for imageName in ${images","[@]","}\ndo\ndocker pull registry.cn-hangzhou.aliyuncs.com/google_containers/$imageName\ndocker tag registry.cn-hangzhou.aliyuncs.com/google_containers/$imageName k8s.gcr.io/$imageName\ndocker rmi registry.cn-hangzhou.aliyuncs.com/google_containers/$imageName\ndone"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\n### 5.4.master\u8282\u70b9\u521d\u59cb\u5316\n\n> \u53ea\u5728master\u64cd\u4f5c\uff0c\u521d\u59cb\u5316\u6210\u529f\u540e\uff0ckubelet\u7ec4\u4ef6\u4f1a\u81ea\u52a8\u542f\u52a8\uff0c\u5e76\u4e14\u4f7f\u7528kubectl get node\u547d\u4ee4\u4e5f\u53ef\u4ee5\u770b\u5230\u96c6\u7fa4\u4e2d\u5df2\u7ecf\u6709master\u8282\u70b9\u4e86\n```sh\n1.\u96c6\u7fa4\u521d\u59cb\u5316\n[root@k8s-master ~]\\# kubeadm init \\\n--kubernetes-version=v1.19.6 \\                                          #\u6307\u5b9ak8s\u7684\u7248\u672c\n--pod-network-cidr=10.244.0.0/16 \\                              #pod\u7f51\u7edc\u5730\u5740\u6bb5\n--service-cidr=10.96.0.0/12 \\                                   #service\u8d44\u6e90\u7f51\u7edc\u5730\u5740\u6bb5\n--apiserver-advertise-address=192.168.81.210                                #apiserver\u5730\u5740\n\n2.\u521b\u5efa\u5fc5\u8981\u6587\u4ef6\n\u8fd9\u4e9b\u6587\u4ef6\u662f\u4f7f\u7528kubectl\u547d\u4ee4\u7684\u524d\u63d0\uff0ckubectl\u547d\u4ee4\u4f7f\u7528\u662f\u9700\u8981\u53bb\u627econfig\u914d\u7f6e\u6587\u4ef6\n[root@k8s-master ~]\\# mkdir -p $HOME/.kube\n[root@k8s-master ~]\\# sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n[root@k8s-master ~]\\# sudo chown $(id -u).$(id -g) $HOME/.kube/config\n\n3.\u67e5\u770bmaster\u662f\u5426\u52a0\u5165\u96c6\u7fa4\n[root@k8s-master ~]\\# kubectl get node\nNAME         STATUS     ROLES    AGE   VERSION\nk8s-master   NotReady   master   12m   v1.19.6\n\n4.\u521d\u59cb\u5316\u6210\u529f\u540ekubelet\u4e5f\u4f1a\u81ea\u52a8\u542f\u52a8\n[root@k8s-master ~]\\# systemctl status kubelet\n\u25cf kubelet.service - kubelet: The Kubernetes Node Agent\n   Loaded: loaded (/usr/lib/systemd/system/kubelet.service; enabled; vendor preset: disabled)\n  Drop-In: /usr/lib/systemd/system/kubelet.service.d\n           \u2514\u250010-kubeadm.conf\n   Active: active (`running`) since \u516d 2021-02-20 10:14:21 CST; 17min ago\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u521d\u59cb\u5316\u8fc7\u7a0b\u4ea7\u751f\u4e86\u5f88\u591a\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u8f93\u51fa"),(0,a.kt)("p",{parentName:"blockquote"},".Your Kubernetes control-plane has initialized successfully! //\u8fd9\u4e2a\u63d0\u793a\u8bf4\u660emaster\u8282\u70b9\u5df2\u7ecf\u521d\u59cb\u5316\u6210\u529f\u4e86"),(0,a.kt)("p",{parentName:"blockquote"},"To start using your cluster, you need to run the following as a regular user: //\u8fd9\u4e2a\u63d0\u793a\u8bf4\u8981\u60f3\u4f7f\u7528k8s\u96c6\u7fa4\uff0c\u8fd8\u9700\u8981\u6267\u884c\u4e0b\u9762\u4e09\u6761\u547d\u4ee4"),(0,a.kt)("pre",{parentName:"blockquote"},(0,a.kt)("code",{parentName:"pre"},"mkdir -p $HOME/.kube`\n`sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config`\n")),(0,a.kt)("p",{parentName:"blockquote"},"You should now deploy a pod network to the cluster.\nRun \u201ckubectl apply -f ","[podnetwork]",".yaml\u201d with one of the options listed at: //\u8fd9\u4e2a\u63d0\u793a\u8bf4\u660e\u60f3\u8981\u90e8\u7f72\u5bb9\u5668\uff0c\u8fd8\u9700\u8981\u914d\u7f6e\u7f51\u7edc\u6a21\u578b\n",(0,a.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/cluster-administration/addons/"},"https://kubernetes.io/docs/concepts/cluster-administration/addons/")),(0,a.kt)("p",{parentName:"blockquote"},"Then you can join any number of worker nodes by running the following on each as root: //\u8fd9\u4e2a\u63d0\u793a\u8bf4\u660e\u8981\u60f3\u8ba9\u5176\u4ed6node\u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u9700\u8981\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4"),(0,a.kt)("p",{parentName:"blockquote"},"kubeadm join 192.168.81.210:6443 --token z0hiaw.woiwvjvx8o1kd4ef\n\u2013discovery-token-ca-cert-hash sha256:4009b1fad096615c3409fcd670feb8a915f7f1f6eb03bc3adcb1164cf871b960")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072121_61ce3ef13526811335.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_linux_06"})),(0,a.kt)("h3",{id:"55node\u8282\u70b9\u521d\u59cb\u5316"},"5.5.node\u8282\u70b9\u521d\u59cb\u5316"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u53ea\u5728node\u8282\u70b9\u64cd\u4f5c"),(0,a.kt)("pre",{parentName:"blockquote"},(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.node-1\u64cd\u4f5c\n[root@k8s-node1 ~]\\# kubeadm join 192.168.81.210:6443 \\\n--token z0hiaw.woiwvjvx8o1kd4ef \\\n--discovery-token-ca-cert-hash sha256:4009b1fad096615c3409fcd670feb8a915f7f1f6eb03bc3adcb1164cf871b960 \n"))),(0,a.kt)("p",null,"2.node-2\u64cd\u4f5c\n","[root@k8s-node2 ~]","#"," kubeadm join 192.168.81.210:6443 \\\n--token z0hiaw.woiwvjvx8o1kd4ef \\\n--discovery-token-ca-cert-hash sha256:4009b1fad096615c3409fcd670feb8a915f7f1f6eb03bc3adcb1164cf871b960 "),(0,a.kt)("p",null,"3.\u5728master\u8282\u70b9\u67e5\u770b\u96c6\u7fa4\u8282\u70b9\u4fe1\u606f\n#\u53ef\u4ee5\u770b\u5230\u96c6\u7fa4\u4e2d\u5df2\u7ecf\u6709\u4e09\u4e2a\u8282\u70b9\u4e86\uff0c\u4f46\u662f\u72b6\u6001\u90fd\u662fnotready\uff0c\u8bf4\u660e\u6211\u4eec\u8fd8\u6ca1\u6709\u914d\u7f6e\u7f51\u7edc\u63d2\u4ef6\uff0c\u96c6\u7fa4\u8282\u70b9\u4e4b\u95f4\u4e0d\u901a\u8baf\u5bfc\u81f4\u7684\n","[root@k8s-master ~]","#"," kubectl get node\nNAME         STATUS     ROLES    AGE   VERSION\nk8s-master   NotReady   master   18m   v1.19.6\nk8s-node1    NotReady   \\<none",">","   51s   v1.19.6\nk8s-node2    NotReady   \\<none",">","   10s   v1.19.6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\n![kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_linux_07](https://cdn.agou-ops.cn/others/31072121_61ce3ef1ac9e171538.png)\n\n### 5.6.\u96c6\u7fa4\u914d\u7f6eflannel\u7f51\u7edc\n```sh\n1.\u4e0b\u8f7dflannel yaml\u6587\u4ef6\n\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1LXmk64m7cZZgr0X2GxX0FA \n\u63d0\u53d6\u7801\uff1ar4i7 \n\u4e0b\u8f7d\u540e\u4f20\u5230\u670d\u52a1\u5668\u4e0a\n\n\n2.\u5c06\u6587\u4ef6\u4e2dquay.io\u4ed3\u5e93\u6539\u4e3aquay-mirror.qiniu.com\n[root@k8s-master ~]\\# mkdir k8s_1.19_yaml\n[root@k8s-master ~]\\# cd k8s_1.19_yaml\n[root@k8s-master ~/k8s_1.19_yaml]\\# sed -ri 's#quay.io#quay-mirror.qiniu.com#g' kube-flannel.yaml \n\n3.\u542f\u52a8flannel\u7f51\u7edc\n[root@k8s-master ~/k8s_1.19_yaml]\\# kubectl apply -f kube-flannel.yaml \npodsecuritypolicy.policy/psp.flannel.unprivileged created\nclusterrole.rbac.authorization.k8s.io/flannel created\nclusterrolebinding.rbac.authorization.k8s.io/flannel created\nserviceaccount/flannel created\nconfigmap/kube-flannel-cfg created\ndaemonset.apps/kube-flannel-ds-amd64 created\ndaemonset.apps/kube-flannel-ds-arm64 created\ndaemonset.apps/kube-flannel-ds-arm created\ndaemonset.apps/kube-flannel-ds-ppc64le created\ndaemonset.apps/kube-flannel-ds-s390x created\n\n4.flannel\u7f51\u7edc\u6709\u65f6pull\u4f1a\u5931\u8d25\u53ef\u4ee5\u4ece\u8fd9\u91cc\u63d0\u53d6\n\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1AqubJhTMIshf66ofOCkubQ \n\u63d0\u53d6\u7801\uff1aypbh \n\u4e0b\u8f7d\u540e\u5bfc\u5165\u7cfb\u7edf\u540e\uff0c\u5728\u628a\u955c\u50cf\u6253\u4e2a\u6807\u7b7e\u548cyaml\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u4fdd\u6301\u4e00\u81f4\n[root@k8s-master ~/k8s_1.19_yaml]\\# docker load -i flanneld-v0.12.0-amd64.docker \n[root@k8s-master ~/k8s_1.19_yaml]\\# docker tag quay.io/coreos/flannel:v0.12.0-amd64 quay-mirror.qiniu.com/coreos/flannel:v0.12.0-amd64\n\n5.\u67e5\u770b\u7ec4\u4ef6pod\u72b6\u6001\n[root@k8s-master ~/k8s_1.19_yaml]\\# kubectl get pods -n kube-system\nNAME                                 READY   STATUS    RESTARTS   AGE\ncoredns-f9fd979d6-r9s9q              1/1     Running   0          69m\ncoredns-f9fd979d6-znljq              1/1     Running   0          69m\netcd-k8s-master                      1/1     Running   0          70m\nkube-apiserver-k8s-master            1/1     Running   0          70m\nkube-controller-manager-k8s-master   1/1     Running   0          70m\nkube-flannel-ds-amd64-cjlqh          1/1     Running   0          116s\nkube-flannel-ds-amd64-kllsk          1/1     Running   0          116s\nkube-flannel-ds-amd64-q5bjg          1/1     Running   0          116s\nkube-proxy-6pdf8                     1/1     Running   0          51m\nkube-proxy-lkm8r                     1/1     Running   0          69m\nkube-proxy-whmll                     1/1     Running   0          52m\nkube-scheduler-k8s-master            1/1     Running   0          70m\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5f53\u96c6\u7fa4\u7ec4\u4ef6\u5168\u90e8\u8fd0\u884c\u6210\u529f\uff0c\u7f51\u7edc\u6a21\u578bflannel\u6ca1\u95ee\u9898\u540e\uff0c\u96c6\u7fa4\u8282\u70b9\u5c31\u90fd\u662f\u53ef\u7528\u72b6\u6001\u4e86"),(0,a.kt)("p",{parentName:"blockquote"},"\u96c6\u7fa4\u5b89\u88c5\u597d\u4e4b\u540e\u6240\u6709\u64cd\u4f5c\u90fd\u5728master\u4e0a\u8fdb\u884c")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072122_61ce3ef23c59f85508.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_\u521d\u59cb\u5316_08"})),(0,a.kt)("h2",{id:"6\u90e8\u7f72\u4e00\u4e2anginx\u5bb9\u5668\u9a8c\u8bc1\u96c6\u7fa4\u53ef\u7528\u6027"},"6.\u90e8\u7f72\u4e00\u4e2anginx\u5bb9\u5668\u9a8c\u8bc1\u96c6\u7fa4\u53ef\u7528\u6027"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u521b\u5efa\u4e00\u4e2adeployment\u8d44\u6e90\u7684nginx\n[root@k8s-master ~]\\# kubectl create deployment nginx --image=nginx:1.16\n\n2.\u5bf9\u5916\u66b4\u9732\u7aef\u53e3\n\u8fd9\u6761\u547d\u4ee4\u5176\u5b9e\u5c31\u662f\u521b\u5efa\u4e86\u4e00\u4e2asvc\u8d44\u6e90\uff0c\u66b4\u9732\u4e00\u4e2a\u968f\u673a\u7aef\u53e3\n[root@k8s-master ~]\\# kubectl expose deployment nginx --port=80 --type=NodePort\nservice/nginx exposed\n\n3.\u67e5\u770bpod\u8d44\u6e90\n[root@k8s-master ~]\\# kubectl get pod -o wide\nNAME                     READY   STATUS    RESTARTS   AGE     IP           NODE        NOMINATED NODE   READINESS GATES\nnginx-6d4cf56db6-wwmvl   1/1     Running   0          3m59s   10.244.1.4   k8s-node1   <none>           <none>\n\n4.\u67e5\u770b\u6240\u6709\u8d44\u6e90\n[root@k8s-master ~]\\# kubectl get all\n\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"30376\u5c31\u662fsvc\u66b4\u9732\u51fa\u7684\u968f\u673a\u7aef\u53e3\uff0c\u4f7f\u7528\u96c6\u7fa4\u8282\u70b9\u4efb\u610fip\u90fd\u53ef\u4ee5\u8bbf\u95ee\u523030376\u7aef\u53e3\u7684\u5e94\u7528")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072122_61ce3ef2974ec5568.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_\u5176\u4ed6_09"})),(0,a.kt)("h2",{id:"7k8s\u547d\u4ee4\u5f00\u542ftab\u529f\u80fd"},"7.k8s\u547d\u4ee4\u5f00\u542ftab\u529f\u80fd"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},'[root@k8s-master ~]\\# yum install -y bash-completion\n[root@k8s-master ~]\\# source /usr/share/bash-completion/bash_completion\n[root@k8s-master ~]\\# source <(kubectl completion bash)\n[root@k8s-master ~]\\# echo "source <(kubectl completion bash)" >> ~/.bashrc\n')),(0,a.kt)("h2",{id:"8\u90e8\u7f72rancher\u7ba1\u7406k8s"},"8.\u90e8\u7f72rancher\u7ba1\u7406k8s"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u5bfc\u5165rancher\u955c\u50cf\n[root@k8s-master ~]\\# docker load -i rancher_v244.tar.gz \n\n2.\u51c6\u5907\u6302\u8f7d\u70b9\n[root@k8s-master ~]\\# mkdir -p /docker_volume/rancher_home/rancher\n[root@k8s-master ~]\\# mkdir -p /docker_volume/rancher_home/auditlog\n\n3.\u8fd0\u884crancher\u5bb9\u5668\ndocker run -d --restart=unless-stopped -p 80:80 -p 443:443 \\\n-v /docker_volume/rancher_home/rancher:/var/lib/rancher \\\n-v /docker_volume/rancher_home/auditlog:/var/log/auditlog \\\n--name rancher rancher/rancher:v2.4.4  \n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5bfc\u5165\u96c6\u7fa4")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072122_61ce3ef2bddb656521.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_linux_10"})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"1.\u52a0\u5165rancher\n[root@k8s-master ~]\\# curl --insecure -sfL https://192.168.16.107/v3/import/bpgwzbwqm7lwk48s89mw98llm6cnvgvx64x7lmvwjn88xn4b22l2ql.yaml | kubectl apply -f -\n[root@k8s-master ~]\\# kubectl apply -f https://192.168.16.107/v3/import/bpgwzbwqm7lwk48s89mw98llm6cnvgvx64x7lmvwjn88xn4b22l2ql.yaml\n\n\n2.\u7b49\u5f85\u5bb9\u5668\u542f\u52a8\u6210\u529f\u5171\u5373\u53ef\u52a0\u5165rancher\n[root@k8s-master ~]\\# kubectl get pod -n cattle-system\nNAME                                    READY   STATUS    RESTARTS   AGE\ncattle-cluster-agent-69c6bd94ff-vhlqs   1/1     Running   0          55m\ncattle-node-agent-72x2b                 1/1     Running   0          54m\ncattle-node-agent-csnd7                 1/1     Running   0          55m\ncattle-node-agent-gtf4s                 1/1     Running   0          54m\n\n")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn.agou-ops.cn/others/31072123_61ce3ef31268a2979.png",alt:"kubeadm\u65b9\u5f0f\u90e8\u7f72Kubernetes1.19\u96c6\u7fa4\u73af\u5883\uff08\u4e8c\uff09_\u5176\u4ed6_11"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u6587\u7ae0\u6765\u6e90\u4e8e\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://blog.51cto.com/jiangxl/4803878"},"https://blog.51cto.com/jiangxl/4803878")),(0,a.kt)("p",{parentName:"blockquote"},"\u4ec5\u505a\u4e2a\u4eba\u5907\u4efd\u5b66\u4e60\u4f7f\u7528.")))}p.isMDXComponent=!0}}]);