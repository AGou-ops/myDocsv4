"use strict";(self.webpackChunkmy_docsv_4=self.webpackChunkmy_docsv_4||[]).push([[4524],{3905:(e,n,o)=>{o.d(n,{Zo:()=>l,kt:()=>g});var t=o(67294);function i(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function r(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function c(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){i(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function s(e,n){if(null==e)return{};var o,t,i=function(e,n){if(null==e)return{};var o,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||(i[o]=e[o]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var a=t.createContext({}),h=function(e){var n=t.useContext(a),o=n;return e&&(o="function"==typeof e?e(n):c(c({},n),e)),o},l=function(e){var n=h(e.components);return t.createElement(a.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var o=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=h(o),g=i,m=d["".concat(a,".").concat(g)]||d[g]||p[g]||r;return o?t.createElement(m,c(c({ref:n},l),{},{components:o})):t.createElement(m,c({ref:n},l))}));function g(e,n){var o=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=o.length,c=new Array(r);c[0]=d;var s={};for(var a in n)hasOwnProperty.call(n,a)&&(s[a]=n[a]);s.originalType=e,s.mdxType="string"==typeof e?e:i,c[1]=s;for(var h=2;h<r;h++)c[h]=o[h];return t.createElement.apply(null,c)}return t.createElement.apply(null,o)}d.displayName="MDXCreateElement"},39718:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>h});var t=o(87462),i=(o(67294),o(3905));const r={},c="CentOS \u7cfb\u7edf\u4fe1\u606f\u7edf\u8ba1",s={unversionedId:"Scripts/shell/CentOS sys information",id:"Scripts/shell/CentOS sys information",title:"CentOS \u7cfb\u7edf\u4fe1\u606f\u7edf\u8ba1",description:"\u811a\u672c\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a",source:"@site/docs/Scripts/shell/CentOS sys information.md",sourceDirName:"Scripts/shell",slug:"/Scripts/shell/CentOS sys information",permalink:"/docs/Scripts/shell/CentOS sys information",draft:!1,editUrl:"https://github.com/AGou-ops/myDocsv4/edit/main/docs/Scripts/shell/CentOS sys information.md",tags:[],version:"current",frontMatter:{},sidebar:"scripts",previous:{title:"\u6839\u636ecsv\u91cd\u5f52\u6863\u6587\u4ef6",permalink:"/docs/Scripts/shell/resort-file-from-csv/resort-file"},next:{title:"Dokcer \u955c\u50cf\u5907\u4efd",permalink:"/docs/Scripts/shell/Dokcer \u955c\u50cf\u5907\u4efd"}},a={},h=[],l={toc:h};function p(e){let{components:n,...o}=e;return(0,i.kt)("wrapper",(0,t.Z)({},l,o,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"centos-\u7cfb\u7edf\u4fe1\u606f\u7edf\u8ba1"},"CentOS \u7cfb\u7edf\u4fe1\u606f\u7edf\u8ba1"),(0,i.kt)("p",null,"\u811a\u672c\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n##Filename:     CentOS_Check_Script.sh\n##Date:         2019-03-01\n##Description:  Security detection script\n\necho "##########################################################################"\necho "#                                                                        #"\necho "#                        Epoint health check script                      #"\necho "#                                                                        #"\necho "#\u8b66\u544a:\u672c\u811a\u672c\u53ea\u662f\u4e00\u4e2a\u68c0\u67e5\u7684\u64cd\u4f5c,\u672a\u5bf9\u670d\u52a1\u5668\u505a\u4efb\u4f55\u4fee\u6539,\u7ba1\u7406\u5458\u53ef\u4ee5\u6839\u636e\u6b64\u62a5\u544a #"\necho "#\u8fdb\u884c\u76f8\u5e94\u7684\u5b89\u5168\u6574\u6539                                                      #"\necho "##########################################################################"\necho " "\n#read -p "=====================Are You Ready,Please press enter=================="\necho " "\necho "##########################################################################"\necho "#                                                                        #"\necho "#                               \u4e3b\u673a\u5b89\u5168\u68c0\u6d4b                             #"\necho "#                                                                        #"\necho "##########################################################################"\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u7cfb\u7edf\u57fa\u672c\u4fe1\u606f<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\nhostname=$(uname -n)\nsystem=$(cat /etc/os-release | grep "^NAME" | awk -F\\" \'{print $2}\')\nversion=$(cat /etc/redhat-release | awk \'{print $4$5}\')\nkernel=$(uname -r)\nplatform=$(uname -p)\naddress=$(ip addr | grep inet | grep -v "inet6" | grep -v "127.0.0.1" | awk \'{ print $2; }\' | tr \'\\n\' \'\\t\' )\ncpumodel=$(cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq)\ncpu=$(cat /proc/cpuinfo | grep \'processor\' | sort | uniq | wc -l)\nmachinemodel=$(dmidecode | grep "Product Name" | sed \'s/^[ \\t]*//g\' | tr \'\\n\' \'\\t\' )\ndate=$(date)\n\necho "\u4e3b\u673a\u540d:           $hostname"\necho "\u7cfb\u7edf\u540d\u79f0:         $system"\necho "\u7cfb\u7edf\u7248\u672c:         $version"\necho "\u5185\u6838\u7248\u672c:         $kernel"\necho "\u7cfb\u7edf\u7c7b\u578b:         $platform"\necho "\u672c\u673aIP\u5730\u5740:       $address"\necho "CPU\u578b\u53f7:          $cpumodel"\necho "CPU\u6838\u6570:          $cpu"\necho "\u673a\u5668\u578b\u53f7:         $machinemodel"\necho "\u7cfb\u7edf\u65f6\u95f4:         $date"\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\nsummemory=$(free -h |grep "Mem:" | awk \'{print $2}\')\nfreememory=$(free -h |grep "Mem:" | awk \'{print $4}\')\nusagememory=$(free -h |grep "Mem:" | awk \'{print $3}\')\nuptime=$(uptime | awk \'{print $2" "$3" "$4" "$5}\' | sed \'s/,$//g\')\nloadavg=$(uptime | awk \'{print $9" "$10" "$11" "$12" "$13}\')\n\necho "\u603b\u5185\u5b58\u5927\u5c0f:           $summemory"\necho "\u5df2\u4f7f\u7528\u5185\u5b58\u5927\u5c0f:       $usagememory"\necho "\u53ef\u4f7f\u7528\u5185\u5b58\u5927\u5c0f:       $freememory"\necho "\u7cfb\u7edf\u8fd0\u884c\u65f6\u95f4:         $uptime"\necho "\u7cfb\u7edf\u8d1f\u8f7d:             $loadavg"\necho "=============================dividing line================================"\necho "\u5185\u5b58\u72b6\u6001:"\nvmstat 2 5\necho "=============================dividing line================================"\necho "\u50f5\u5c38\u8fdb\u7a0b:"\nps -ef | grep zombie | grep -v grep\nif [ $? == 1 ];then\n    echo ">>>\u65e0\u50f5\u5c38\u8fdb\u7a0b"\nelse\n    echo ">>>\u6709\u50f5\u5c38\u8fdb\u7a0b------[\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho "\u8017CPU\u6700\u591a\u7684\u8fdb\u7a0b:"\nps auxf |sort -nr -k 3 |head -5\necho "=============================dividing line================================"\necho "\u8017\u5185\u5b58\u6700\u591a\u7684\u8fdb\u7a0b:"\nps auxf |sort -nr -k 4 |head -5\necho "=============================dividing line================================"\necho  "\u73af\u5883\u53d8\u91cf:"\nenv\necho "=============================dividing line================================"\necho  "\u8def\u7531\u8868:"\nroute -n\necho "=============================dividing line================================"\necho  "\u76d1\u542c\u7aef\u53e3:"\nnetstat -tunlp\necho "=============================dividing line================================"\necho  "\u5f53\u524d\u5efa\u7acb\u7684\u8fde\u63a5:"\nnetstat -n | awk \'/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}\'\necho "=============================dividing line================================"\necho "\u5f00\u673a\u542f\u52a8\u7684\u670d\u52a1:"\nsystemctl list-unit-files | grep enabled\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u7cfb\u7edf\u7528\u6237\u60c5\u51b5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho  "\u6d3b\u52a8\u7528\u6237:"\nw | tail -n +2\necho "=============================dividing line================================"\necho  "\u7cfb\u7edf\u6240\u6709\u7528\u6237:"\ncut -d: -f1,2,3,4 /etc/passwd\necho "=============================dividing line================================"\necho  "\u7cfb\u7edf\u6240\u6709\u7ec4:"\ncut -d: -f1,2,3 /etc/group\necho "=============================dividing line================================"\necho  "\u5f53\u524d\u7528\u6237\u7684\u8ba1\u5212\u4efb\u52a1:"\ncrontab -l\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u8eab\u4efd\u9274\u522b\u5b89\u5168<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\ngrep -i "^password.*requisite.*pam_cracklib.so" /etc/pam.d/system-auth  > /dev/null\nif [ $? == 0 ];then\n    echo ">>>\u5bc6\u7801\u590d\u6742\u5ea6:\u5df2\u8bbe\u7f6e"\nelse\n    grep -i "pam_pwquality\\.so" /etc/pam.d/system-auth > /dev/null\n    if [ $? == 0 ];then\n    echo ">>>\u5bc6\u7801\u590d\u6742\u5ea6:\u5df2\u8bbe\u7f6e"\n    else\n    echo ">>>\u5bc6\u7801\u590d\u6742\u5ea6:\u672a\u8bbe\u7f6e,\u8bf7\u52a0\u56fa\u5bc6\u7801--------[\u9700\u8c03\u6574]"\n    fi\nfi\necho "=============================dividing line================================"\nawk -F":" \'{if($2!~/^!|^*/){print ">>>("$1")" " \u662f\u4e00\u4e2a\u672a\u88ab\u9501\u5b9a\u7684\u8d26\u6237,\u8bf7\u7ba1\u7406\u5458\u68c0\u67e5\u662f\u5426\u662f\u53ef\u7591\u8d26\u6237--------[\u9700\u8c03\u6574]"}}\' /etc/shadow\necho "=============================dividing line================================"\nmore /etc/login.defs | grep -E "PASS_MAX_DAYS" | grep -v "#" |awk -F\' \'  \'{if($2!=90){print ">>>\u5bc6\u7801\u8fc7\u671f\u5929\u6570\u662f"$2"\u5929,\u8bf7\u7ba1\u7406\u5458\u6539\u621090\u5929------[\u9700\u8c03\u6574]"}}\'\necho "=============================dividing line================================"\ngrep -i "^auth.*required.*pam_tally2.so.*$" /etc/pam.d/sshd  > /dev/null\nif [ $? == 0 ];then\n  echo ">>>\u767b\u5165\u5931\u8d25\u5904\u7406:\u5df2\u5f00\u542f"\nelse\n  echo ">>>\u767b\u5165\u5931\u8d25\u5904\u7406:\u672a\u5f00\u542f,\u8bf7\u52a0\u56fa\u767b\u5165\u5931\u8d25\u9501\u5b9a\u529f\u80fd----------[\u9700\u8c03\u6574]"\nfi\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u8bbf\u95ee\u63a7\u5236\u5b89\u5168<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho "\u7cfb\u7edf\u4e2d\u5b58\u5728\u4ee5\u4e0b\u975e\u7cfb\u7edf\u9ed8\u8ba4\u7528\u6237:"\nmore /etc/passwd |awk -F ":" \'{if($3>500){print ">>>/etc/passwd\u91cc\u9762\u7684"$1 "\u7684UID\u4e3a"$3"\uff0c\u8be5\u8d26\u6237\u975e\u7cfb\u7edf\u9ed8\u8ba4\u8d26\u6237\uff0c\u8bf7\u7ba1\u7406\u5458\u786e\u8ba4\u662f\u5426\u4e3a\u53ef\u7591\u8d26\u6237--------[\u9700\u8c03\u6574]"}}\'\necho "=============================dividing line================================"\necho "\u7cfb\u7edf\u7279\u6743\u7528\u6237:"\nawk -F: \'$3==0 {print $1}\' /etc/passwd\necho "=============================dividing line================================"\necho "\u7cfb\u7edf\u4e2d\u7a7a\u53e3\u4ee4\u8d26\u6237:"\nawk -F: \'($2=="!!") {print $1"\u8be5\u8d26\u6237\u4e3a\u7a7a\u53e3\u4ee4\u8d26\u6237\uff0c\u8bf7\u7ba1\u7406\u5458\u786e\u8ba4\u662f\u5426\u4e3a\u65b0\u589e\u8d26\u6237\uff0c\u5982\u679c\u4e3a\u65b0\u5efa\u8d26\u6237\uff0c\u8bf7\u914d\u7f6e\u5bc6\u7801-------[\u9700\u8c03\u6574]"}\' /etc/shadow\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u5b89\u5168\u5ba1\u8ba1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho "\u6b63\u5e38\u60c5\u51b5\u4e0b\u767b\u5f55\u5230\u672c\u673a30\u5929\u5185\u7684\u6240\u6709\u7528\u6237\u7684\u5386\u53f2\u8bb0\u5f55:"\nlast | head -n 30\necho "=============================dividing line================================"\necho "\u67e5\u770bsyslog\u65e5\u5fd7\u5ba1\u8ba1\u670d\u52a1\u662f\u5426\u5f00\u542f:"\nif service rsyslog status | egrep " active \\(running";then\n  echo ">>>\u7ecf\u5206\u6790,syslog\u670d\u52a1\u5df2\u5f00\u542f"\nelse\n  echo ">>>\u7ecf\u5206\u6790,syslog\u670d\u52a1\u672a\u5f00\u542f\uff0c\u5efa\u8bae\u901a\u8fc7service rsyslog start\u5f00\u542f\u65e5\u5fd7\u5ba1\u8ba1\u529f\u80fd---------[\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho "\u67e5\u770bsyslog\u65e5\u5fd7\u662f\u5426\u5f00\u542f\u5916\u53d1:"\nif more /etc/rsyslog.conf | egrep "@...\\.|@..\\.|@.\\.|\\*.\\* @...\\.|\\*\\.\\* @..\\.|\\*\\.\\* @.\\.";then\n  echo ">>>\u7ecf\u5206\u6790,\u5ba2\u6237\u7aefsyslog\u65e5\u5fd7\u5df2\u5f00\u542f\u5916\u53d1--------[\u9700\u8c03\u6574]"\nelse\n  echo ">>>\u7ecf\u5206\u6790,\u5ba2\u6237\u7aefsyslog\u65e5\u5fd7\u672a\u5f00\u542f\u5916\u53d1---------[\u65e0\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho "\u5ba1\u8ba1\u7684\u8981\u7d20\u548c\u5ba1\u8ba1\u65e5\u5fd7:"\nmore /etc/rsyslog.conf  | grep -v "^[$|#]" | grep -v "^$"\necho "=============================dividing line================================"\necho "\u7cfb\u7edf\u4e2d\u5173\u952e\u6587\u4ef6\u4fee\u6539\u65f6\u95f4:"\nls -ltr /bin/ls /bin/login /etc/passwd  /bin/ps /etc/shadow|awk \'{print ">>>\u6587\u4ef6\u540d\uff1a"$9"  ""\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a"$6" "$7" "$8}\'\necho "\n###############################################################################################\n#   ls\u6587\u4ef6:\u662f\u5b58\u50a8ls\u547d\u4ee4\u7684\u529f\u80fd\u51fd\u6570,\u88ab\u5220\u9664\u4ee5\u540e,\u5c31\u65e0\u6cd5\u6267\u884cls\u547d\u4ee4                                 #\n#   login\u6587\u4ef6:login\u662f\u63a7\u5236\u7528\u6237\u767b\u5f55\u7684\u6587\u4ef6,\u4e00\u65e6\u88ab\u7be1\u6539\u6216\u5220\u9664,\u7cfb\u7edf\u5c06\u65e0\u6cd5\u5207\u6362\u7528\u6237\u6216\u767b\u9646\u7528\u6237         #\n#   /etc/passwd\u662f\u4e00\u4e2a\u6587\u4ef6,\u4e3b\u8981\u662f\u4fdd\u5b58\u7528\u6237\u4fe1\u606f                                                  #\n#   /bin/ps \u8fdb\u7a0b\u67e5\u770b\u547d\u4ee4\u529f\u80fd\u652f\u6301\u6587\u4ef6,\u6587\u4ef6\u635f\u574f\u6216\u88ab\u66f4\u6539\u540e,\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528ps\u547d\u4ee4                    #\n#   /etc/shadow\u662f/etc/passwd\u7684\u5f71\u5b50\u6587\u4ef6,\u5bc6\u7801\u5b58\u653e\u5728\u8be5\u6587\u4ef6\u5f53\u4e2d,\u5e76\u4e14\u53ea\u6709root\u7528\u6237\u53ef\u8bfb              #\n###############################################################################################"\necho "=============================dividing line================================"\necho "\u68c0\u67e5\u91cd\u8981\u65e5\u5fd7\u6587\u4ef6\u662f\u5426\u5b58\u5728:"\nlog_secure=/var/log/secure\nlog_messages=/var/log/messages\nlog_cron=/var/log/cron\nlog_boot=/var/log/boot.log\nlog_dmesg=/var/log/dmesg\nif [ -e "$log_secure" ]; then\n  echo  ">>>/var/log/secure\u65e5\u5fd7\u6587\u4ef6\u5b58\u5728"\nelse\n  echo  ">>>/var/log/secure\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728------[\u9700\u8c03\u6574]"\nfi\nif [ -e "$log_messages" ]; then\n  echo  ">>>/var/log/messages\u65e5\u5fd7\u6587\u4ef6\u5b58\u5728"\nelse\n  echo  ">>>/var/log/messages\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728------[\u9700\u8c03\u6574]"\nfi\nif [ -e "$log_cron" ]; then\n  echo  ">>>/var/log/cron\u65e5\u5fd7\u6587\u4ef6\u5b58\u5728"\nelse\n  echo  ">>>/var/log/cron\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728--------[\u9700\u8c03\u6574]"\nfi\nif [ -e "$log_boot" ]; then\n  echo  ">>>/var/log/boot.log\u65e5\u5fd7\u6587\u4ef6\u5b58\u5728"\nelse\n  echo  ">>>/var/log/boot.log\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728--------[\u9700\u8c03\u6574]"\nfi\nif [ -e "$log_dmesg" ]; then\n  echo  ">>>/var/log/dmesg\u65e5\u5fd7\u6587\u4ef6\u5b58\u5728"\nelse\n  echo  ">>>/var/log/dmesg\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728--------[\u9700\u8c03\u6574]"\nfi\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u5269\u4f59\u4fe1\u606f\u4fdd\u62a4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho "\u5206\u533a\u60c5\u51b5:"\necho "\u5982\u679c\u78c1\u76d8\u7a7a\u95f4\u5229\u7528\u7387\u8fc7\u9ad8\uff0c\u8bf7\u53ca\u65f6\u8c03\u6574---------[\u9700\u8c03\u6574]"\ndf -h\necho "=============================dividing line================================"\necho "\u53ef\u7528\u5757\u8bbe\u5907\u4fe1\u606f:"\nlsblk\necho "=============================dividing line================================"\necho "\u6587\u4ef6\u7cfb\u7edf\u4fe1\u606f:"\nmore /etc/fstab  | grep -v "^#" | grep -v "^$"\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u5165\u4fb5\u9632\u8303\u5b89\u5168<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho "\u7cfb\u7edf\u5165\u4fb5\u884c\u4e3a:"\nmore /var/log/secure |grep refused\nif [ $? == 0 ];then\n    echo "\u6709\u5165\u4fb5\u884c\u4e3a\uff0c\u8bf7\u5206\u6790\u5904\u7406--------[\u9700\u8c03\u6574]"\nelse\n    echo ">>>\u65e0\u5165\u4fb5\u884c\u4e3a"\nfi\necho "=============================dividing line================================"\necho "\u7528\u6237\u9519\u8bef\u767b\u5165\u5217\u8868:"\nlastb | head > /dev/null\nif [ $? == 1 ];then\n    echo ">>>\u65e0\u7528\u6237\u9519\u8bef\u767b\u5165\u5217\u8868"\nelse\n    echo ">>>\u7528\u6237\u9519\u8bef\u767b\u5165--------[\u9700\u8c03\u6574]"\n    lastb | head \nfi\necho "=============================dividing line================================"\necho "ssh\u66b4\u529b\u767b\u5165\u4fe1\u606f:"\nmore /var/log/secure | grep  "Failed" > /dev/null\nif [ $? == 1 ];then\n    echo ">>>\u65e0ssh\u66b4\u529b\u767b\u5165\u4fe1\u606f"\nelse\n    more /var/log/secure|awk \'/Failed/{print $(NF-3)}\'|sort|uniq -c|awk \'{print ">>>\u767b\u5165\u5931\u8d25\u7684IP\u548c\u5c1d\u8bd5\u6b21\u6570: "$2"="$1"\u6b21---------[\u9700\u8c03\u6574]";}\'\nfi\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u6076\u610f\u4ee3\u7801\u9632\u8303<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho "\u68c0\u67e5\u662f\u5426\u5b89\u88c5\u75c5\u6bd2\u8f6f\u4ef6:"\ncrontab -l | grep clamscan.sh > /dev/null\nif [ $? == 0 ];then\n  echo ">>>\u5df2\u5b89\u88c5ClamAV\u6740\u6bd2\u8f6f\u4ef6"\n  crontab -l | grep freshclam.sh > /dev/null\n  if [ $? == 0 ];then\n    echo ">>>\u5df2\u90e8\u7f72\u5b9a\u65f6\u66f4\u65b0\u75c5\u6bd2\u5e93"\n  fi\nelse\n  echo ">>>\u672a\u5b89\u88c5ClamAV\u6740\u6bd2\u8f6f\u4ef6,\u8bf7\u90e8\u7f72\u6740\u6bd2\u8f6f\u4ef6\u52a0\u56fa\u4e3b\u673a\u9632\u62a4--------[\u65e0\u9700\u8c03\u6574]"\nfi\necho " "\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\u8d44\u6e90\u63a7\u5236\u5b89\u5168<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\necho "\u67e5\u770b\u662f\u5426\u5f00\u542f\u4e86xinetd\u670d\u52a1:"\nif ps -elf |grep xinet |grep -v "grep xinet";then\n  echo ">>>xinetd\u670d\u52a1\u6b63\u5728\u8fd0\u884c\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u628axinetd\u670d\u52a1\u5173\u95ed--------[\u65e0\u9700\u8c03\u6574]"\nelse\n  echo ">>>xinetd\u670d\u52a1\u672a\u5f00\u542f-------[\u65e0\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho  "\u67e5\u770b\u662f\u5426\u5f00\u542f\u4e86ssh\u670d\u52a1:"\nif service sshd status | grep -E "listening on|active \\(running\\)"; then\n  echo ">>>SSH\u670d\u52a1\u5df2\u5f00\u542f"\nelse\n  echo ">>>SSH\u670d\u52a1\u672a\u5f00\u542f--------[\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho "\u67e5\u770b\u662f\u5426\u5f00\u542f\u4e86Telnet-Server\u670d\u52a1:"\nif more /etc/xinetd.d/telnetd 2>&1|grep -E "disable=no"; then\n  echo ">>>Telnet-Server\u670d\u52a1\u5df2\u5f00\u542f"\nelse\n  echo ">>>Telnet-Server\u670d\u52a1\u672a\u5f00\u542f--------[\u65e0\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\nps axu | grep iptables | grep -v grep || ps axu | grep firewalld | grep -v grep \nif [ $? == 0 ];then\n  echo ">>>\u9632\u706b\u5899\u5df2\u542f\u7528"\niptables -nvL --line-numbers\nelse\n  echo ">>>\u9632\u706b\u5899\u672a\u542f\u7528--------[\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho  "\u67e5\u770b\u7cfb\u7edfSSH\u8fdc\u7a0b\u8bbf\u95ee\u8bbe\u7f6e\u7b56\u7565(host.deny\u62d2\u7edd\u5217\u8868):"\nif more /etc/hosts.deny | grep -E "sshd"; then\n  echo ">>>\u8fdc\u7a0b\u8bbf\u95ee\u7b56\u7565\u5df2\u8bbe\u7f6e--------[\u9700\u8c03\u6574]"\nelse\n  echo ">>>\u8fdc\u7a0b\u8bbf\u95ee\u7b56\u7565\u672a\u8bbe\u7f6e--------[\u65e0\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho "\u67e5\u770b\u7cfb\u7edfSSH\u8fdc\u7a0b\u8bbf\u95ee\u8bbe\u7f6e\u7b56\u7565(hosts.allow\u5141\u8bb8\u5217\u8868):"\nif more /etc/hosts.allow | grep -E "sshd"; then\n  echo ">>>\u8fdc\u7a0b\u8bbf\u95ee\u7b56\u7565\u5df2\u8bbe\u7f6e--------[\u9700\u8c03\u6574]"\nelse\n  echo ">>>\u8fdc\u7a0b\u8bbf\u95ee\u7b56\u7565\u672a\u8bbe\u7f6e--------[\u65e0\u9700\u8c03\u6574]"\nfi\necho "=============================dividing line================================"\necho "\u5f53hosts.allow\u548chost.deny\u76f8\u51b2\u7a81\u65f6,\u4ee5hosts.allow\u8bbe\u7f6e\u4e3a\u51c6"\necho "=============================dividing line================================"\ngrep -i "TMOUT" /etc/profile /etc/bashrc\nif [ $? == 0 ];then\n    echo ">>>\u5df2\u8bbe\u7f6e\u767b\u5165\u8d85\u65f6\u9650\u5236"\nelse\n    echo ">>>\u672a\u8bbe\u7f6e\u767b\u5165\u8d85\u65f6\u9650\u5236,\u8bf7\u8bbe\u7f6e,\u8bbe\u7f6e\u65b9\u6cd5:\u5728/etc/profile\u6216\u8005/etc/bashrc\u91cc\u9762\u6dfb\u52a0\u53c2\u6570TMOUT=600 --------[\u9700\u8c03\u6574]"\nfi\necho ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>end<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<"\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},'#!/bin/bash\n# \u83b7\u53d6\u8981\u76d1\u63a7\u7684\u672c\u5730\u670d\u52a1\u5668IP\u5730\u5740\nIP=`ifconfig | grep inet | grep -vE \'inet6|127.0.0.1\' | awk \'{print $2}\'`\necho "IP\u5730\u5740\uff1a"$IP\n \n# \u83b7\u53d6cpu\u603b\u6838\u6570\ncpu_num=`grep -c "model name" /proc/cpuinfo`\necho "cpu\u603b\u6838\u6570\uff1a"$cpu_num\n \n# 1\u3001\u83b7\u53d6CPU\u5229\u7528\u7387\n################################################\n#us \u7528\u6237\u7a7a\u95f4\u5360\u7528CPU\u767e\u5206\u6bd4\n#sy \u5185\u6838\u7a7a\u95f4\u5360\u7528CPU\u767e\u5206\u6bd4\n#ni \u7528\u6237\u8fdb\u7a0b\u7a7a\u95f4\u5185\u6539\u53d8\u8fc7\u4f18\u5148\u7ea7\u7684\u8fdb\u7a0b\u5360\u7528CPU\u767e\u5206\u6bd4\n#id \u7a7a\u95f2CPU\u767e\u5206\u6bd4\n#wa \u7b49\u5f85\u8f93\u5165\u8f93\u51fa\u7684CPU\u65f6\u95f4\u767e\u5206\u6bd4\n#hi \u786c\u4ef6\u4e2d\u65ad\n#si \u8f6f\u4ef6\u4e2d\u65ad\n#################################################\n# \u83b7\u53d6\u7528\u6237\u7a7a\u95f4\u5360\u7528CPU\u767e\u5206\u6bd4\ncpu_user=`top -b -n 1 | grep Cpu | awk \'{print $2}\' | cut -f 1 -d "%"`\necho "\u7528\u6237\u7a7a\u95f4\u5360\u7528CPU\u767e\u5206\u6bd4\uff1a"$cpu_user\n \n# \u83b7\u53d6\u5185\u6838\u7a7a\u95f4\u5360\u7528CPU\u767e\u5206\u6bd4\ncpu_system=`top -b -n 1 | grep Cpu | awk \'{print $4}\' | cut -f 1 -d "%"`\necho "\u5185\u6838\u7a7a\u95f4\u5360\u7528CPU\u767e\u5206\u6bd4\uff1a"$cpu_system\n \n# \u83b7\u53d6\u7a7a\u95f2CPU\u767e\u5206\u6bd4\ncpu_idle=`top -b -n 1 | grep Cpu | awk \'{print $8}\' | cut -f 1 -d "%"`\necho "\u7a7a\u95f2CPU\u767e\u5206\u6bd4\uff1a"$cpu_idle\n \n# \u83b7\u53d6\u7b49\u5f85\u8f93\u5165\u8f93\u51fa\u5360CPU\u767e\u5206\u6bd4\ncpu_iowait=`top -b -n 1 | grep Cpu | awk \'{print $10}\' | cut -f 1 -d "%"`\necho "\u7b49\u5f85\u8f93\u5165\u8f93\u51fa\u5360CPU\u767e\u5206\u6bd4\uff1a"$cpu_iowait\n \n#2\u3001\u83b7\u53d6CPU\u4e0a\u4e0b\u6587\u5207\u6362\u548c\u4e2d\u65ad\u6b21\u6570\n# \u83b7\u53d6CPU\u4e2d\u65ad\u6b21\u6570\ncpu_interrupt=`vmstat -n 1 1 | sed -n 3p | awk \'{print $11}\'`\necho "CPU\u4e2d\u65ad\u6b21\u6570\uff1a"$cpu_interrupt\n \n# \u83b7\u53d6CPU\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\ncpu_context_switch=`vmstat -n 1 1 | sed -n 3p | awk \'{print $12}\'`\necho "CPU\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\uff1a"$cpu_context_switch\n \n#3\u3001\u83b7\u53d6CPU\u8d1f\u8f7d\u4fe1\u606f\n# \u83b7\u53d6CPU15\u5206\u949f\u524d\u5230\u73b0\u5728\u7684\u8d1f\u8f7d\u5e73\u5747\u503c\ncpu_load_15min=`uptime | awk \'{print $11}\' | cut -f 1 -d \',\'`\necho "CPU 15\u5206\u949f\u524d\u5230\u73b0\u5728\u7684\u8d1f\u8f7d\u5e73\u5747\u503c\uff1a"$cpu_load_15min\n \n# \u83b7\u53d6CPU5\u5206\u949f\u524d\u5230\u73b0\u5728\u7684\u8d1f\u8f7d\u5e73\u5747\u503c\ncpu_load_5min=`uptime | awk \'{print $10}\' | cut -f 1 -d \',\'`\necho "CPU 5\u5206\u949f\u524d\u5230\u73b0\u5728\u7684\u8d1f\u8f7d\u5e73\u5747\u503c\uff1a"$cpu_load_5min\n \n# \u83b7\u53d6CPU1\u5206\u949f\u524d\u5230\u73b0\u5728\u7684\u8d1f\u8f7d\u5e73\u5747\u503c\ncpu_load_1min=`uptime | awk \'{print $9}\' | cut -f 1 -d \',\'`\necho "CPU 1\u5206\u949f\u524d\u5230\u73b0\u5728\u7684\u8d1f\u8f7d\u5e73\u5747\u503c\uff1a"$cpu_load_1min\n \n# \u83b7\u53d6\u4efb\u52a1\u961f\u5217(\u5c31\u7eea\u72b6\u6001\u7b49\u5f85\u7684\u8fdb\u7a0b\u6570)\ncpu_task_length=`vmstat -n 1 1 | sed -n 3p | awk \'{print $1}\'`\necho "CPU\u4efb\u52a1\u961f\u5217\u957f\u5ea6\uff1a"$cpu_task_length\n \n#4\u3001\u83b7\u53d6\u5185\u5b58\u4fe1\u606f\n# \u83b7\u53d6\u7269\u7406\u5185\u5b58\u603b\u91cf\nmem_total=`free | grep Mem | awk \'{print $2}\'`\necho "\u7269\u7406\u5185\u5b58\u603b\u91cf\uff1a"$mem_total\n \n# \u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u5df2\u4f7f\u7528\u5185\u5b58\u603b\u91cf\nmem_sys_used=`free | grep Mem | awk \'{print $3}\'`\necho "\u5df2\u4f7f\u7528\u5185\u5b58\u603b\u91cf(\u64cd\u4f5c\u7cfb\u7edf)\uff1a"$mem_sys_used\n \n# \u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u672a\u4f7f\u7528\u5185\u5b58\u603b\u91cf\nmem_sys_free=`free | grep Mem | awk \'{print $4}\'`\necho "\u5269\u4f59\u5185\u5b58\u603b\u91cf(\u64cd\u4f5c\u7cfb\u7edf)\uff1a"$mem_sys_free\n \n# \u83b7\u53d6\u5e94\u7528\u7a0b\u5e8f\u5df2\u4f7f\u7528\u7684\u5185\u5b58\u603b\u91cf\nmem_user_used=`free | sed -n 3p | awk \'{print $3}\'`\necho "\u5df2\u4f7f\u7528\u5185\u5b58\u603b\u91cf(\u5e94\u7528\u7a0b\u5e8f)\uff1a"$mem_user_used\n \n# \u83b7\u53d6\u5e94\u7528\u7a0b\u5e8f\u672a\u4f7f\u7528\u5185\u5b58\u603b\u91cf\nmem_user_free=`free | sed -n 3p | awk \'{print $4}\'`\necho "\u5269\u4f59\u5185\u5b58\u603b\u91cf(\u5e94\u7528\u7a0b\u5e8f)\uff1a"$mem_user_free\n \n \n# \u83b7\u53d6\u4ea4\u6362\u5206\u533a\u603b\u5927\u5c0f\nmem_swap_total=`free | grep Swap | awk \'{print $2}\'`\necho "\u4ea4\u6362\u5206\u533a\u603b\u5927\u5c0f\uff1a"$mem_swap_total\n \n# \u83b7\u53d6\u5df2\u4f7f\u7528\u4ea4\u6362\u5206\u533a\u5927\u5c0f\nmem_swap_used=`free | grep Swap | awk \'{print $3}\'`\necho "\u5df2\u4f7f\u7528\u4ea4\u6362\u5206\u533a\u5927\u5c0f\uff1a"$mem_swap_used\n \n# \u83b7\u53d6\u5269\u4f59\u4ea4\u6362\u5206\u533a\u5927\u5c0f\nmem_swap_free=`free | grep Swap | awk \'{print $4}\'`\necho "\u5269\u4f59\u4ea4\u6362\u5206\u533a\u5927\u5c0f\uff1a"$mem_swap_free\n \n\n#5\u3001\u83b7\u53d6\u78c1\u76d8I/O\u7edf\u8ba1\u4fe1\u606f\necho "\u6307\u5b9a\u8bbe\u5907(/dev/sda)\u7684\u7edf\u8ba1\u4fe1\u606f"\n# \u6bcf\u79d2\u5411\u8bbe\u5907\u53d1\u8d77\u7684\u8bfb\u8bf7\u6c42\u6b21\u6570\ndisk_sda_rs=`iostat -kx | grep sda| awk \'{print $4}\'`\necho "\u6bcf\u79d2\u5411\u8bbe\u5907\u53d1\u8d77\u7684\u8bfb\u8bf7\u6c42\u6b21\u6570\uff1a"$disk_sda_rs\n \n# \u6bcf\u79d2\u5411\u8bbe\u5907\u53d1\u8d77\u7684\u5199\u8bf7\u6c42\u6b21\u6570\ndisk_sda_ws=`iostat -kx | grep sda| awk \'{print $5}\'`\necho "\u6bcf\u79d2\u5411\u8bbe\u5907\u53d1\u8d77\u7684\u5199\u8bf7\u6c42\u6b21\u6570\uff1a"$disk_sda_ws\n \n# \u5411\u8bbe\u5907\u53d1\u8d77\u7684I/O\u8bf7\u6c42\u961f\u5217\u957f\u5ea6\u5e73\u5747\u503c\ndisk_sda_avgqu_sz=`iostat -kx | grep sda| awk \'{print $9}\'`\necho "\u5411\u8bbe\u5907\u53d1\u8d77\u7684I/O\u8bf7\u6c42\u961f\u5217\u957f\u5ea6\u5e73\u5747\u503c"$disk_sda_avgqu_sz\n \n# \u6bcf\u6b21\u5411\u8bbe\u5907\u53d1\u8d77\u7684I/O\u8bf7\u6c42\u5e73\u5747\u65f6\u95f4\ndisk_sda_await=`iostat -kx | grep sda| awk \'{print $10}\'`\necho "\u6bcf\u6b21\u5411\u8bbe\u5907\u53d1\u8d77\u7684I/O\u8bf7\u6c42\u5e73\u5747\u65f6\u95f4\uff1a"$disk_sda_await\n \n# \u5411\u8bbe\u5907\u53d1\u8d77\u7684I/O\u670d\u52a1\u65f6\u95f4\u5747\u503c\ndisk_sda_svctm=`iostat -kx | grep sda| awk \'{print $11}\'`\necho "\u5411\u8bbe\u5907\u53d1\u8d77\u7684I/O\u670d\u52a1\u65f6\u95f4\u5747\u503c\uff1a"$disk_sda_svctm\n \n# \u5411\u8bbe\u5907\u53d1\u8d77I/O\u8bf7\u6c42\u7684CPU\u65f6\u95f4\u767e\u5206\u5360\u6bd4\ndisk_sda_util=`iostat -kx | grep sda| awk \'{print $12}\'`\necho "\u5411\u8bbe\u5907\u53d1\u8d77I/O\u8bf7\u6c42\u7684CPU\u65f6\u95f4\u767e\u5206\u5360\u6bd4\uff1a"$disk_sda_util\n')))}p.isMDXComponent=!0}}]);